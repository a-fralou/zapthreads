var ZapThreads=function(){"use strict";var mc=Object.defineProperty;var bc=(et,en,Fn)=>en in et?mc(et,en,{enumerable:!0,configurable:!0,writable:!0,value:Fn}):et[en]=Fn;var Pn=(et,en,Fn)=>(bc(et,typeof en!="symbol"?en+"":en,Fn),Fn);const et=(n,t)=>n===t,en=Symbol("solid-proxy"),Fn=Symbol("solid-track"),Tt={equals:et};let or=cr;const Wn=1,Ot=2,sr={owned:null,cleanups:null,context:null,owner:null};var Y=null;let ae=null,Z=null,rn=null,Rn=null,$t=0;function ce(n,t){const e=Z,r=Y,i=n.length===0,o=i?sr:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},s=i?n:()=>n(()=>Nn(()=>Rt(o)));Y=o,Z=null;try{return lt(s,!0)}finally{Z=e,Y=r}}function Cn(n,t){t=t?Object.assign({},Tt,t):Tt;const e={value:n,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(e.value)),ar(e,i));return[lr.bind(e),r]}function Zn(n,t,e){const r=he(n,t,!1,Wn);xt(r)}function bt(n,t,e){or=co;const r=he(n,t,!1,Wn),i=ur&&de(Y,ur.id);i&&(r.suspense=i),(!e||!e.render)&&(r.user=!0),Rn?Rn.push(r):xt(r)}function bn(n,t,e){e=e?Object.assign({},Tt,e):Tt;const r=he(n,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=e.equals||void 0,xt(r),lr.bind(r)}function Lt(n){return lt(n,!1)}function Nn(n){if(Z===null)return n();const t=Z;Z=null;try{return n()}finally{Z=t}}function ro(n){bt(()=>Nn(n))}function wt(n){return Y===null||(Y.cleanups===null?Y.cleanups=[n]:Y.cleanups.push(n)),n}function fe(){return Z}function io(){return Y}function oo(n,t){const e=Symbol("context");return{id:e,Provider:fo(e),defaultValue:n}}function so(n){let t;return(t=de(Y,n.id))!==void 0?t:n.defaultValue}function uo(n){const t=bn(n),e=bn(()=>ge(t()));return e.toArray=()=>{const r=e();return Array.isArray(r)?r:r!=null?[r]:[]},e}let ur;function lr(){if(this.sources&&this.state)if(this.state===Wn)xt(this);else{const n=rn;rn=null,lt(()=>Ft(this),!1),rn=n}if(Z){const n=this.observers?this.observers.length:0;Z.sources?(Z.sources.push(this),Z.sourceSlots.push(n)):(Z.sources=[this],Z.sourceSlots=[n]),this.observers?(this.observers.push(Z),this.observerSlots.push(Z.sources.length-1)):(this.observers=[Z],this.observerSlots=[Z.sources.length-1])}return this.value}function ar(n,t,e){let r=n.value;return(!n.comparator||!n.comparator(r,t))&&(n.value=t,n.observers&&n.observers.length&&lt(()=>{for(let i=0;i<n.observers.length;i+=1){const o=n.observers[i],s=ae&&ae.running;s&&ae.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?rn.push(o):Rn.push(o),o.observers&&fr(o)),s||(o.state=Wn)}if(rn.length>1e6)throw rn=[],new Error},!1)),t}function xt(n){if(!n.fn)return;Rt(n);const t=Y,e=Z,r=$t;Z=Y=n,lo(n,n.value,r),Z=e,Y=t}function lo(n,t,e){let r;try{r=n.fn(t)}catch(i){return n.pure&&(n.state=Wn,n.owned&&n.owned.forEach(Rt),n.owned=null),n.updatedAt=e+1,hr(i)}(!n.updatedAt||n.updatedAt<=e)&&(n.updatedAt!=null&&"observers"in n?ar(n,r):n.value=r,n.updatedAt=e)}function he(n,t,e,r=Wn,i){const o={fn:n,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Y,context:null,pure:e};return Y===null||Y!==sr&&(Y.owned?Y.owned.push(o):Y.owned=[o]),o}function Pt(n){if(n.state===0)return;if(n.state===Ot)return Ft(n);if(n.suspense&&Nn(n.suspense.inFallback))return n.suspense.effects.push(n);const t=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<$t);)n.state&&t.push(n);for(let e=t.length-1;e>=0;e--)if(n=t[e],n.state===Wn)xt(n);else if(n.state===Ot){const r=rn;rn=null,lt(()=>Ft(n,t[0]),!1),rn=r}}function lt(n,t){if(rn)return n();let e=!1;t||(rn=[]),Rn?e=!0:Rn=[],$t++;try{const r=n();return ao(e),r}catch(r){e||(Rn=null),rn=null,hr(r)}}function ao(n){if(rn&&(cr(rn),rn=null),n)return;const t=Rn;Rn=null,t.length&&lt(()=>or(t),!1)}function cr(n){for(let t=0;t<n.length;t++)Pt(n[t])}function co(n){let t,e=0;for(t=0;t<n.length;t++){const r=n[t];r.user?n[e++]=r:Pt(r)}for(t=0;t<e;t++)Pt(n[t])}function Ft(n,t){n.state=0;for(let e=0;e<n.sources.length;e+=1){const r=n.sources[e];if(r.sources){const i=r.state;i===Wn?r!==t&&(!r.updatedAt||r.updatedAt<$t)&&Pt(r):i===Ot&&Ft(r,t)}}}function fr(n){for(let t=0;t<n.observers.length;t+=1){const e=n.observers[t];e.state||(e.state=Ot,e.pure?rn.push(e):Rn.push(e),e.observers&&fr(e))}}function Rt(n){let t;if(n.sources)for(;n.sources.length;){const e=n.sources.pop(),r=n.sourceSlots.pop(),i=e.observers;if(i&&i.length){const o=i.pop(),s=e.observerSlots.pop();r<i.length&&(o.sourceSlots[s]=r,i[r]=o,e.observerSlots[r]=s)}}if(n.owned){for(t=n.owned.length-1;t>=0;t--)Rt(n.owned[t]);n.owned=null}if(n.cleanups){for(t=n.cleanups.length-1;t>=0;t--)n.cleanups[t]();n.cleanups=null}n.state=0,n.context=null}function hr(n){throw n}function de(n,t){return n?n.context&&n.context[t]!==void 0?n.context[t]:de(n.owner,t):void 0}function ge(n){if(typeof n=="function"&&!n.length)return ge(n());if(Array.isArray(n)){const t=[];for(let e=0;e<n.length;e++){const r=ge(n[e]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return n}function fo(n,t){return function(r){let i;return Zn(()=>i=Nn(()=>(Y.context={[n]:r.value},uo(()=>r.children))),void 0),i}}const dr=Symbol("fallback");function gr(n){for(let t=0;t<n.length;t++)n[t]()}function ho(n,t,e={}){let r=[],i=[],o=[],s=[],u=0,c;return wt(()=>gr(o)),()=>{const a=n()||[];return a[Fn],Nn(()=>{if(a.length===0)return u!==0&&(gr(o),o=[],r=[],i=[],u=0,s=[]),e.fallback&&(r=[dr],i[0]=ce(l=>(o[0]=l,e.fallback())),u=1),i;for(r[0]===dr&&(o[0](),o=[],r=[],i=[],u=0),c=0;c<a.length;c++)c<r.length&&r[c]!==a[c]?s[c](()=>a[c]):c>=r.length&&(i[c]=ce(f));for(;c<r.length;c++)o[c]();return u=s.length=o.length=a.length,r=a.slice(0),i=i.slice(0,u)});function f(l){o[c]=l;const[g,h]=Cn(a[c]);return s[c]=h,t(g,c)}}}let go=!1;function hn(n,t){return Nn(()=>n(t||{}))}const po=n=>`Stale read from <${n}>.`;function mo(n){const t="fallback"in n&&{fallback:()=>n.fallback};return bn(ho(()=>n.each,n.children,t||void 0))}function yt(n){const t=n.keyed,e=bn(()=>n.when,void 0,{equals:(r,i)=>t?r===i:!r==!i});return bn(()=>{const r=e();if(r){const i=n.children;return typeof i=="function"&&i.length>0?Nn(()=>i(t?r:()=>{if(!Nn(e))throw po("Show");return n.when})):i}return n.fallback},void 0,void 0)}function bo(n,t,e){let r=e.length,i=t.length,o=r,s=0,u=0,c=t[i-1].nextSibling,a=null;for(;s<i||u<o;){if(t[s]===e[u]){s++,u++;continue}for(;t[i-1]===e[o-1];)i--,o--;if(i===s){const f=o<r?u?e[u-1].nextSibling:e[o-u]:c;for(;u<o;)n.insertBefore(e[u++],f)}else if(o===u)for(;s<i;)(!a||!a.has(t[s]))&&t[s].remove(),s++;else if(t[s]===e[o-1]&&e[u]===t[i-1]){const f=t[--i].nextSibling;n.insertBefore(e[u++],t[s++].nextSibling),n.insertBefore(e[--o],f),t[i]=e[o]}else{if(!a){a=new Map;let l=u;for(;l<o;)a.set(e[l],l++)}const f=a.get(t[s]);if(f!=null)if(u<f&&f<o){let l=s,g=1,h;for(;++l<i&&l<o&&!((h=a.get(t[l]))==null||h!==f+g);)g++;if(g>f-u){const x=t[s];for(;u<f;)n.insertBefore(e[u++],x)}else n.replaceChild(e[u++],t[s++])}else s++;else t[s++].remove()}}}const pr="_$DX_DELEGATE";function on(n,t,e){let r;const i=()=>{const s=document.createElement("template");return s.innerHTML=n,e?s.content.firstChild.firstChild:s.content.firstChild},o=t?()=>Nn(()=>document.importNode(r||(r=i()),!0)):()=>(r||(r=i())).cloneNode(!0);return o.cloneNode=o,o}function mr(n,t=window.document){const e=t[pr]||(t[pr]=new Set);for(let r=0,i=n.length;r<i;r++){const o=n[r];e.has(o)||(e.add(o),t.addEventListener(o,wo))}}function an(n,t,e){e==null?n.removeAttribute(t):n.setAttribute(t,e)}function H(n,t,e,r){if(e!==void 0&&!r&&(r=[]),typeof t!="function")return Nt(n,t,r,e);Zn(i=>Nt(n,t(),i,e),r)}function wo(n){const t=`$$${n.type}`;let e=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==e&&Object.defineProperty(n,"target",{configurable:!0,value:e}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}});e;){const r=e[t];if(r&&!e.disabled){const i=e[`${t}Data`];if(i!==void 0?r.call(e,i,n):r.call(e,n),n.cancelBubble)return}e=e._$host||e.parentNode||e.host}}function Nt(n,t,e,r,i){for(;typeof e=="function";)e=e();if(t===e)return e;const o=typeof t,s=r!==void 0;if(n=s&&e[0]&&e[0].parentNode||n,o==="string"||o==="number")if(o==="number"&&(t=t.toString()),s){let u=e[0];u&&u.nodeType===3?u.data=t:u=document.createTextNode(t),e=at(n,e,r,u)}else e!==""&&typeof e=="string"?e=n.firstChild.data=t:e=n.textContent=t;else if(t==null||o==="boolean")e=at(n,e,r);else{if(o==="function")return Zn(()=>{let u=t();for(;typeof u=="function";)u=u();e=Nt(n,u,e,r)}),()=>e;if(Array.isArray(t)){const u=[],c=e&&Array.isArray(e);if(pe(u,t,e,i))return Zn(()=>e=Nt(n,u,e,r,!0)),()=>e;if(u.length===0){if(e=at(n,e,r),s)return e}else c?e.length===0?br(n,u,r):bo(n,e,u):(e&&at(n),br(n,u));e=u}else if(t.nodeType){if(Array.isArray(e)){if(s)return e=at(n,e,r,t);at(n,e,null,t)}else e==null||e===""||!n.firstChild?n.appendChild(t):n.replaceChild(t,n.firstChild);e=t}else console.warn("Unrecognized value. Skipped inserting",t)}return e}function pe(n,t,e,r){let i=!1;for(let o=0,s=t.length;o<s;o++){let u=t[o],c=e&&e[o],a;if(!(u==null||u===!0||u===!1))if((a=typeof u)=="object"&&u.nodeType)n.push(u);else if(Array.isArray(u))i=pe(n,u,c)||i;else if(a==="function")if(r){for(;typeof u=="function";)u=u();i=pe(n,Array.isArray(u)?u:[u],Array.isArray(c)?c:[c])||i}else n.push(u),i=!0;else{const f=String(u);c&&c.nodeType===3&&c.data===f?n.push(c):n.push(document.createTextNode(f))}}return i}function br(n,t,e=null){for(let r=0,i=t.length;r<i;r++)n.insertBefore(t[r],e)}function at(n,t,e,r){if(e===void 0)return n.textContent="";const i=r||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const u=t[s];if(i!==u){const c=u.parentNode===n;!o&&!s?c?n.replaceChild(i,u):n.insertBefore(i,e):c&&u.remove()}else o=!0}}else n.insertBefore(i,e);return[i]}var wr=(n,t)=>{let e;const r=()=>clearTimeout(e);return io()&&wt(r),Object.assign((...o)=>{e!==void 0&&r(),e=setTimeout(()=>n(...o),t)},{clear:r})};function xr(n){let t=0,e=!1;const[r,i]=Cn(void 0,{equals:!1}),o=n(()=>{e=!0,i()});return()=>(e||(o(),r()),e?(e=!!t,!0):(fe()&&(t++,wt(()=>t--)),!1))}function xo(n){return Object.keys(n).reduce((e,r)=>{const i=n[r];return e[r]=Object.assign({},i),kr(i.value)&&!Ao(i.value)&&!Array.isArray(i.value)&&(e[r].value=Object.assign({},i.value)),Array.isArray(i.value)&&(e[r].value=i.value.slice(0)),e},{})}function yo(n){return n?Object.keys(n).reduce((e,r)=>{const i=n[r];return e[r]=kr(i)&&"value"in i?i:{value:i},e[r].attribute||(e[r].attribute=So(r)),e[r].parse="parse"in e[r]?e[r].parse:typeof e[r].value!="string",e},{}):{}}function Eo(n){return Object.keys(n).reduce((e,r)=>(e[r]=n[r].value,e),{})}function ko(n,t){const e=xo(t);return Object.keys(t).forEach(i=>{const o=e[i],s=n.getAttribute(o.attribute),u=n[i];s&&(o.value=o.parse?yr(s):s),u!=null&&(o.value=Array.isArray(u)?u.slice(0):u),o.reflect&&Er(n,o.attribute,o.value),Object.defineProperty(n,i,{get(){return o.value},set(c){const a=o.value;o.value=c,o.reflect&&Er(this,o.attribute,o.value);for(let f=0,l=this.__propertyChangedCallbacks.length;f<l;f++)this.__propertyChangedCallbacks[f](i,c,a)},enumerable:!0,configurable:!0})}),e}function yr(n){if(n)try{return JSON.parse(n)}catch{return n}}function Er(n,t,e){if(e==null||e===!1)return n.removeAttribute(t);let r=JSON.stringify(e);n.__updating[t]=!0,r==="true"&&(r=""),n.setAttribute(t,r),Promise.resolve().then(()=>delete n.__updating[t])}function So(n){return n.replace(/\.?([A-Z]+)/g,(t,e)=>"-"+e.toLowerCase()).replace("_","-").replace(/^-/,"")}function kr(n){return n!=null&&(typeof n=="object"||typeof n=="function")}function Ao(n){return Object.prototype.toString.call(n)==="[object Function]"}function Co(n){return typeof n=="function"&&n.toString().indexOf("class")===0}let me;function _o(n,t){const e=Object.keys(t);return class extends n{static get observedAttributes(){return e.map(i=>t[i].attribute)}constructor(){super(),this.__initialized=!1,this.__released=!1,this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props={}}connectedCallback(){if(this.__initialized)return;this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props=ko(this,t);const i=Eo(this.props),o=this.Component,s=me;try{me=this,this.__initialized=!0,Co(o)?new o(i,{element:this}):o(i,{element:this})}finally{me=s}}async disconnectedCallback(){if(await Promise.resolve(),this.isConnected)return;this.__propertyChangedCallbacks.length=0;let i=null;for(;i=this.__releaseCallbacks.pop();)i(this);delete this.__initialized,this.__released=!0}attributeChangedCallback(i,o,s){if(this.__initialized&&!this.__updating[i]&&(i=this.lookupProp(i),i in t)){if(s==null&&!this[i])return;this[i]=t[i].parse?yr(s):s}}lookupProp(i){if(t)return e.find(o=>i===o||i===t[o].attribute)}get renderRoot(){return this.shadowRoot||this.attachShadow({mode:"open"})}addReleaseCallback(i){this.__releaseCallbacks.push(i)}addPropertyChangedCallback(i){this.__propertyChangedCallbacks.push(i)}}}function zo(n,t={},e={}){const{BaseElement:r=HTMLElement,extension:i}=e;return o=>{if(!n)throw new Error("tag is required to register a Component");let s=customElements.get(n);return s?(s.prototype.Component=o,s):(s=_o(r,yo(t)),s.prototype.Component=o,s.prototype.registeredTag=n,customElements.define(n,s,i),s)}}function vo(n){const t=Object.keys(n),e={};for(let r=0;r<t.length;r++){const[i,o]=Cn(n[t[r]]);Object.defineProperty(e,t[r],{get:i,set(s){o(()=>s)}})}return e}function Bo(n){if(n.assignedSlot&&n.assignedSlot._$owner)return n.assignedSlot._$owner;let t=n.parentNode;for(;t&&!t._$owner&&!(t.assignedSlot&&t.assignedSlot._$owner);)t=t.parentNode;return t&&t.assignedSlot?t.assignedSlot._$owner:n._$owner}function Io(n){return(t,e)=>{const{element:r}=e;return ce(i=>{const o=vo(t);r.addPropertyChangedCallback((u,c)=>o[u]=c),r.addReleaseCallback(()=>{r.renderRoot.textContent="",i()});const s=n(o,e);return H(r.renderRoot,s)},Bo(r))}}function To(n,t,e){return arguments.length===2&&(e=t,t={}),zo(n,t)(Io(e))}const Oo=`:root {
  --ztr-font: -apple-system, "BlinkMacSystemFont", "Segoe UI", "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  --ztr-font-size: 16px;
  --ztr-text-color: #2B2B2B;
  --ztr-textarea-color: #2B2B2B;
  --ztr-icon-color: #656565;
  --ztr-link-color:  #92379c;
  --ztr-login-button-color: #92379c;
  --ztr-background-color: rgba(0, 0, 0, 0.03);
}

/****/

#ztr-root {
  font-family: var(--ztr-font);
  font-size: var(--ztr-font-size);
  color: var(--ztr-text-color);
  line-height: 19px;
  border: 1px solid transparent; /* Removes margin collapse */
}

#ztr-root {
  margin-top: 3rem;
}

#ztr-subtitle {
  font-size: 1.2rem;
  color: #666;
}

/* Comment */

.ztr-comment {
  position: relative;
  margin: 0rem;
  padding: 0rem;
  background-color: var(--ztr-background-color, rgba(0, 0, 0, 0.03));
}

.ztr-comment-text {
  line-break: loose;
  word-break: break-word;
  padding: 1rem;
}

.ztr-comment-text pre {
  white-space: pre-wrap;
  white-space: -moz-pre-wrap;
}

.ztr-comment:first-child {
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

.ztr-comment:last-child {
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}

.ztr-comment-info {
  display: flex;
  align-items: center;
}

.ztr-comment-info-picture {
  width: 4rem;
}

ul.ztr-comment-info-items {
  display: flex;
  align-items: center;
  list-style: none;
  margin: 0;
  padding: 0;
  font-size: 0.95rem;
}

ul.ztr-comment-info-items li {
  display: inline-block;
  text-align: center;
  cursor: default;
}

ul.ztr-comment-info-items li:not(:first-child)::before {
  padding: 0 0.2rem 0 0.35rem;
  content: " • ";
}

ul.ztr-comment-info-items li a {
  color: var(--ztr-link-color, #2B2B2B);
  text-decoration: none;
  font-weight: 600;
}

.ztr-comment-info-picture img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  padding: 0.5rem;
  position: relative;
  display: block;
  object-fit: cover;
}

.ztr-comment-body {
  margin-top: -1rem;
  padding-left: 4rem;
}

.ztr-comment-body a {
  color: var(--ztr-link-color, #2B2B2B);
}

.ztr-comment-replies {
  margin-left: 2em;
}

/* Styling the reply to comment form */

ul.ztr-comment-actions {
  display: flex;
  align-items: center;
  list-style: none;
  margin: 0;
  padding: 0;
  font-size: 0.9rem;
  font-weight: 600;
  user-select: none;
}

ul.ztr-comment-actions li {
  display: inline-flex;
  align-items: center;
  text-align: center;
  padding: 0 2rem 0 0;
  cursor: default;
}

ul.ztr-comment-actions li a {
  cursor: pointer;
  padding: 0 0.25rem 0 0;
}

ul.ztr-comment-actions li span {
  padding: 0;
}

.ztr-comment-actions svg {
  fill: var(--ztr-icon-color);
}

.ztr-comment-action-zap svg:hover {
  fill: #ffd53d;
  stroke: #b2ac68;
  stroke-width: 1px;
}

.ztr-comment-action-like svg:hover {
  fill: #e74c4c;
}

.ztr-comment-action-reply svg:hover {
  fill: #b65bf3;
}

.ztr-reply-form {
  padding-right: 0.5rem;
}

.ztr-reply-form textarea {
  font-family: var(--ztr-font);
  font-size: 16px;
  color: var(--ztr-textarea-color, #2B2B2B);
  line-height: 19px;

  background-color: #fdfdfd;
  border: 1px solid #BBB;
  outline: none;
  width: calc(100% - 1.5rem);
  padding: 0.7rem;
  margin: 0.5rem 0;
  height: 4rem;
  border-radius: 4px;
  resize: none;
}

.ztr-reply-form:disabled {
  opacity: 65%;
  user-select: none;
}

.ztr-reply-error {
  font-weight: bold;
  font-size: 0.85rem;
  margin-right: 1rem;
  user-select: none;
  cursor: default;
}

.ztr-reply-controls {
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

.ztr-reply-controls .ztr-comment-info-picture {
  width: 3rem;
}

.ztr-reply-controls .ztr-comment-info-picture img {
  width: 30px;
  height: 30px;
}

.ztr-reply-controls button {
  font-family: var(--ztr-font);
  appearance: none;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
}

.ztr-reply-login-button {
  margin-left: 1rem;
  background-color: var(--ztr-login-button-color);
  color: white;
}

.ztr-reply-button {
  color: var(--ztr-text-color);
  background-color: var(--ztr-background-color);
  display: flex;
  align-items: center;
}

.ztr-spinner {
  width: var(--ztr-font-size);
  height: var(--ztr-font-size);
  margin-right: 1rem;
  animation: rotate 4s linear infinite;
}

.ztr-reply-button:disabled {
  opacity: 65%;
  pointer-events: none;
  cursor: pointer;
  user-select: none;
}

.ztr-spinner .path {
  stroke: var(--ztr-text-color);
  stroke-linecap: round;
  animation: dash 1.5s ease-in-out infinite;
}

@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}

/* new */

.ztr-comment-new .ztr-reply-form {
  margin-top: 0.5rem;
}

.ztr-comment-new .ztr-comment-body {
  padding: 0;
}

.ztr-comment-new .ztr-comment-actions {
  font-size: 1.1rem;
}`,Sr=document.createElement("i");function Ar(n){const t="&"+n+";";Sr.innerHTML=t;const e=Sr.textContent;return e.charCodeAt(e.length-1)===59&&n!=="semi"||e===t?!1:e}function vn(n,t,e,r){const i=n.length;let o=0,s;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,e=e>0?e:0,r.length<1e4)s=Array.from(r),s.unshift(t,e),n.splice(...s);else for(e&&n.splice(t,e);o<r.length;)s=r.slice(o,o+1e4),s.unshift(t,0),n.splice(...s),o+=1e4,t+=1e4}function sn(n,t){return n.length>0?(vn(n,n.length,0,t),n):t}const be={}.hasOwnProperty;function $o(n){const t={};let e=-1;for(;++e<n.length;)Lo(t,n[e]);return t}function Lo(n,t){let e;for(e in t){const i=(be.call(n,e)?n[e]:void 0)||(n[e]={}),o=t[e];let s;if(o)for(s in o){be.call(i,s)||(i[s]=[]);const u=o[s];Po(i[s],Array.isArray(u)?u:u?[u]:[])}}}function Po(n,t){let e=-1;const r=[];for(;++e<t.length;)(t[e].add==="after"?n:r).push(t[e]);vn(n,0,0,r)}function Fo(n){const t={};let e=-1;for(;++e<n.length;)Ro(t,n[e]);return t}function Ro(n,t){let e;for(e in t){const i=(be.call(n,e)?n[e]:void 0)||(n[e]={}),o=t[e];let s;if(o)for(s in o)i[s]=o[s]}}function No(n,t){const e=Number.parseInt(n,t);return e<9||e===11||e>13&&e<32||e>126&&e<160||e>55295&&e<57344||e>64975&&e<65008||(e&65535)===65535||(e&65535)===65534||e>1114111?"�":String.fromCharCode(e)}const Do={'"':"quot","&":"amp","<":"lt",">":"gt"};function Cr(n){return n.replace(/["&<>]/g,t);function t(e){return"&"+Do[e]+";"}}function Et(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Uo=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,cn=Kn(/[A-Za-z]/),un=Kn(/[\dA-Za-z]/),qo=Kn(/[#-'*+\--9=?A-Z^-~]/);function Dt(n){return n!==null&&(n<32||n===127)}const we=Kn(/\d/),Ho=Kn(/[\dA-Fa-f]/),Mo=Kn(/[!-/:-@[-`{-~]/);function P(n){return n!==null&&n<-2}function G(n){return n!==null&&(n<0||n===32)}function U(n){return n===-2||n===-1||n===32}const xe=Kn(Uo),ct=Kn(/\s/);function Kn(n){return t;function t(e){return e!==null&&n.test(String.fromCharCode(e))}}function kt(n,t){const e=Cr(jo(n||""));if(!t)return e;const r=e.indexOf(":"),i=e.indexOf("?"),o=e.indexOf("#"),s=e.indexOf("/");return r<0||s>-1&&r>s||i>-1&&r>i||o>-1&&r>o||t.test(e.slice(0,r))?e:""}function jo(n){const t=[];let e=-1,r=0,i=0;for(;++e<n.length;){const o=n.charCodeAt(e);let s="";if(o===37&&un(n.charCodeAt(e+1))&&un(n.charCodeAt(e+2)))i=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(s=String.fromCharCode(o));else if(o>55295&&o<57344){const u=n.charCodeAt(e+1);o<56320&&u>56319&&u<57344?(s=String.fromCharCode(o,u),i=1):s="�"}else s=String.fromCharCode(o);s&&(t.push(n.slice(r,e),encodeURIComponent(s)),r=e+i+1,s=""),i&&(e+=i,i=0)}return t.join("")+n.slice(r)}const _r={}.hasOwnProperty,zr=/^(https?|ircs?|mailto|xmpp)$/i,Vo=/^https?$/i;function Wo(n){const t=n||{};let e=!0;const r={},i=[[]],o=[],s=[],c=Fo([{enter:{blockQuote:q,codeFenced:R,codeFencedFenceInfo:k,codeFencedFenceMeta:k,codeIndented:j,codeText:lc,content:Ga,definition:En,definitionDestinationString:ue,definitionLabelString:k,definitionTitleString:k,emphasis:sc,htmlFlow:oc,htmlText:Xi,image:b,label:k,link:X,listItemMarker:L,listItemValue:N,listOrdered:A,listUnordered:I,paragraph:v,reference:k,resource:An,resourceDestinationString:pn,resourceTitleString:k,setextHeading:Xa,strong:uc},exit:{atxHeading:nc,atxHeadingSequence:Qa,autolinkEmail:pc,autolinkProtocol:gc,blockQuote:S,characterEscapeValue:It,characterReferenceMarkerHexadecimal:Ji,characterReferenceMarkerNumeric:Ji,characterReferenceValue:dc,codeFenced:V,codeFencedFence:p,codeFencedFenceInfo:D,codeFencedFenceMeta:d,codeFlowValue:ic,codeIndented:V,codeText:ac,codeTextData:It,data:It,definition:Ya,definitionDestinationString:le,definitionLabelString:tt,definitionTitleString:Ka,emphasis:cc,hardBreakEscape:Gi,hardBreakTrailing:Gi,htmlFlow:Qi,htmlFlowData:It,htmlText:Qi,htmlTextData:It,image:jn,label:W,labelText:xn,lineEnding:rc,link:jn,listOrdered:z,listUnordered:T,paragraph:O,reference:d,referenceString:gn,resource:d,resourceDestinationString:yn,resourceTitleString:mt,setextHeading:ec,setextHeadingLineSequence:tc,setextHeadingText:Ja,strong:fc,thematicBreak:hc}}].concat(t.htmlExtensions||[])),a={tightStack:s,definitions:r},f={lineEndingIfNeeded:C,options:t,encode:m,raw:E,tag:y,buffer:k,resume:d,setData:x,getData:w};let l=t.defaultLineEnding;return g;function g(B){let $=-1,mn=0;const zn=[];let $n=[],Vn=[];for(;++$<B.length;)!l&&(B[$][1].type==="lineEnding"||B[$][1].type==="lineEndingBlank")&&(l=B[$][2].sliceSerialize(B[$][1])),(B[$][1].type==="listOrdered"||B[$][1].type==="listUnordered")&&(B[$][0]==="enter"?zn.push($):h(B.slice(zn.pop(),$))),B[$][1].type==="definition"&&(B[$][0]==="enter"?(Vn=sn(Vn,B.slice(mn,$)),mn=$):($n=sn($n,B.slice(mn,$+1)),mn=$+1));$n=sn($n,Vn),$n=sn($n,B.slice(mn)),$=-1;const Ln=$n;for(c.enter.null&&c.enter.null.call(f);++$<B.length;){const no=c[Ln[$][0]],to=Ln[$][1].type,eo=no[to];_r.call(no,to)&&eo&&eo.call(Object.assign({sliceSerialize:Ln[$][2].sliceSerialize},f),Ln[$][1])}return c.exit.null&&c.exit.null.call(f),i[0].join("")}function h(B){const $=B.length;let mn=0,zn=0,$n=!1,Vn;for(;++mn<$;){const Ln=B[mn];if(Ln[1]._container)Vn=void 0,Ln[0]==="enter"?zn++:zn--;else switch(Ln[1].type){case"listItemPrefix":{Ln[0]==="exit"&&(Vn=!0);break}case"linePrefix":break;case"lineEndingBlank":{Ln[0]==="enter"&&!zn&&(Vn?Vn=void 0:$n=!0);break}default:Vn=void 0}}B[0][1]._loose=$n}function x(B,$){a[B]=$}function w(B){return a[B]}function k(){i.push([])}function d(){return i.pop().join("")}function y(B){e&&(x("lastWasTag",!0),i[i.length-1].push(B))}function E(B){x("lastWasTag"),i[i.length-1].push(B)}function _(){E(l||`
`)}function C(){const B=i[i.length-1],$=B[B.length-1],mn=$?$.charCodeAt($.length-1):null;mn===10||mn===13||mn===null||_()}function m(B){return w("ignoreEncode")?B:Cr(B)}function A(B){s.push(!B._loose),C(),y("<ol"),x("expectFirstItem",!0)}function I(B){s.push(!B._loose),C(),y("<ul"),x("expectFirstItem",!0)}function N(B){if(w("expectFirstItem")){const $=Number.parseInt(this.sliceSerialize(B),10);$!==1&&y(' start="'+m(String($))+'"')}}function L(){w("expectFirstItem")?y(">"):F(),C(),y("<li>"),x("expectFirstItem"),x("lastWasTag")}function z(){F(),s.pop(),_(),y("</ol>")}function T(){F(),s.pop(),_(),y("</ul>")}function F(){w("lastWasTag")&&!w("slurpAllLineEndings")&&C(),y("</li>"),x("slurpAllLineEndings")}function q(){s.push(!1),C(),y("<blockquote>")}function S(){s.pop(),C(),y("</blockquote>"),x("slurpAllLineEndings")}function v(){s[s.length-1]||(C(),y("<p>")),x("slurpAllLineEndings")}function O(){s[s.length-1]?x("slurpAllLineEndings",!0):y("</p>")}function R(){C(),y("<pre><code"),x("fencesCount",0)}function D(){const B=d();y(' class="language-'+B+'"')}function p(){const B=w("fencesCount")||0;B||(y(">"),x("slurpOneLineEnding",!0)),x("fencesCount",B+1)}function j(){C(),y("<pre><code>")}function V(){const B=w("fencesCount");B!==void 0&&B<2&&a.tightStack.length>0&&!w("lastWasTag")&&_(),w("flowCodeSeenData")&&C(),y("</code></pre>"),B!==void 0&&B<2&&C(),x("flowCodeSeenData"),x("fencesCount"),x("slurpOneLineEnding")}function b(){o.push({image:!0}),e=void 0}function X(){o.push({})}function xn(B){o[o.length-1].labelId=this.sliceSerialize(B)}function W(){o[o.length-1].label=d()}function gn(B){o[o.length-1].referenceId=this.sliceSerialize(B)}function An(){k(),o[o.length-1].destination=""}function pn(){k(),x("ignoreEncode",!0)}function yn(){o[o.length-1].destination=d(),x("ignoreEncode")}function mt(){o[o.length-1].title=d()}function jn(){let B=o.length-1;const $=o[B],mn=$.referenceId||$.labelId,zn=$.destination===void 0?r[Et(mn)]:$;for(e=!0;B--;)if(o[B].image){e=void 0;break}$.image?(y('<img src="'+kt(zn.destination,t.allowDangerousProtocol?void 0:Vo)+'" alt="'),E($.label),y('"')):y('<a href="'+kt(zn.destination,t.allowDangerousProtocol?void 0:zr)+'"'),y(zn.title?' title="'+zn.title+'"':""),$.image?y(" />"):(y(">"),E($.label),y("</a>")),o.pop()}function En(){k(),o.push({})}function tt(B){d(),o[o.length-1].labelId=this.sliceSerialize(B)}function ue(){k(),x("ignoreEncode",!0)}function le(){o[o.length-1].destination=d(),x("ignoreEncode")}function Ka(){o[o.length-1].title=d()}function Ya(){const B=o[o.length-1],$=Et(B.labelId);d(),_r.call(r,$)||(r[$]=o[o.length-1]),o.pop()}function Ga(){x("slurpAllLineEndings",!0)}function Qa(B){w("headingRank")||(x("headingRank",this.sliceSerialize(B).length),C(),y("<h"+w("headingRank")+">"))}function Xa(){k(),x("slurpAllLineEndings")}function Ja(){x("slurpAllLineEndings",!0)}function nc(){y("</h"+w("headingRank")+">"),x("headingRank")}function tc(B){x("headingRank",this.sliceSerialize(B).charCodeAt(0)===61?1:2)}function ec(){const B=d();C(),y("<h"+w("headingRank")+">"),E(B),y("</h"+w("headingRank")+">"),x("slurpAllLineEndings"),x("headingRank")}function It(B){E(m(this.sliceSerialize(B)))}function rc(B){if(!w("slurpAllLineEndings")){if(w("slurpOneLineEnding")){x("slurpOneLineEnding");return}if(w("inCodeText")){E(" ");return}E(m(this.sliceSerialize(B)))}}function ic(B){E(m(this.sliceSerialize(B))),x("flowCodeSeenData",!0)}function Gi(){y("<br />")}function oc(){C(),Xi()}function Qi(){x("ignoreEncode")}function Xi(){t.allowDangerousHtml&&x("ignoreEncode",!0)}function sc(){y("<em>")}function uc(){y("<strong>")}function lc(){x("inCodeText",!0),y("<code>")}function ac(){x("inCodeText"),y("</code>")}function cc(){y("</em>")}function fc(){y("</strong>")}function hc(){C(),y("<hr />")}function Ji(B){x("characterReferenceType",B.type)}function dc(B){let $=this.sliceSerialize(B);$=w("characterReferenceType")?No($,w("characterReferenceType")==="characterReferenceMarkerNumeric"?10:16):Ar($),E(m($)),x("characterReferenceType")}function gc(B){const $=this.sliceSerialize(B);y('<a href="'+kt($,t.allowDangerousProtocol?void 0:zr)+'">'),E(m($)),y("</a>")}function pc(B){const $=this.sliceSerialize(B);y('<a href="'+kt("mailto:"+$)+'">'),E(m($)),y("</a>")}}function M(n,t,e,r){const i=r?r-1:Number.POSITIVE_INFINITY;let o=0;return s;function s(c){return U(c)?(n.enter(e),u(c)):t(c)}function u(c){return U(c)&&o++<i?(n.consume(c),u):(n.exit(e),t(c))}}const Zo={tokenize:Ko};function Ko(n){const t=n.attempt(this.parser.constructs.contentInitial,r,i);let e;return t;function r(u){if(u===null){n.consume(u);return}return n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),M(n,t,"linePrefix")}function i(u){return n.enter("paragraph"),o(u)}function o(u){const c=n.enter("chunkText",{contentType:"text",previous:e});return e&&(e.next=c),e=c,s(u)}function s(u){if(u===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(u);return}return P(u)?(n.consume(u),n.exit("chunkText"),o):(n.consume(u),s)}}const Yo={tokenize:Go},vr={tokenize:Qo};function Go(n){const t=this,e=[];let r=0,i,o,s;return u;function u(E){if(r<e.length){const _=e[r];return t.containerState=_[1],n.attempt(_[0].continuation,c,a)(E)}return a(E)}function c(E){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&y();const _=t.events.length;let C=_,m;for(;C--;)if(t.events[C][0]==="exit"&&t.events[C][1].type==="chunkFlow"){m=t.events[C][1].end;break}d(r);let A=_;for(;A<t.events.length;)t.events[A][1].end=Object.assign({},m),A++;return vn(t.events,C+1,0,t.events.slice(_)),t.events.length=A,a(E)}return u(E)}function a(E){if(r===e.length){if(!i)return g(E);if(i.currentConstruct&&i.currentConstruct.concrete)return x(E);t.interrupt=Boolean(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},n.check(vr,f,l)(E)}function f(E){return i&&y(),d(r),g(E)}function l(E){return t.parser.lazy[t.now().line]=r!==e.length,s=t.now().offset,x(E)}function g(E){return t.containerState={},n.attempt(vr,h,x)(E)}function h(E){return r++,e.push([t.currentConstruct,t.containerState]),g(E)}function x(E){if(E===null){i&&y(),d(0),n.consume(E);return}return i=i||t.parser.flow(t.now()),n.enter("chunkFlow",{contentType:"flow",previous:o,_tokenizer:i}),w(E)}function w(E){if(E===null){k(n.exit("chunkFlow"),!0),d(0),n.consume(E);return}return P(E)?(n.consume(E),k(n.exit("chunkFlow")),r=0,t.interrupt=void 0,u):(n.consume(E),w)}function k(E,_){const C=t.sliceStream(E);if(_&&C.push(null),E.previous=o,o&&(o.next=E),o=E,i.defineSkip(E.start),i.write(C),t.parser.lazy[E.start.line]){let m=i.events.length;for(;m--;)if(i.events[m][1].start.offset<s&&(!i.events[m][1].end||i.events[m][1].end.offset>s))return;const A=t.events.length;let I=A,N,L;for(;I--;)if(t.events[I][0]==="exit"&&t.events[I][1].type==="chunkFlow"){if(N){L=t.events[I][1].end;break}N=!0}for(d(r),m=A;m<t.events.length;)t.events[m][1].end=Object.assign({},L),m++;vn(t.events,I+1,0,t.events.slice(A)),t.events.length=m}}function d(E){let _=e.length;for(;_-- >E;){const C=e[_];t.containerState=C[1],C[0].exit.call(t,n)}e.length=E}function y(){i.write([null]),o=void 0,i=void 0,t.containerState._closeFlow=void 0}}function Qo(n,t,e){return M(n,n.attempt(this.parser.constructs.document,t,e),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Br(n){if(n===null||G(n)||ct(n))return 1;if(xe(n))return 2}function ye(n,t,e){const r=[];let i=-1;for(;++i<n.length;){const o=n[i].resolveAll;o&&!r.includes(o)&&(t=o(t,e),r.push(o))}return t}const Ee={name:"attention",tokenize:Jo,resolveAll:Xo};function Xo(n,t){let e=-1,r,i,o,s,u,c,a,f;for(;++e<n.length;)if(n[e][0]==="enter"&&n[e][1].type==="attentionSequence"&&n[e][1]._close){for(r=e;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&t.sliceSerialize(n[r][1]).charCodeAt(0)===t.sliceSerialize(n[e][1]).charCodeAt(0)){if((n[r][1]._close||n[e][1]._open)&&(n[e][1].end.offset-n[e][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[e][1].end.offset-n[e][1].start.offset)%3))continue;c=n[r][1].end.offset-n[r][1].start.offset>1&&n[e][1].end.offset-n[e][1].start.offset>1?2:1;const l=Object.assign({},n[r][1].end),g=Object.assign({},n[e][1].start);Ir(l,-c),Ir(g,c),s={type:c>1?"strongSequence":"emphasisSequence",start:l,end:Object.assign({},n[r][1].end)},u={type:c>1?"strongSequence":"emphasisSequence",start:Object.assign({},n[e][1].start),end:g},o={type:c>1?"strongText":"emphasisText",start:Object.assign({},n[r][1].end),end:Object.assign({},n[e][1].start)},i={type:c>1?"strong":"emphasis",start:Object.assign({},s.start),end:Object.assign({},u.end)},n[r][1].end=Object.assign({},s.start),n[e][1].start=Object.assign({},u.end),a=[],n[r][1].end.offset-n[r][1].start.offset&&(a=sn(a,[["enter",n[r][1],t],["exit",n[r][1],t]])),a=sn(a,[["enter",i,t],["enter",s,t],["exit",s,t],["enter",o,t]]),a=sn(a,ye(t.parser.constructs.insideSpan.null,n.slice(r+1,e),t)),a=sn(a,[["exit",o,t],["enter",u,t],["exit",u,t],["exit",i,t]]),n[e][1].end.offset-n[e][1].start.offset?(f=2,a=sn(a,[["enter",n[e][1],t],["exit",n[e][1],t]])):f=0,vn(n,r-1,e-r+3,a),e=r+a.length-f-2;break}}for(e=-1;++e<n.length;)n[e][1].type==="attentionSequence"&&(n[e][1].type="data");return n}function Jo(n,t){const e=this.parser.constructs.attentionMarkers.null,r=this.previous,i=Br(r);let o;return s;function s(c){return o=c,n.enter("attentionSequence"),u(c)}function u(c){if(c===o)return n.consume(c),u;const a=n.exit("attentionSequence"),f=Br(c),l=!f||f===2&&i||e.includes(c),g=!i||i===2&&f||e.includes(r);return a._open=Boolean(o===42?l:l&&(i||!g)),a._close=Boolean(o===42?g:g&&(f||!l)),t(c)}}function Ir(n,t){n.column+=t,n.offset+=t,n._bufferIndex+=t}const ns={name:"autolink",tokenize:ts};function ts(n,t,e){let r=0;return i;function i(h){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(h),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),o}function o(h){return cn(h)?(n.consume(h),s):a(h)}function s(h){return h===43||h===45||h===46||un(h)?(r=1,u(h)):a(h)}function u(h){return h===58?(n.consume(h),r=0,c):(h===43||h===45||h===46||un(h))&&r++<32?(n.consume(h),u):(r=0,a(h))}function c(h){return h===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(h),n.exit("autolinkMarker"),n.exit("autolink"),t):h===null||h===32||h===60||Dt(h)?e(h):(n.consume(h),c)}function a(h){return h===64?(n.consume(h),f):qo(h)?(n.consume(h),a):e(h)}function f(h){return un(h)?l(h):e(h)}function l(h){return h===46?(n.consume(h),r=0,f):h===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(h),n.exit("autolinkMarker"),n.exit("autolink"),t):g(h)}function g(h){if((h===45||un(h))&&r++<63){const x=h===45?g:l;return n.consume(h),x}return e(h)}}const Ut={tokenize:es,partial:!0};function es(n,t,e){return r;function r(o){return U(o)?M(n,i,"linePrefix")(o):i(o)}function i(o){return o===null||P(o)?t(o):e(o)}}const Tr={name:"blockQuote",tokenize:rs,continuation:{tokenize:is},exit:os};function rs(n,t,e){const r=this;return i;function i(s){if(s===62){const u=r.containerState;return u.open||(n.enter("blockQuote",{_container:!0}),u.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(s),n.exit("blockQuoteMarker"),o}return e(s)}function o(s){return U(s)?(n.enter("blockQuotePrefixWhitespace"),n.consume(s),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),t):(n.exit("blockQuotePrefix"),t(s))}}function is(n,t,e){const r=this;return i;function i(s){return U(s)?M(n,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):o(s)}function o(s){return n.attempt(Tr,t,e)(s)}}function os(n){n.exit("blockQuote")}const Or={name:"characterEscape",tokenize:ss};function ss(n,t,e){return r;function r(o){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(o),n.exit("escapeMarker"),i}function i(o){return Mo(o)?(n.enter("characterEscapeValue"),n.consume(o),n.exit("characterEscapeValue"),n.exit("characterEscape"),t):e(o)}}const $r={name:"characterReference",tokenize:us};function us(n,t,e){const r=this;let i=0,o,s;return u;function u(l){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(l),n.exit("characterReferenceMarker"),c}function c(l){return l===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(l),n.exit("characterReferenceMarkerNumeric"),a):(n.enter("characterReferenceValue"),o=31,s=un,f(l))}function a(l){return l===88||l===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(l),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),o=6,s=Ho,f):(n.enter("characterReferenceValue"),o=7,s=we,f(l))}function f(l){if(l===59&&i){const g=n.exit("characterReferenceValue");return s===un&&!Ar(r.sliceSerialize(g))?e(l):(n.enter("characterReferenceMarker"),n.consume(l),n.exit("characterReferenceMarker"),n.exit("characterReference"),t)}return s(l)&&i++<o?(n.consume(l),f):e(l)}}const Lr={tokenize:as,partial:!0},Pr={name:"codeFenced",tokenize:ls,concrete:!0};function ls(n,t,e){const r=this,i={tokenize:C,partial:!0};let o=0,s=0,u;return c;function c(m){return a(m)}function a(m){const A=r.events[r.events.length-1];return o=A&&A[1].type==="linePrefix"?A[2].sliceSerialize(A[1],!0).length:0,u=m,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),f(m)}function f(m){return m===u?(s++,n.consume(m),f):s<3?e(m):(n.exit("codeFencedFenceSequence"),U(m)?M(n,l,"whitespace")(m):l(m))}function l(m){return m===null||P(m)?(n.exit("codeFencedFence"),r.interrupt?t(m):n.check(Lr,w,_)(m)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),g(m))}function g(m){return m===null||P(m)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),l(m)):U(m)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),M(n,h,"whitespace")(m)):m===96&&m===u?e(m):(n.consume(m),g)}function h(m){return m===null||P(m)?l(m):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),x(m))}function x(m){return m===null||P(m)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),l(m)):m===96&&m===u?e(m):(n.consume(m),x)}function w(m){return n.attempt(i,_,k)(m)}function k(m){return n.enter("lineEnding"),n.consume(m),n.exit("lineEnding"),d}function d(m){return o>0&&U(m)?M(n,y,"linePrefix",o+1)(m):y(m)}function y(m){return m===null||P(m)?n.check(Lr,w,_)(m):(n.enter("codeFlowValue"),E(m))}function E(m){return m===null||P(m)?(n.exit("codeFlowValue"),y(m)):(n.consume(m),E)}function _(m){return n.exit("codeFenced"),t(m)}function C(m,A,I){let N=0;return L;function L(S){return m.enter("lineEnding"),m.consume(S),m.exit("lineEnding"),z}function z(S){return m.enter("codeFencedFence"),U(S)?M(m,T,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(S):T(S)}function T(S){return S===u?(m.enter("codeFencedFenceSequence"),F(S)):I(S)}function F(S){return S===u?(N++,m.consume(S),F):N>=s?(m.exit("codeFencedFenceSequence"),U(S)?M(m,q,"whitespace")(S):q(S)):I(S)}function q(S){return S===null||P(S)?(m.exit("codeFencedFence"),A(S)):I(S)}}}function as(n,t,e){const r=this;return i;function i(s){return s===null?e(s):(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),o)}function o(s){return r.parser.lazy[r.now().line]?e(s):t(s)}}const ke={name:"codeIndented",tokenize:fs},cs={tokenize:hs,partial:!0};function fs(n,t,e){const r=this;return i;function i(a){return n.enter("codeIndented"),M(n,o,"linePrefix",5)(a)}function o(a){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?s(a):e(a)}function s(a){return a===null?c(a):P(a)?n.attempt(cs,s,c)(a):(n.enter("codeFlowValue"),u(a))}function u(a){return a===null||P(a)?(n.exit("codeFlowValue"),s(a)):(n.consume(a),u)}function c(a){return n.exit("codeIndented"),t(a)}}function hs(n,t,e){const r=this;return i;function i(s){return r.parser.lazy[r.now().line]?e(s):P(s)?(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),i):M(n,o,"linePrefix",5)(s)}function o(s){const u=r.events[r.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?t(s):P(s)?i(s):e(s)}}const ds={name:"codeText",tokenize:ms,resolve:gs,previous:ps};function gs(n){let t=n.length-4,e=3,r,i;if((n[e][1].type==="lineEnding"||n[e][1].type==="space")&&(n[t][1].type==="lineEnding"||n[t][1].type==="space")){for(r=e;++r<t;)if(n[r][1].type==="codeTextData"){n[e][1].type="codeTextPadding",n[t][1].type="codeTextPadding",e+=2,t-=2;break}}for(r=e-1,t++;++r<=t;)i===void 0?r!==t&&n[r][1].type!=="lineEnding"&&(i=r):(r===t||n[r][1].type==="lineEnding")&&(n[i][1].type="codeTextData",r!==i+2&&(n[i][1].end=n[r-1][1].end,n.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return n}function ps(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function ms(n,t,e){let r=0,i,o;return s;function s(l){return n.enter("codeText"),n.enter("codeTextSequence"),u(l)}function u(l){return l===96?(n.consume(l),r++,u):(n.exit("codeTextSequence"),c(l))}function c(l){return l===null?e(l):l===32?(n.enter("space"),n.consume(l),n.exit("space"),c):l===96?(o=n.enter("codeTextSequence"),i=0,f(l)):P(l)?(n.enter("lineEnding"),n.consume(l),n.exit("lineEnding"),c):(n.enter("codeTextData"),a(l))}function a(l){return l===null||l===32||l===96||P(l)?(n.exit("codeTextData"),c(l)):(n.consume(l),a)}function f(l){return l===96?(n.consume(l),i++,f):i===r?(n.exit("codeTextSequence"),n.exit("codeText"),t(l)):(o.type="codeTextData",a(l))}}function Fr(n){const t={};let e=-1,r,i,o,s,u,c,a;for(;++e<n.length;){for(;e in t;)e=t[e];if(r=n[e],e&&r[1].type==="chunkFlow"&&n[e-1][1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,o=0,o<c.length&&c[o][1].type==="lineEndingBlank"&&(o+=2),o<c.length&&c[o][1].type==="content"))for(;++o<c.length&&c[o][1].type!=="content";)c[o][1].type==="chunkText"&&(c[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,bs(n,e)),e=t[e],a=!0);else if(r[1]._container){for(o=e,i=void 0;o--&&(s=n[o],s[1].type==="lineEnding"||s[1].type==="lineEndingBlank");)s[0]==="enter"&&(i&&(n[i][1].type="lineEndingBlank"),s[1].type="lineEnding",i=o);i&&(r[1].end=Object.assign({},n[i][1].start),u=n.slice(i,e),u.unshift(r),vn(n,i,e-i+1,u))}}return!a}function bs(n,t){const e=n[t][1],r=n[t][2];let i=t-1;const o=[],s=e._tokenizer||r.parser[e.contentType](e.start),u=s.events,c=[],a={};let f,l,g=-1,h=e,x=0,w=0;const k=[w];for(;h;){for(;n[++i][1]!==h;);o.push(i),h._tokenizer||(f=r.sliceStream(h),h.next||f.push(null),l&&s.defineSkip(h.start),h._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(f),h._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),l=h,h=h.next}for(h=e;++g<u.length;)u[g][0]==="exit"&&u[g-1][0]==="enter"&&u[g][1].type===u[g-1][1].type&&u[g][1].start.line!==u[g][1].end.line&&(w=g+1,k.push(w),h._tokenizer=void 0,h.previous=void 0,h=h.next);for(s.events=[],h?(h._tokenizer=void 0,h.previous=void 0):k.pop(),g=k.length;g--;){const d=u.slice(k[g],k[g+1]),y=o.pop();c.unshift([y,y+d.length-1]),vn(n,y,2,d)}for(g=-1;++g<c.length;)a[x+c[g][0]]=x+c[g][1],x+=c[g][1]-c[g][0]-1;return a}const ws={tokenize:Es,resolve:ys},xs={tokenize:ks,partial:!0};function ys(n){return Fr(n),n}function Es(n,t){let e;return r;function r(u){return n.enter("content"),e=n.enter("chunkContent",{contentType:"content"}),i(u)}function i(u){return u===null?o(u):P(u)?n.check(xs,s,o)(u):(n.consume(u),i)}function o(u){return n.exit("chunkContent"),n.exit("content"),t(u)}function s(u){return n.consume(u),n.exit("chunkContent"),e.next=n.enter("chunkContent",{contentType:"content",previous:e}),e=e.next,i}}function ks(n,t,e){const r=this;return i;function i(s){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),M(n,o,"linePrefix")}function o(s){if(s===null||P(s))return e(s);const u=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?t(s):n.interrupt(r.parser.constructs.flow,e,t)(s)}}function Rr(n,t,e,r,i,o,s,u,c){const a=c||Number.POSITIVE_INFINITY;let f=0;return l;function l(d){return d===60?(n.enter(r),n.enter(i),n.enter(o),n.consume(d),n.exit(o),g):d===null||d===32||d===41||Dt(d)?e(d):(n.enter(r),n.enter(s),n.enter(u),n.enter("chunkString",{contentType:"string"}),w(d))}function g(d){return d===62?(n.enter(o),n.consume(d),n.exit(o),n.exit(i),n.exit(r),t):(n.enter(u),n.enter("chunkString",{contentType:"string"}),h(d))}function h(d){return d===62?(n.exit("chunkString"),n.exit(u),g(d)):d===null||d===60||P(d)?e(d):(n.consume(d),d===92?x:h)}function x(d){return d===60||d===62||d===92?(n.consume(d),h):h(d)}function w(d){return!f&&(d===null||d===41||G(d))?(n.exit("chunkString"),n.exit(u),n.exit(s),n.exit(r),t(d)):f<a&&d===40?(n.consume(d),f++,w):d===41?(n.consume(d),f--,w):d===null||d===32||d===40||Dt(d)?e(d):(n.consume(d),d===92?k:w)}function k(d){return d===40||d===41||d===92?(n.consume(d),w):w(d)}}function Nr(n,t,e,r,i,o){const s=this;let u=0,c;return a;function a(h){return n.enter(r),n.enter(i),n.consume(h),n.exit(i),n.enter(o),f}function f(h){return u>999||h===null||h===91||h===93&&!c||h===94&&!u&&"_hiddenFootnoteSupport"in s.parser.constructs?e(h):h===93?(n.exit(o),n.enter(i),n.consume(h),n.exit(i),n.exit(r),t):P(h)?(n.enter("lineEnding"),n.consume(h),n.exit("lineEnding"),f):(n.enter("chunkString",{contentType:"string"}),l(h))}function l(h){return h===null||h===91||h===93||P(h)||u++>999?(n.exit("chunkString"),f(h)):(n.consume(h),c||(c=!U(h)),h===92?g:l)}function g(h){return h===91||h===92||h===93?(n.consume(h),u++,l):l(h)}}function Dr(n,t,e,r,i,o){let s;return u;function u(g){return g===34||g===39||g===40?(n.enter(r),n.enter(i),n.consume(g),n.exit(i),s=g===40?41:g,c):e(g)}function c(g){return g===s?(n.enter(i),n.consume(g),n.exit(i),n.exit(r),t):(n.enter(o),a(g))}function a(g){return g===s?(n.exit(o),c(s)):g===null?e(g):P(g)?(n.enter("lineEnding"),n.consume(g),n.exit("lineEnding"),M(n,a,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),f(g))}function f(g){return g===s||g===null||P(g)?(n.exit("chunkString"),a(g)):(n.consume(g),g===92?l:f)}function l(g){return g===s||g===92?(n.consume(g),f):f(g)}}function St(n,t){let e;return r;function r(i){return P(i)?(n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),e=!0,r):U(i)?M(n,r,e?"linePrefix":"lineSuffix")(i):t(i)}}const Ss={name:"definition",tokenize:Cs},As={tokenize:_s,partial:!0};function Cs(n,t,e){const r=this;let i;return o;function o(h){return n.enter("definition"),s(h)}function s(h){return Nr.call(r,n,u,e,"definitionLabel","definitionLabelMarker","definitionLabelString")(h)}function u(h){return i=Et(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),h===58?(n.enter("definitionMarker"),n.consume(h),n.exit("definitionMarker"),c):e(h)}function c(h){return G(h)?St(n,a)(h):a(h)}function a(h){return Rr(n,f,e,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(h)}function f(h){return n.attempt(As,l,l)(h)}function l(h){return U(h)?M(n,g,"whitespace")(h):g(h)}function g(h){return h===null||P(h)?(n.exit("definition"),r.parser.defined.push(i),t(h)):e(h)}}function _s(n,t,e){return r;function r(u){return G(u)?St(n,i)(u):e(u)}function i(u){return Dr(n,o,e,"definitionTitle","definitionTitleMarker","definitionTitleString")(u)}function o(u){return U(u)?M(n,s,"whitespace")(u):s(u)}function s(u){return u===null||P(u)?t(u):e(u)}}const zs={name:"hardBreakEscape",tokenize:vs};function vs(n,t,e){return r;function r(o){return n.enter("hardBreakEscape"),n.consume(o),i}function i(o){return P(o)?(n.exit("hardBreakEscape"),t(o)):e(o)}}const Bs={name:"headingAtx",tokenize:Ts,resolve:Is};function Is(n,t){let e=n.length-2,r=3,i,o;return n[r][1].type==="whitespace"&&(r+=2),e-2>r&&n[e][1].type==="whitespace"&&(e-=2),n[e][1].type==="atxHeadingSequence"&&(r===e-1||e-4>r&&n[e-2][1].type==="whitespace")&&(e-=r+1===e?2:4),e>r&&(i={type:"atxHeadingText",start:n[r][1].start,end:n[e][1].end},o={type:"chunkText",start:n[r][1].start,end:n[e][1].end,contentType:"text"},vn(n,r,e-r+1,[["enter",i,t],["enter",o,t],["exit",o,t],["exit",i,t]])),n}function Ts(n,t,e){let r=0;return i;function i(f){return n.enter("atxHeading"),o(f)}function o(f){return n.enter("atxHeadingSequence"),s(f)}function s(f){return f===35&&r++<6?(n.consume(f),s):f===null||G(f)?(n.exit("atxHeadingSequence"),u(f)):e(f)}function u(f){return f===35?(n.enter("atxHeadingSequence"),c(f)):f===null||P(f)?(n.exit("atxHeading"),t(f)):U(f)?M(n,u,"whitespace")(f):(n.enter("atxHeadingText"),a(f))}function c(f){return f===35?(n.consume(f),c):(n.exit("atxHeadingSequence"),u(f))}function a(f){return f===null||f===35||G(f)?(n.exit("atxHeadingText"),u(f)):(n.consume(f),a)}}const Os=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Ur=["pre","script","style","textarea"],$s={name:"htmlFlow",tokenize:Rs,resolveTo:Fs,concrete:!0},Ls={tokenize:Ds,partial:!0},Ps={tokenize:Ns,partial:!0};function Fs(n){let t=n.length;for(;t--&&!(n[t][0]==="enter"&&n[t][1].type==="htmlFlow"););return t>1&&n[t-2][1].type==="linePrefix"&&(n[t][1].start=n[t-2][1].start,n[t+1][1].start=n[t-2][1].start,n.splice(t-2,2)),n}function Rs(n,t,e){const r=this;let i,o,s,u,c;return a;function a(b){return f(b)}function f(b){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(b),l}function l(b){return b===33?(n.consume(b),g):b===47?(n.consume(b),o=!0,w):b===63?(n.consume(b),i=3,r.interrupt?t:p):cn(b)?(n.consume(b),s=String.fromCharCode(b),k):e(b)}function g(b){return b===45?(n.consume(b),i=2,h):b===91?(n.consume(b),i=5,u=0,x):cn(b)?(n.consume(b),i=4,r.interrupt?t:p):e(b)}function h(b){return b===45?(n.consume(b),r.interrupt?t:p):e(b)}function x(b){const X="CDATA[";return b===X.charCodeAt(u++)?(n.consume(b),u===X.length?r.interrupt?t:T:x):e(b)}function w(b){return cn(b)?(n.consume(b),s=String.fromCharCode(b),k):e(b)}function k(b){if(b===null||b===47||b===62||G(b)){const X=b===47,xn=s.toLowerCase();return!X&&!o&&Ur.includes(xn)?(i=1,r.interrupt?t(b):T(b)):Os.includes(s.toLowerCase())?(i=6,X?(n.consume(b),d):r.interrupt?t(b):T(b)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?e(b):o?y(b):E(b))}return b===45||un(b)?(n.consume(b),s+=String.fromCharCode(b),k):e(b)}function d(b){return b===62?(n.consume(b),r.interrupt?t:T):e(b)}function y(b){return U(b)?(n.consume(b),y):L(b)}function E(b){return b===47?(n.consume(b),L):b===58||b===95||cn(b)?(n.consume(b),_):U(b)?(n.consume(b),E):L(b)}function _(b){return b===45||b===46||b===58||b===95||un(b)?(n.consume(b),_):C(b)}function C(b){return b===61?(n.consume(b),m):U(b)?(n.consume(b),C):E(b)}function m(b){return b===null||b===60||b===61||b===62||b===96?e(b):b===34||b===39?(n.consume(b),c=b,A):U(b)?(n.consume(b),m):I(b)}function A(b){return b===c?(n.consume(b),c=null,N):b===null||P(b)?e(b):(n.consume(b),A)}function I(b){return b===null||b===34||b===39||b===47||b===60||b===61||b===62||b===96||G(b)?C(b):(n.consume(b),I)}function N(b){return b===47||b===62||U(b)?E(b):e(b)}function L(b){return b===62?(n.consume(b),z):e(b)}function z(b){return b===null||P(b)?T(b):U(b)?(n.consume(b),z):e(b)}function T(b){return b===45&&i===2?(n.consume(b),v):b===60&&i===1?(n.consume(b),O):b===62&&i===4?(n.consume(b),j):b===63&&i===3?(n.consume(b),p):b===93&&i===5?(n.consume(b),D):P(b)&&(i===6||i===7)?(n.exit("htmlFlowData"),n.check(Ls,V,F)(b)):b===null||P(b)?(n.exit("htmlFlowData"),F(b)):(n.consume(b),T)}function F(b){return n.check(Ps,q,V)(b)}function q(b){return n.enter("lineEnding"),n.consume(b),n.exit("lineEnding"),S}function S(b){return b===null||P(b)?F(b):(n.enter("htmlFlowData"),T(b))}function v(b){return b===45?(n.consume(b),p):T(b)}function O(b){return b===47?(n.consume(b),s="",R):T(b)}function R(b){if(b===62){const X=s.toLowerCase();return Ur.includes(X)?(n.consume(b),j):T(b)}return cn(b)&&s.length<8?(n.consume(b),s+=String.fromCharCode(b),R):T(b)}function D(b){return b===93?(n.consume(b),p):T(b)}function p(b){return b===62?(n.consume(b),j):b===45&&i===2?(n.consume(b),p):T(b)}function j(b){return b===null||P(b)?(n.exit("htmlFlowData"),V(b)):(n.consume(b),j)}function V(b){return n.exit("htmlFlow"),t(b)}}function Ns(n,t,e){const r=this;return i;function i(s){return P(s)?(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),o):e(s)}function o(s){return r.parser.lazy[r.now().line]?e(s):t(s)}}function Ds(n,t,e){return r;function r(i){return n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),n.attempt(Ut,t,e)}}const Us={name:"htmlText",tokenize:qs};function qs(n,t,e){const r=this;let i,o,s;return u;function u(p){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(p),c}function c(p){return p===33?(n.consume(p),a):p===47?(n.consume(p),C):p===63?(n.consume(p),E):cn(p)?(n.consume(p),I):e(p)}function a(p){return p===45?(n.consume(p),f):p===91?(n.consume(p),o=0,x):cn(p)?(n.consume(p),y):e(p)}function f(p){return p===45?(n.consume(p),h):e(p)}function l(p){return p===null?e(p):p===45?(n.consume(p),g):P(p)?(s=l,O(p)):(n.consume(p),l)}function g(p){return p===45?(n.consume(p),h):l(p)}function h(p){return p===62?v(p):p===45?g(p):l(p)}function x(p){const j="CDATA[";return p===j.charCodeAt(o++)?(n.consume(p),o===j.length?w:x):e(p)}function w(p){return p===null?e(p):p===93?(n.consume(p),k):P(p)?(s=w,O(p)):(n.consume(p),w)}function k(p){return p===93?(n.consume(p),d):w(p)}function d(p){return p===62?v(p):p===93?(n.consume(p),d):w(p)}function y(p){return p===null||p===62?v(p):P(p)?(s=y,O(p)):(n.consume(p),y)}function E(p){return p===null?e(p):p===63?(n.consume(p),_):P(p)?(s=E,O(p)):(n.consume(p),E)}function _(p){return p===62?v(p):E(p)}function C(p){return cn(p)?(n.consume(p),m):e(p)}function m(p){return p===45||un(p)?(n.consume(p),m):A(p)}function A(p){return P(p)?(s=A,O(p)):U(p)?(n.consume(p),A):v(p)}function I(p){return p===45||un(p)?(n.consume(p),I):p===47||p===62||G(p)?N(p):e(p)}function N(p){return p===47?(n.consume(p),v):p===58||p===95||cn(p)?(n.consume(p),L):P(p)?(s=N,O(p)):U(p)?(n.consume(p),N):v(p)}function L(p){return p===45||p===46||p===58||p===95||un(p)?(n.consume(p),L):z(p)}function z(p){return p===61?(n.consume(p),T):P(p)?(s=z,O(p)):U(p)?(n.consume(p),z):N(p)}function T(p){return p===null||p===60||p===61||p===62||p===96?e(p):p===34||p===39?(n.consume(p),i=p,F):P(p)?(s=T,O(p)):U(p)?(n.consume(p),T):(n.consume(p),q)}function F(p){return p===i?(n.consume(p),i=void 0,S):p===null?e(p):P(p)?(s=F,O(p)):(n.consume(p),F)}function q(p){return p===null||p===34||p===39||p===60||p===61||p===96?e(p):p===47||p===62||G(p)?N(p):(n.consume(p),q)}function S(p){return p===47||p===62||G(p)?N(p):e(p)}function v(p){return p===62?(n.consume(p),n.exit("htmlTextData"),n.exit("htmlText"),t):e(p)}function O(p){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(p),n.exit("lineEnding"),R}function R(p){return U(p)?M(n,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(p):D(p)}function D(p){return n.enter("htmlTextData"),s(p)}}const Se={name:"labelEnd",tokenize:Zs,resolveTo:Ws,resolveAll:Vs},Hs={tokenize:Ks},Ms={tokenize:Ys},js={tokenize:Gs};function Vs(n){let t=-1;for(;++t<n.length;){const e=n[t][1];(e.type==="labelImage"||e.type==="labelLink"||e.type==="labelEnd")&&(n.splice(t+1,e.type==="labelImage"?4:2),e.type="data",t++)}return n}function Ws(n,t){let e=n.length,r=0,i,o,s,u;for(;e--;)if(i=n[e][1],o){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;n[e][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(s){if(n[e][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(o=e,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(s=e);const c={type:n[o][1].type==="labelLink"?"link":"image",start:Object.assign({},n[o][1].start),end:Object.assign({},n[n.length-1][1].end)},a={type:"label",start:Object.assign({},n[o][1].start),end:Object.assign({},n[s][1].end)},f={type:"labelText",start:Object.assign({},n[o+r+2][1].end),end:Object.assign({},n[s-2][1].start)};return u=[["enter",c,t],["enter",a,t]],u=sn(u,n.slice(o+1,o+r+3)),u=sn(u,[["enter",f,t]]),u=sn(u,ye(t.parser.constructs.insideSpan.null,n.slice(o+r+4,s-3),t)),u=sn(u,[["exit",f,t],n[s-2],n[s-1],["exit",a,t]]),u=sn(u,n.slice(s+1)),u=sn(u,[["exit",c,t]]),vn(n,o,n.length,u),n}function Zs(n,t,e){const r=this;let i=r.events.length,o,s;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){o=r.events[i][1];break}return u;function u(g){return o?o._inactive?l(g):(s=r.parser.defined.includes(Et(r.sliceSerialize({start:o.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(g),n.exit("labelMarker"),n.exit("labelEnd"),c):e(g)}function c(g){return g===40?n.attempt(Hs,f,s?f:l)(g):g===91?n.attempt(Ms,f,s?a:l)(g):s?f(g):l(g)}function a(g){return n.attempt(js,f,l)(g)}function f(g){return t(g)}function l(g){return o._balanced=!0,e(g)}}function Ks(n,t,e){return r;function r(l){return n.enter("resource"),n.enter("resourceMarker"),n.consume(l),n.exit("resourceMarker"),i}function i(l){return G(l)?St(n,o)(l):o(l)}function o(l){return l===41?f(l):Rr(n,s,u,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(l)}function s(l){return G(l)?St(n,c)(l):f(l)}function u(l){return e(l)}function c(l){return l===34||l===39||l===40?Dr(n,a,e,"resourceTitle","resourceTitleMarker","resourceTitleString")(l):f(l)}function a(l){return G(l)?St(n,f)(l):f(l)}function f(l){return l===41?(n.enter("resourceMarker"),n.consume(l),n.exit("resourceMarker"),n.exit("resource"),t):e(l)}}function Ys(n,t,e){const r=this;return i;function i(u){return Nr.call(r,n,o,s,"reference","referenceMarker","referenceString")(u)}function o(u){return r.parser.defined.includes(Et(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(u):e(u)}function s(u){return e(u)}}function Gs(n,t,e){return r;function r(o){return n.enter("reference"),n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),i}function i(o){return o===93?(n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),n.exit("reference"),t):e(o)}}const Qs={name:"labelStartImage",tokenize:Xs,resolveAll:Se.resolveAll};function Xs(n,t,e){const r=this;return i;function i(u){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(u),n.exit("labelImageMarker"),o}function o(u){return u===91?(n.enter("labelMarker"),n.consume(u),n.exit("labelMarker"),n.exit("labelImage"),s):e(u)}function s(u){return u===94&&"_hiddenFootnoteSupport"in r.parser.constructs?e(u):t(u)}}const Js={name:"labelStartLink",tokenize:nu,resolveAll:Se.resolveAll};function nu(n,t,e){const r=this;return i;function i(s){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(s),n.exit("labelMarker"),n.exit("labelLink"),o}function o(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?e(s):t(s)}}const Ae={name:"lineEnding",tokenize:tu};function tu(n,t){return e;function e(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),M(n,t,"linePrefix")}}const qt={name:"thematicBreak",tokenize:eu};function eu(n,t,e){let r=0,i;return o;function o(a){return n.enter("thematicBreak"),s(a)}function s(a){return i=a,u(a)}function u(a){return a===i?(n.enter("thematicBreakSequence"),c(a)):r>=3&&(a===null||P(a))?(n.exit("thematicBreak"),t(a)):e(a)}function c(a){return a===i?(n.consume(a),r++,c):(n.exit("thematicBreakSequence"),U(a)?M(n,u,"whitespace")(a):u(a))}}const dn={name:"list",tokenize:ou,continuation:{tokenize:su},exit:lu},ru={tokenize:au,partial:!0},iu={tokenize:uu,partial:!0};function ou(n,t,e){const r=this,i=r.events[r.events.length-1];let o=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,s=0;return u;function u(h){const x=r.containerState.type||(h===42||h===43||h===45?"listUnordered":"listOrdered");if(x==="listUnordered"?!r.containerState.marker||h===r.containerState.marker:we(h)){if(r.containerState.type||(r.containerState.type=x,n.enter(x,{_container:!0})),x==="listUnordered")return n.enter("listItemPrefix"),h===42||h===45?n.check(qt,e,a)(h):a(h);if(!r.interrupt||h===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),c(h)}return e(h)}function c(h){return we(h)&&++s<10?(n.consume(h),c):(!r.interrupt||s<2)&&(r.containerState.marker?h===r.containerState.marker:h===41||h===46)?(n.exit("listItemValue"),a(h)):e(h)}function a(h){return n.enter("listItemMarker"),n.consume(h),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||h,n.check(Ut,r.interrupt?e:f,n.attempt(ru,g,l))}function f(h){return r.containerState.initialBlankLine=!0,o++,g(h)}function l(h){return U(h)?(n.enter("listItemPrefixWhitespace"),n.consume(h),n.exit("listItemPrefixWhitespace"),g):e(h)}function g(h){return r.containerState.size=o+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,t(h)}}function su(n,t,e){const r=this;return r.containerState._closeFlow=void 0,n.check(Ut,i,o);function i(u){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,M(n,t,"listItemIndent",r.containerState.size+1)(u)}function o(u){return r.containerState.furtherBlankLines||!U(u)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,s(u)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(iu,t,s)(u))}function s(u){return r.containerState._closeFlow=!0,r.interrupt=void 0,M(n,n.attempt(dn,t,e),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u)}}function uu(n,t,e){const r=this;return M(n,i,"listItemIndent",r.containerState.size+1);function i(o){const s=r.events[r.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===r.containerState.size?t(o):e(o)}}function lu(n){n.exit(this.containerState.type)}function au(n,t,e){const r=this;return M(n,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(o){const s=r.events[r.events.length-1];return!U(o)&&s&&s[1].type==="listItemPrefixWhitespace"?t(o):e(o)}}const qr={name:"setextUnderline",tokenize:fu,resolveTo:cu};function cu(n,t){let e=n.length,r,i,o;for(;e--;)if(n[e][0]==="enter"){if(n[e][1].type==="content"){r=e;break}n[e][1].type==="paragraph"&&(i=e)}else n[e][1].type==="content"&&n.splice(e,1),!o&&n[e][1].type==="definition"&&(o=e);const s={type:"setextHeading",start:Object.assign({},n[i][1].start),end:Object.assign({},n[n.length-1][1].end)};return n[i][1].type="setextHeadingText",o?(n.splice(i,0,["enter",s,t]),n.splice(o+1,0,["exit",n[r][1],t]),n[r][1].end=Object.assign({},n[o][1].end)):n[r][1]=s,n.push(["exit",s,t]),n}function fu(n,t,e){const r=this;let i;return o;function o(a){let f=r.events.length,l;for(;f--;)if(r.events[f][1].type!=="lineEnding"&&r.events[f][1].type!=="linePrefix"&&r.events[f][1].type!=="content"){l=r.events[f][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||l)?(n.enter("setextHeadingLine"),i=a,s(a)):e(a)}function s(a){return n.enter("setextHeadingLineSequence"),u(a)}function u(a){return a===i?(n.consume(a),u):(n.exit("setextHeadingLineSequence"),U(a)?M(n,c,"lineSuffix")(a):c(a))}function c(a){return a===null||P(a)?(n.exit("setextHeadingLine"),t(a)):e(a)}}const hu={tokenize:du};function du(n){const t=this,e=n.attempt(Ut,r,n.attempt(this.parser.constructs.flowInitial,i,M(n,n.attempt(this.parser.constructs.flow,i,n.attempt(ws,i)),"linePrefix")));return e;function r(o){if(o===null){n.consume(o);return}return n.enter("lineEndingBlank"),n.consume(o),n.exit("lineEndingBlank"),t.currentConstruct=void 0,e}function i(o){if(o===null){n.consume(o);return}return n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),t.currentConstruct=void 0,e}}const gu={resolveAll:Mr()},pu=Hr("string"),mu=Hr("text");function Hr(n){return{tokenize:t,resolveAll:Mr(n==="text"?bu:void 0)};function t(e){const r=this,i=this.parser.constructs[n],o=e.attempt(i,s,u);return s;function s(f){return a(f)?o(f):u(f)}function u(f){if(f===null){e.consume(f);return}return e.enter("data"),e.consume(f),c}function c(f){return a(f)?(e.exit("data"),o(f)):(e.consume(f),c)}function a(f){if(f===null)return!0;const l=i[f];let g=-1;if(l)for(;++g<l.length;){const h=l[g];if(!h.previous||h.previous.call(r,r.previous))return!0}return!1}}}function Mr(n){return t;function t(e,r){let i=-1,o;for(;++i<=e.length;)o===void 0?e[i]&&e[i][1].type==="data"&&(o=i,i++):(!e[i]||e[i][1].type!=="data")&&(i!==o+2&&(e[o][1].end=e[i-1][1].end,e.splice(o+2,i-o-2),i=o+2),o=void 0);return n?n(e,r):e}}function bu(n,t){let e=0;for(;++e<=n.length;)if((e===n.length||n[e][1].type==="lineEnding")&&n[e-1][1].type==="data"){const r=n[e-1][1],i=t.sliceStream(r);let o=i.length,s=-1,u=0,c;for(;o--;){const a=i[o];if(typeof a=="string"){for(s=a.length;a.charCodeAt(s-1)===32;)u++,s--;if(s)break;s=-1}else if(a===-2)c=!0,u++;else if(a!==-1){o++;break}}if(u){const a={type:e===n.length||c||u<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-u,offset:r.end.offset-u,_index:r.start._index+o,_bufferIndex:o?s:r.start._bufferIndex+s},end:Object.assign({},r.end)};r.end=Object.assign({},a.start),r.start.offset===r.end.offset?Object.assign(r,a):(n.splice(e,0,["enter",a,t],["exit",a,t]),e+=2)}e++}return n}function wu(n,t,e){let r=Object.assign(e?Object.assign({},e):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const i={},o=[];let s=[],u=[];const c={consume:y,enter:E,exit:_,attempt:A(C),check:A(m),interrupt:A(m,{interrupt:!0})},a={previous:null,code:null,containerState:{},events:[],parser:n,sliceStream:h,sliceSerialize:g,now:x,defineSkip:w,write:l};let f=t.tokenize.call(a,c);return t.resolveAll&&o.push(t),a;function l(z){return s=sn(s,z),k(),s[s.length-1]!==null?[]:(I(t,0),a.events=ye(o,a.events,a),a.events)}function g(z,T){return yu(h(z),T)}function h(z){return xu(s,z)}function x(){const{line:z,column:T,offset:F,_index:q,_bufferIndex:S}=r;return{line:z,column:T,offset:F,_index:q,_bufferIndex:S}}function w(z){i[z.line]=z.column,L()}function k(){let z;for(;r._index<s.length;){const T=s[r._index];if(typeof T=="string")for(z=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===z&&r._bufferIndex<T.length;)d(T.charCodeAt(r._bufferIndex));else d(T)}}function d(z){f=f(z)}function y(z){P(z)?(r.line++,r.column=1,r.offset+=z===-3?2:1,L()):z!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++)),a.previous=z}function E(z,T){const F=T||{};return F.type=z,F.start=x(),a.events.push(["enter",F,a]),u.push(F),F}function _(z){const T=u.pop();return T.end=x(),a.events.push(["exit",T,a]),T}function C(z,T){I(z,T.from)}function m(z,T){T.restore()}function A(z,T){return F;function F(q,S,v){let O,R,D,p;return Array.isArray(q)?V(q):"tokenize"in q?V([q]):j(q);function j(W){return gn;function gn(An){const pn=An!==null&&W[An],yn=An!==null&&W.null,mt=[...Array.isArray(pn)?pn:pn?[pn]:[],...Array.isArray(yn)?yn:yn?[yn]:[]];return V(mt)(An)}}function V(W){return O=W,R=0,W.length===0?v:b(W[R])}function b(W){return gn;function gn(An){return p=N(),D=W,W.partial||(a.currentConstruct=W),W.name&&a.parser.constructs.disable.null.includes(W.name)?xn():W.tokenize.call(T?Object.assign(Object.create(a),T):a,c,X,xn)(An)}}function X(W){return z(D,p),S}function xn(W){return p.restore(),++R<O.length?b(O[R]):v}}}function I(z,T){z.resolveAll&&!o.includes(z)&&o.push(z),z.resolve&&vn(a.events,T,a.events.length-T,z.resolve(a.events.slice(T),a)),z.resolveTo&&(a.events=z.resolveTo(a.events,a))}function N(){const z=x(),T=a.previous,F=a.currentConstruct,q=a.events.length,S=Array.from(u);return{restore:v,from:q};function v(){r=z,a.previous=T,a.currentConstruct=F,a.events.length=q,u=S,L()}}function L(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function xu(n,t){const e=t.start._index,r=t.start._bufferIndex,i=t.end._index,o=t.end._bufferIndex;let s;if(e===i)s=[n[e].slice(r,o)];else{if(s=n.slice(e,i),r>-1){const u=s[0];typeof u=="string"?s[0]=u.slice(r):s.shift()}o>0&&s.push(n[i].slice(0,o))}return s}function yu(n,t){let e=-1;const r=[];let i;for(;++e<n.length;){const o=n[e];let s;if(typeof o=="string")s=o;else switch(o){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=t?" ":"	";break}case-1:{if(!t&&i)continue;s=" ";break}default:s=String.fromCharCode(o)}i=o===-2,r.push(s)}return r.join("")}const Eu={[42]:dn,[43]:dn,[45]:dn,[48]:dn,[49]:dn,[50]:dn,[51]:dn,[52]:dn,[53]:dn,[54]:dn,[55]:dn,[56]:dn,[57]:dn,[62]:Tr},ku={[91]:Ss},Su={[-2]:ke,[-1]:ke,[32]:ke},Au=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:{null:[42,95]},contentInitial:ku,disable:{null:[]},document:Eu,flow:{[35]:Bs,[42]:qt,[45]:[qr,qt],[60]:$s,[61]:qr,[95]:qt,[96]:Pr,[126]:Pr},flowInitial:Su,insideSpan:{null:[Ee,gu]},string:{[38]:$r,[92]:Or},text:{[-5]:Ae,[-4]:Ae,[-3]:Ae,[33]:Qs,[38]:$r,[42]:Ee,[60]:[ns,Us],[91]:Js,[92]:[zs,Or],[93]:Se,[95]:Ee,[96]:ds}},Symbol.toStringTag,{value:"Module"}));function Cu(n){const e=$o([Au,...(n||{}).extensions||[]]),r={defined:[],lazy:{},constructs:e,content:i(Zo),document:i(Yo),flow:i(hu),string:i(pu),text:i(mu)};return r;function i(o){return s;function s(u){return wu(r,o,u)}}}function _u(n){for(;!Fr(n););return n}const jr=/[\0\t\n\r]/g;function zu(){let n=1,t="",e=!0,r;return i;function i(o,s,u){const c=[];let a,f,l,g,h;for(o=t+o.toString(s),l=0,t="",e&&(o.charCodeAt(0)===65279&&l++,e=void 0);l<o.length;){if(jr.lastIndex=l,a=jr.exec(o),g=a&&a.index!==void 0?a.index:o.length,h=o.charCodeAt(g),!a){t=o.slice(l);break}if(h===10&&l===g&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),l<g&&(c.push(o.slice(l,g)),n+=g-l),h){case 0:{c.push(65533),n++;break}case 9:{for(f=Math.ceil(n/4)*4,c.push(-2);n++<f;)c.push(-1);break}case 10:{c.push(-4),n=1;break}default:r=!0,n=1}l=g+1}return u&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}function vu(n,t,e){return typeof t!="string"&&(e=t,t=void 0),Wo(e)(_u(Cu(e).document().write(zu()(n,t,!0))))}const Bu={tokenize:Pu,partial:!0},Vr={tokenize:Fu,partial:!0},Wr={tokenize:Ru,partial:!0},Zr={tokenize:Nu,partial:!0},Iu={tokenize:Du,partial:!0},Kr={tokenize:$u,previous:Gr},Yr={tokenize:Lu,previous:Qr},Dn={tokenize:Ou,previous:Xr},Bn={},Tu={text:Bn};let rt=48;for(;rt<123;)Bn[rt]=Dn,rt++,rt===58?rt=65:rt===91&&(rt=97);Bn[43]=Dn,Bn[45]=Dn,Bn[46]=Dn,Bn[95]=Dn,Bn[72]=[Dn,Yr],Bn[104]=[Dn,Yr],Bn[87]=[Dn,Kr],Bn[119]=[Dn,Kr];function Ou(n,t,e){const r=this;let i,o;return s;function s(l){return!Ce(l)||!Xr.call(r,r.previous)||_e(r.events)?e(l):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),u(l))}function u(l){return Ce(l)?(n.consume(l),u):l===64?(n.consume(l),c):e(l)}function c(l){return l===46?n.check(Iu,f,a)(l):l===45||l===95||un(l)?(o=!0,n.consume(l),c):f(l)}function a(l){return n.consume(l),i=!0,c}function f(l){return o&&i&&cn(r.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),t(l)):e(l)}}function $u(n,t,e){const r=this;return i;function i(s){return s!==87&&s!==119||!Gr.call(r,r.previous)||_e(r.events)?e(s):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(Bu,n.attempt(Vr,n.attempt(Wr,o),e),e)(s))}function o(s){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),t(s)}}function Lu(n,t,e){const r=this;let i="",o=!1;return s;function s(l){return(l===72||l===104)&&Qr.call(r,r.previous)&&!_e(r.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),i+=String.fromCodePoint(l),n.consume(l),u):e(l)}function u(l){if(cn(l)&&i.length<5)return i+=String.fromCodePoint(l),n.consume(l),u;if(l===58){const g=i.toLowerCase();if(g==="http"||g==="https")return n.consume(l),c}return e(l)}function c(l){return l===47?(n.consume(l),o?a:(o=!0,c)):e(l)}function a(l){return l===null||Dt(l)||G(l)||ct(l)||xe(l)?e(l):n.attempt(Vr,n.attempt(Wr,f),e)(l)}function f(l){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),t(l)}}function Pu(n,t,e){let r=0;return i;function i(s){return(s===87||s===119)&&r<3?(r++,n.consume(s),i):s===46&&r===3?(n.consume(s),o):e(s)}function o(s){return s===null?e(s):t(s)}}function Fu(n,t,e){let r,i,o;return s;function s(a){return a===46||a===95?n.check(Zr,c,u)(a):a===null||G(a)||ct(a)||a!==45&&xe(a)?c(a):(o=!0,n.consume(a),s)}function u(a){return a===95?r=!0:(i=r,r=void 0),n.consume(a),s}function c(a){return i||r||!o?e(a):t(a)}}function Ru(n,t){let e=0,r=0;return i;function i(s){return s===40?(e++,n.consume(s),i):s===41&&r<e?o(s):s===33||s===34||s===38||s===39||s===41||s===42||s===44||s===46||s===58||s===59||s===60||s===63||s===93||s===95||s===126?n.check(Zr,t,o)(s):s===null||G(s)||ct(s)?t(s):(n.consume(s),i)}function o(s){return s===41&&r++,n.consume(s),i}}function Nu(n,t,e){return r;function r(u){return u===33||u===34||u===39||u===41||u===42||u===44||u===46||u===58||u===59||u===63||u===95||u===126?(n.consume(u),r):u===38?(n.consume(u),o):u===93?(n.consume(u),i):u===60||u===null||G(u)||ct(u)?t(u):e(u)}function i(u){return u===null||u===40||u===91||G(u)||ct(u)?t(u):r(u)}function o(u){return cn(u)?s(u):e(u)}function s(u){return u===59?(n.consume(u),r):cn(u)?(n.consume(u),s):e(u)}}function Du(n,t,e){return r;function r(o){return n.consume(o),i}function i(o){return un(o)?e(o):t(o)}}function Gr(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||G(n)}function Qr(n){return!cn(n)}function Xr(n){return!(n===47||Ce(n))}function Ce(n){return n===43||n===45||n===46||n===95||un(n)}function _e(n){let t=n.length,e=!1;for(;t--;){const r=n[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){e=!0;break}if(r._gfmAutolinkLiteralWalkedInto){e=!1;break}}return n.length>0&&!e&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),e}const Uu={exit:{literalAutolinkEmail:Hu,literalAutolinkHttp:Mu,literalAutolinkWww:qu}};function qu(n){ze.call(this,n,"http://")}function Hu(n){ze.call(this,n,"mailto:")}function Mu(n){ze.call(this,n)}function ze(n,t){const e=this.sliceSerialize(n);this.tag('<a href="'+kt((t||"")+e)+'">'),this.raw(this.encode(e)),this.tag("</a>")}const ve=Symbol("store-raw"),At=Symbol("store-node");function Jr(n){let t;return n!=null&&typeof n=="object"&&(n[en]||!(t=Object.getPrototypeOf(n))||t===Object.prototype||Array.isArray(n))}function Ht(n,t=new Set){let e,r,i,o;if(e=n!=null&&n[ve])return e;if(!Jr(n)||t.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):t.add(n);for(let s=0,u=n.length;s<u;s++)i=n[s],(r=Ht(i,t))!==i&&(n[s]=r)}else{Object.isFrozen(n)?n=Object.assign({},n):t.add(n);const s=Object.keys(n),u=Object.getOwnPropertyDescriptors(n);for(let c=0,a=s.length;c<a;c++)o=s[c],!u[o].get&&(i=n[o],(r=Ht(i,t))!==i&&(n[o]=r))}return n}function Be(n){let t=n[At];return t||Object.defineProperty(n,At,{value:t=Object.create(null)}),t}function Ie(n,t,e){return n[t]||(n[t]=ti(e))}function ni(n){if(fe()){const t=Be(n);(t._||(t._=ti()))()}}function ju(n){return ni(n),Reflect.ownKeys(n)}function ti(n){const[t,e]=Cn(n,{equals:!1,internal:!0});return t.$=e,t}function ei(n,t,e,r=!1){if(!r&&n[t]===e)return;const i=n[t],o=n.length;e===void 0?delete n[t]:n[t]=e;let s=Be(n),u;if((u=Ie(s,t,i))&&u.$(()=>e),Array.isArray(n)&&n.length!==o){for(let c=n.length;c<o;c++)(u=s[c])&&u.$();(u=Ie(s,"length",o))&&u.$(n.length)}(u=s._)&&u.$()}function Vu(n,t){const e=Reflect.getOwnPropertyDescriptor(n,t);return!e||e.get||e.set||!e.configurable||t===en||t===At||(delete e.value,delete e.writable,e.get=()=>n[en][t],e.set=r=>n[en][t]=r),e}const Wu={get(n,t,e){if(t===ve)return n;if(t===en)return e;if(t===Fn)return ni(n),e;const r=Be(n),i=r[t];let o=i?i():n[t];if(t===At||t==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(n,t),u=typeof o=="function";if(fe()&&(!u||n.hasOwnProperty(t))&&!(s&&s.get))o=Ie(r,t,o)();else if(o!=null&&u&&o===Array.prototype[t])return(...c)=>Lt(()=>Array.prototype[t].apply(e,c))}return Jr(o)?ri(o):o},has(n,t){return t===ve||t===en||t===Fn||t===At||t==="__proto__"?!0:(this.get(n,t,n),t in n)},set(n,t,e){return Lt(()=>ei(n,t,Ht(e))),!0},deleteProperty(n,t){return Lt(()=>ei(n,t,void 0,!0)),!0},ownKeys:ju,getOwnPropertyDescriptor:Vu};function ri(n){let t=n[en];if(!t){Object.defineProperty(n,en,{value:t=new Proxy(n,Wu)});const e=Object.keys(n),r=Object.getOwnPropertyDescriptors(n);for(let i=0,o=e.length;i<o;i++){const s=e[i];if(r[s].get){const u=r[s].get.bind(t);Object.defineProperty(n,s,{get:u})}if(r[s].set){const u=r[s].set;Object.defineProperty(n,s,{set:a=>Lt(()=>u.call(t,a))})}}}return t}function Te(n,t){const e=Ht(n||{});return ri(e)}const ln=Te({}),it=Te({}),In=Te({}),ii=oo(),Oe=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $e=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Tn=(n,t)=>n<<32-t|n>>>t;if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");const Zu=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function On(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let e=0;e<n.length;e++)t+=Zu[n[e]];return t}function oi(n){if(typeof n!="string")throw new TypeError("hexToBytes: expected string, got "+typeof n);if(n.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(n.length/2);for(let e=0;e<t.length;e++){const r=e*2,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[e]=o}return t}function Ku(n){if(typeof n!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof n}`);return new TextEncoder().encode(n)}function Le(n){if(typeof n=="string"&&(n=Ku(n)),!(n instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof n})`);return n}function si(...n){if(!n.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(n.length===1)return n[0];const t=n.reduce((r,i)=>r+i.length,0),e=new Uint8Array(t);for(let r=0,i=0;r<n.length;r++){const o=n[r];e.set(o,i),i+=o.length}return e}class ui{clone(){return this._cloneInto()}}function li(n){const t=r=>n().update(Le(r)).digest(),e=n();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>n(),t}function ai(n=32){if(Oe&&typeof Oe.getRandomValues=="function")return Oe.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ft(n){if(!Number.isSafeInteger(n))throw new Error(`Wrong integer: ${n}`)}function Un(...n){const t=(i,o)=>s=>i(o(s)),e=Array.from(n).reverse().reduce((i,o)=>i?t(i,o.encode):o.encode,void 0),r=n.reduce((i,o)=>i?t(i,o.decode):o.decode,void 0);return{encode:e,decode:r}}function qn(n){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(e=>{if(ft(e),e<0||e>=n.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${n.length})`);return n[e]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(e=>{if(typeof e!="string")throw new Error(`alphabet.decode: not string element=${e}`);const r=n.indexOf(e);if(r===-1)throw new Error(`Unknown letter: "${e}". Allowed: ${n}`);return r})}}}function Hn(n=""){if(typeof n!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let e of t)if(typeof e!="string")throw new Error(`join.encode: non-string input=${e}`);return t.join(n)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(n)}}}function Mt(n,t="="){if(ft(n),typeof t!="string")throw new Error("padding chr should be string");return{encode(e){if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of e)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;e.length*n%8;)e.push(t);return e},decode(e){if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("padding.encode input should be array of strings");for(let i of e)if(typeof i!="string")throw new Error(`padding.decode: non-string input=${i}`);let r=e.length;if(r*n%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&e[r-1]===t;r--)if(!((r-1)*n%8))throw new Error("Invalid padding: string has too much padding");return e.slice(0,r)}}}function ci(n){if(typeof n!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>n(t)}}function fi(n,t,e){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(e<2)throw new Error(`convertRadix: wrong to=${e}, base cannot be less than 2`);if(!Array.isArray(n))throw new Error("convertRadix: data should be array");if(!n.length)return[];let r=0;const i=[],o=Array.from(n);for(o.forEach(s=>{if(ft(s),s<0||s>=t)throw new Error(`Wrong integer: ${s}`)});;){let s=0,u=!0;for(let c=r;c<o.length;c++){const a=o[c],f=t*s+a;if(!Number.isSafeInteger(f)||t*s/t!==s||f-a!==t*s)throw new Error("convertRadix: carry overflow");if(s=f%e,o[c]=Math.floor(f/e),!Number.isSafeInteger(o[c])||o[c]*e+s!==f)throw new Error("convertRadix: carry overflow");if(u)o[c]?u=!1:r=c;else continue}if(i.push(s),u)break}for(let s=0;s<n.length-1&&n[s]===0;s++)i.push(0);return i.reverse()}const hi=(n,t)=>t?hi(t,n%t):n,jt=(n,t)=>n+(t-hi(n,t));function Pe(n,t,e,r){if(!Array.isArray(n))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(e<=0||e>32)throw new Error(`convertRadix2: wrong to=${e}`);if(jt(t,e)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${e} carryBits=${jt(t,e)}`);let i=0,o=0;const s=2**e-1,u=[];for(const c of n){if(ft(c),c>=2**t)throw new Error(`convertRadix2: invalid data word=${c} from=${t}`);if(i=i<<t|c,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=e;o-=e)u.push((i>>o-e&s)>>>0);i&=2**o-1}if(i=i<<e-o&s,!r&&o>=t)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&u.push(i>>>0),u}function Yu(n){return ft(n),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return fi(Array.from(t),256,n)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(fi(t,n,256))}}}function Yn(n,t=!1){if(ft(n),n<=0||n>32)throw new Error("radix2: bits should be in (0..32]");if(jt(8,n)>32||jt(n,8)>32)throw new Error("radix2: carry overflow");return{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Pe(Array.from(e),8,n,!t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Pe(e,n,8,t))}}}function di(n){if(typeof n!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return n.apply(null,t)}catch{}}}const Gu=Un(Yn(4),qn("0123456789ABCDEF"),Hn("")),Qu=Un(Yn(5),qn("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Mt(5),Hn(""));Un(Yn(5),qn("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Mt(5),Hn("")),Un(Yn(5),qn("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Hn(""),ci(n=>n.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const Xu=Un(Yn(6),qn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Mt(6),Hn("")),Ju=Un(Yn(6),qn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Mt(6),Hn("")),Fe=n=>Un(Yu(58),qn(n),Hn("")),Re=Fe("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Fe("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Fe("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const gi=[0,2,3,5,6,7,9,10,11],nl={encode(n){let t="";for(let e=0;e<n.length;e+=8){const r=n.subarray(e,e+8);t+=Re.encode(r).padStart(gi[r.length],"1")}return t},decode(n){let t=[];for(let e=0;e<n.length;e+=11){const r=n.slice(e,e+11),i=gi.indexOf(r.length),o=Re.decode(r);for(let s=0;s<o.length-i;s++)if(o[s]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-i)))}return Uint8Array.from(t)}},Ne=Un(qn("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Hn("")),pi=[996825010,642813549,513874426,1027748829,705979059];function Ct(n){const t=n>>25;let e=(n&33554431)<<5;for(let r=0;r<pi.length;r++)(t>>r&1)===1&&(e^=pi[r]);return e}function mi(n,t,e=1){const r=n.length;let i=1;for(let o=0;o<r;o++){const s=n.charCodeAt(o);if(s<33||s>126)throw new Error(`Invalid prefix (${n})`);i=Ct(i)^s>>5}i=Ct(i);for(let o=0;o<r;o++)i=Ct(i)^n.charCodeAt(o)&31;for(let o of t)i=Ct(i)^o;for(let o=0;o<6;o++)i=Ct(i);return i^=e,Ne.encode(Pe([i%1073741824],30,5,!1))}function bi(n){const t=n==="bech32"?1:734539939,e=Yn(5),r=e.decode,i=e.encode,o=di(r);function s(f,l,g=90){if(typeof f!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof f}`);if(!Array.isArray(l)||l.length&&typeof l[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof l}`);const h=f.length+7+l.length;if(g!==!1&&h>g)throw new TypeError(`Length ${h} exceeds limit ${g}`);return f=f.toLowerCase(),`${f}1${Ne.encode(l)}${mi(f,l,t)}`}function u(f,l=90){if(typeof f!="string")throw new Error(`bech32.decode input should be string, not ${typeof f}`);if(f.length<8||l!==!1&&f.length>l)throw new TypeError(`Wrong string length: ${f.length} (${f}). Expected (8..${l})`);const g=f.toLowerCase();if(f!==g&&f!==f.toUpperCase())throw new Error("String must be lowercase or uppercase");f=g;const h=f.lastIndexOf("1");if(h===0||h===-1)throw new Error('Letter "1" must be present between prefix and data only');const x=f.slice(0,h),w=f.slice(h+1);if(w.length<6)throw new Error("Data must be at least 6 characters long");const k=Ne.decode(w).slice(0,-6),d=mi(x,k,t);if(!w.endsWith(d))throw new Error(`Invalid checksum in ${f}: expected "${d}"`);return{prefix:x,words:k}}const c=di(u);function a(f){const{prefix:l,words:g}=u(f,!1);return{prefix:l,words:g,bytes:r(g)}}return{encode:s,decode:u,decodeToBytes:a,decodeUnsafe:c,fromWords:r,fromWordsUnsafe:o,toWords:i}}const ht=bi("bech32");bi("bech32m");const tl={encode:n=>new TextDecoder().decode(n),decode:n=>new TextEncoder().encode(n)},el=Un(Yn(4),qn("0123456789abcdef"),Hn(""),ci(n=>{if(typeof n!="string"||n.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof n} with length ${n.length}`);return n.toLowerCase()}));`${Object.keys({utf8:tl,hex:el,base16:Gu,base32:Qu,base64:Xu,base64url:Ju,base58:Re,base58xmr:nl}).join(", ")}`;const _t=new TextDecoder("utf-8"),De=new TextEncoder;function wi(n){let t=new URL(n);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}class rl{constructor(t){Pn(this,"_value");Pn(this,"_next");this._value=t,this._next=null}get value(){return this._value}set value(t){this._value=t}get next(){return this._next}set next(t){this._next=t}}class il{constructor(){Pn(this,"_first");Pn(this,"_last");Pn(this,"_size");this._first=null,this._last=null,this._size=0}get first(){return this._first}set first(t){this._first=t}get last(){return this._last}set last(t){this._last=t}get size(){return this._size}set size(t){this._size=t}enqueue(t){const e=new rl(t);return this._size===0||!this._last?(this._first=e,this._last=e):(this._last.next=e,this._last=e),this._size++,!0}dequeue(){if(this._size===0||!this._first)return null;let t=this._first;return this._first=t.next,t.next=null,this._size--,t.value}}const Ue=5e3,ol=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function qe(n){var i,o,s,u,c,a,f;let{prefix:t,words:e}=ht.decode(n,Ue),r=new Uint8Array(ht.fromWords(e));switch(t){case"nprofile":{let l=Vt(r);if(!((i=l[0])!=null&&i[0]))throw new Error("missing TLV 0 for nprofile");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:On(l[0][0]),relays:l[1]?l[1].map(g=>_t.decode(g)):[]}}}case"nevent":{let l=Vt(r);if(!((o=l[0])!=null&&o[0]))throw new Error("missing TLV 0 for nevent");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(l[2]&&l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");return{type:"nevent",data:{id:On(l[0][0]),relays:l[1]?l[1].map(g=>_t.decode(g)):[],author:(s=l[2])!=null&&s[0]?On(l[2][0]):void 0}}}case"naddr":{let l=Vt(r);if(!((u=l[0])!=null&&u[0]))throw new Error("missing TLV 0 for naddr");if(!((c=l[2])!=null&&c[0]))throw new Error("missing TLV 2 for naddr");if(l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((a=l[3])!=null&&a[0]))throw new Error("missing TLV 3 for naddr");if(l[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:_t.decode(l[0][0]),pubkey:On(l[2][0]),kind:parseInt(On(l[3][0]),16),relays:l[1]?l[1].map(g=>_t.decode(g)):[]}}}case"nrelay":{let l=Vt(r);if(!((f=l[0])!=null&&f[0]))throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:_t.decode(l[0][0])}}case"nsec":case"npub":case"note":return{type:t,data:On(r)};default:throw new Error(`unknown prefix ${t}`)}}function Vt(n){let t={},e=n;for(;e.length>0;){let r=e[0],i=e[1],o=e.slice(2,2+i);e=e.slice(2+i),!(o.length<i)&&(t[r]=t[r]||[],t[r].push(o))}return t}function Wt(n){return xi("npub",n)}function sl(n){return xi("note",n)}function xi(n,t){let e=oi(t),r=ht.toWords(e);return ht.encode(n,r,Ue)}function ul(n){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,n.kind,!1);let e=ll({0:[De.encode(n.identifier)],1:(n.relays||[]).map(i=>De.encode(i)),2:[oi(n.pubkey)],3:[new Uint8Array(t)]}),r=ht.toWords(e);return ht.encode("naddr",r,Ue)}function ll(n){let t=[];return Object.entries(n).forEach(([e,r])=>{r.forEach(i=>{let o=new Uint8Array(i.length+2);o.set([parseInt(e)],0),o.set([i.length],1),o.set(i,2),t.push(o)})}),si(...t)}const al=new RegExp(`nostr:(${ol.source})`),cl=()=>new RegExp(`\\b${al.source}\\b`,"g");function fl(n,t){return n.replaceAll(cl(),(e,r)=>t({uri:e,value:r,decoded:qe(r)}))}const yi=n=>{n.forEach(t=>{const e=JSON.parse(t.content);ln[t.pubkey].timestamp<t.created_at&&(ln[t.pubkey]={...ln[t.pubkey],timestamp:t.created_at,imgUrl:e.image||e.picture,name:e.displayName||e.display_name||e.name})})},hl=n=>{const t=qe(n);switch(t.type){case"nevent":return{"#e":[t.data.id]};case"note":return{"#e":[t.data]};case"naddr":return{"#a":[`${t.data.kind}:${t.data.pubkey}:${t.data.identifier}`]};default:return{}}},dl=n=>n["#e"]?["e",n["#e"][0],"","root"]:["a",n["#a"][0],"","root"],gl=n=>{let t=n.content;return t=t.replace(/\#\[([0-9])\]/g,(e,r)=>{var i;switch(n.tags[r][0]){case"e":return"nostr:"+sl(n.tags[r][1]);case"a":const[o,s,u]=n.tags[r][1].split(":");return"nostr:"+ul({identifier:u,pubkey:s,kind:parseInt(o)});case"p":const c=n.tags[r][1],a=Wt(c);return`[@${((i=ln[c])==null?void 0:i.name)||Zt(a)}](https://nostr.com/${a})`;default:return e}}),t=fl(t,({decoded:e,value:r})=>`[@${Zt(r)}](https://nostr.com/${r})`),vu(t,{extensions:[Tu],htmlExtensions:[Uu]})},Zt=n=>n.substring(0,8)+"..."+n.substring(n.length-4),kn=20,Kt=()=>Math.floor(Math.random()*42),Yt='data:image/svg+xml;utf-8,<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><circle cx="512" cy="512" r="512" fill="%23333" fill-rule="evenodd" /></svg>',pl=n=>{const t=new Date,e=Math.floor((t.getTime()-n)/1e3);if(e<60)return"now";if(e<3600){const r=Math.floor(e/60);return`${r} minute${r===1?"":"s"} ago`}if(e<=86400){const r=Math.floor(e/3600);return`${r} hour${r===1?"":"s"} ago`}if(e>86400){const r=new Date(n),i=r.toLocaleDateString("en-us",{day:"numeric",month:"long"}),o=r.getFullYear()===t.getFullYear()?"":" "+r.getFullYear();return i+o}return""},He=n=>n.children.reduce((t,e)=>t+He(e),n.children.length);function ml(n){const t={reply:void 0,root:void 0,mentions:[],profiles:[]},e=[];for(const r of n.tags)r[0]==="e"&&r[1]&&e.push(r),r[0]==="p"&&r[1]&&t.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let r=0;r<e.length;r++){const i=e[r],[o,s,u,c]=i,a={id:s,relays:u?[u]:[]},f=r===0,l=r===e.length-1;if(c==="root"){t.root=a;continue}if(c==="reply"){t.reply=a;continue}if(c==="mention"){t.mentions.push(a);continue}if(f&&!n.tags.some(g=>g[0]==="a")){t.root=a;continue}if(l){t.reply=a;continue}t.mentions.push(a)}return t}function bl(n,t){const e=n.map(r=>{var c,a,f;let i,o;const s=ml(r),u=r.tags.find(l=>l[0]==="a");return t&&u?(i=t.find(l=>l===u[1]),o=(c=n.find(l=>{var g,h;return l.id===((g=s.reply)==null?void 0:g.id)||l.id===((h=s.root)==null?void 0:h.id)}))==null?void 0:c.id):(i=(a=n.find(l=>{var g;return l.id===((g=s.root)==null?void 0:g.id)}))==null?void 0:a.id,o=(f=n.find(l=>{var g;return l.id===((g=s.reply)==null?void 0:g.id)}))==null?void 0:f.id),{...r,rootId:i,replyId:o,children:[]}}).filter(r=>t?r.rootId:!0);return Ei(e,t)}function Ei(n,t){const e=new Set(n.filter(r=>t?t.includes(r.replyId||r.rootId):(r.replyId||r.rootId)===void 0));n=n.filter(r=>!e.has(r));for(let r of e)r.children.push(...Ei(n,[r.id]));return[...e]}function Me(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function wl(n){if(typeof n!="boolean")throw new Error(`Expected boolean, not ${n}`)}function ki(n,...t){if(!(n instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(n.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${n.length}`)}function xl(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Me(n.outputLen),Me(n.blockLen)}function yl(n,t=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(t&&n.finished)throw new Error("Hash#digest() has already been called")}function El(n,t){ki(n);const e=t.outputLen;if(n.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}const ot={number:Me,bool:wl,bytes:ki,hash:xl,exists:yl,output:El};function kl(n,t,e,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(t,e,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(e>>i&o),u=Number(e&o),c=r?4:0,a=r?0:4;n.setUint32(t+c,s,r),n.setUint32(t+a,u,r)}class Sl extends ui{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=$e(this.buffer)}update(t){ot.exists(this);const{view:e,buffer:r,blockLen:i}=this;t=Le(t);const o=t.length;for(let s=0;s<o;){const u=Math.min(i-this.pos,o-s);if(u===i){const c=$e(t);for(;i<=o-s;s+=i)this.process(c,s);continue}r.set(t.subarray(s,s+u),this.pos),this.pos+=u,s+=u,this.pos===i&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ot.exists(this),ot.output(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:i,isLE:o}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let l=s;l<i;l++)e[l]=0;kl(r,i-8,BigInt(this.length*8),o),this.process(r,0);const u=$e(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=c/4,f=this.get();if(a>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<a;l++)u.setUint32(4*l,f[l],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:i,finished:o,destroyed:s,pos:u}=this;return t.length=i,t.pos=u,t.finished=o,t.destroyed=s,i%e&&t.buffer.set(r),t}}const Al=(n,t,e)=>n&t^~n&e,Cl=(n,t,e)=>n&t^n&e^t&e,_l=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Gn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qn=new Uint32Array(64);class Si extends Sl{constructor(){super(64,32,8,!1),this.A=Gn[0]|0,this.B=Gn[1]|0,this.C=Gn[2]|0,this.D=Gn[3]|0,this.E=Gn[4]|0,this.F=Gn[5]|0,this.G=Gn[6]|0,this.H=Gn[7]|0}get(){const{A:t,B:e,C:r,D:i,E:o,F:s,G:u,H:c}=this;return[t,e,r,i,o,s,u,c]}set(t,e,r,i,o,s,u,c){this.A=t|0,this.B=e|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=u|0,this.H=c|0}process(t,e){for(let l=0;l<16;l++,e+=4)Qn[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){const g=Qn[l-15],h=Qn[l-2],x=Tn(g,7)^Tn(g,18)^g>>>3,w=Tn(h,17)^Tn(h,19)^h>>>10;Qn[l]=w+Qn[l-7]+x+Qn[l-16]|0}let{A:r,B:i,C:o,D:s,E:u,F:c,G:a,H:f}=this;for(let l=0;l<64;l++){const g=Tn(u,6)^Tn(u,11)^Tn(u,25),h=f+g+Al(u,c,a)+_l[l]+Qn[l]|0,w=(Tn(r,2)^Tn(r,13)^Tn(r,22))+Cl(r,i,o)|0;f=a,a=c,c=u,u=s+h|0,s=o,o=i,i=r,r=h+w|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,u=u+this.E|0,c=c+this.F|0,a=a+this.G|0,f=f+this.H|0,this.set(r,i,o,s,u,c,a,f)}roundClean(){Qn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class zl extends Si{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const zt=li(()=>new Si);li(()=>new zl);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ai=BigInt(0),Gt=BigInt(1),vl=BigInt(2),Qt=n=>n instanceof Uint8Array,Bl=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function dt(n){if(!Qt(n))throw new Error("Uint8Array expected");let t="";for(let e=0;e<n.length;e++)t+=Bl[n[e]];return t}function Ci(n){const t=n.toString(16);return t.length&1?`0${t}`:t}function je(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function gt(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(n.length%2)throw new Error("hex string is invalid: unpadded "+n.length);const t=new Uint8Array(n.length/2);for(let e=0;e<t.length;e++){const r=e*2,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("invalid byte sequence");t[e]=o}return t}function fn(n){return je(dt(n))}function Ve(n){if(!Qt(n))throw new Error("Uint8Array expected");return je(dt(Uint8Array.from(n).reverse()))}const Xn=(n,t)=>gt(n.toString(16).padStart(t*2,"0")),_i=(n,t)=>Xn(n,t).reverse(),Il=n=>gt(Ci(n));function tn(n,t,e){let r;if(typeof t=="string")try{r=gt(t)}catch(o){throw new Error(`${n} must be valid hex string, got "${t}". Cause: ${o}`)}else if(Qt(t))r=Uint8Array.from(t);else throw new Error(`${n} must be hex string or Uint8Array`);const i=r.length;if(typeof e=="number"&&i!==e)throw new Error(`${n} expected ${e} bytes, got ${i}`);return r}function wn(...n){const t=new Uint8Array(n.reduce((r,i)=>r+i.length,0));let e=0;return n.forEach(r=>{if(!Qt(r))throw new Error("Uint8Array expected");t.set(r,e),e+=r.length}),t}function Tl(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Xt(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new TextEncoder().encode(n)}function Ol(n){let t;for(t=0;n>Ai;n>>=Gt,t+=1);return t}const $l=(n,t)=>n>>BigInt(t)&Gt,Ll=(n,t,e)=>n|(e?Gt:Ai)<<BigInt(t),We=n=>(vl<<BigInt(n-1))-Gt,Ze=n=>new Uint8Array(n),zi=n=>Uint8Array.from(n);function vi(n,t,e){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let r=Ze(n),i=Ze(n),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},u=(...l)=>e(i,r,...l),c=(l=Ze())=>{i=u(zi([0]),l),r=u(),l.length!==0&&(i=u(zi([1]),l),r=u())},a=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const g=[];for(;l<t;){r=u();const h=r.slice();g.push(h),l+=r.length}return wn(...g)};return(l,g)=>{s(),c(l);let h;for(;!(h=g(a()));)c();return s(),h}}const Pl={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,t)=>t.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function pt(n,t,e={}){const r=(i,o,s)=>{const u=Pl[o];if(typeof u!="function")throw new Error(`Invalid validator "${o}", expected function`);const c=n[i];if(!(s&&c===void 0)&&!u(c,n))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(e))r(i,o,!0);return n}const Fl=Object.freeze(Object.defineProperty({__proto__:null,bitGet:$l,bitLen:Ol,bitMask:We,bitSet:Ll,bytesToHex:dt,bytesToNumberBE:fn,bytesToNumberLE:Ve,concatBytes:wn,createHmacDrbg:vi,ensureBytes:tn,equalBytes:Tl,hexToBytes:gt,hexToNumber:je,numberToBytesBE:Xn,numberToBytesLE:_i,numberToHexUnpadded:Ci,numberToVarBytesBE:Il,utf8ToBytes:Xt,validateObject:pt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const J=BigInt(0),K=BigInt(1),st=BigInt(2),Rl=BigInt(3),Ke=BigInt(4),Bi=BigInt(5),Ii=BigInt(8);BigInt(9),BigInt(16);function nn(n,t){const e=n%t;return e>=J?e:t+e}function Nl(n,t,e){if(e<=J||t<J)throw new Error("Expected power/modulo > 0");if(e===K)return J;let r=K;for(;t>J;)t&K&&(r=r*n%e),n=n*n%e,t>>=K;return r}function Sn(n,t,e){let r=n;for(;t-- >J;)r*=r,r%=e;return r}function Ye(n,t){if(n===J||t<=J)throw new Error(`invert: expected positive integers, got n=${n} mod=${t}`);let e=nn(n,t),r=t,i=J,o=K;for(;e!==J;){const u=r/e,c=r%e,a=i-o*u;r=e,e=c,i=o,o=a}if(r!==K)throw new Error("invert: does not exist");return nn(i,t)}function Dl(n){const t=(n-K)/st;let e,r,i;for(e=n-K,r=0;e%st===J;e/=st,r++);for(i=st;i<n&&Nl(i,t,n)!==n-K;i++);if(r===1){const s=(n+K)/Ke;return function(c,a){const f=c.pow(a,s);if(!c.eql(c.sqr(f),a))throw new Error("Cannot find square root");return f}}const o=(e+K)/st;return function(u,c){if(u.pow(c,t)===u.neg(u.ONE))throw new Error("Cannot find square root");let a=r,f=u.pow(u.mul(u.ONE,i),e),l=u.pow(c,o),g=u.pow(c,e);for(;!u.eql(g,u.ONE);){if(u.eql(g,u.ZERO))return u.ZERO;let h=1;for(let w=u.sqr(g);h<a&&!u.eql(w,u.ONE);h++)w=u.sqr(w);const x=u.pow(f,K<<BigInt(a-h-1));f=u.sqr(x),l=u.mul(l,x),g=u.mul(g,f),a=h}return l}}function Ul(n){if(n%Ke===Rl){const t=(n+K)/Ke;return function(r,i){const o=r.pow(i,t);if(!r.eql(r.sqr(o),i))throw new Error("Cannot find square root");return o}}if(n%Ii===Bi){const t=(n-Bi)/Ii;return function(r,i){const o=r.mul(i,st),s=r.pow(o,t),u=r.mul(i,s),c=r.mul(r.mul(u,st),s),a=r.mul(u,r.sub(c,r.ONE));if(!r.eql(r.sqr(a),i))throw new Error("Cannot find square root");return a}}return Dl(n)}const ql=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ti(n){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=ql.reduce((r,i)=>(r[i]="function",r),t);return pt(n,e)}function Hl(n,t,e){if(e<J)throw new Error("Expected power > 0");if(e===J)return n.ONE;if(e===K)return t;let r=n.ONE,i=t;for(;e>J;)e&K&&(r=n.mul(r,i)),i=n.sqr(i),e>>=K;return r}function Ml(n,t){const e=new Array(t.length),r=t.reduce((o,s,u)=>n.is0(s)?o:(e[u]=o,n.mul(o,s)),n.ONE),i=n.inv(r);return t.reduceRight((o,s,u)=>n.is0(s)?o:(e[u]=n.mul(o,e[u]),n.mul(o,s)),i),e}function Ge(n,t){const e=t!==void 0?t:n.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function jl(n,t,e=!1,r={}){if(n<=J)throw new Error(`Expected Fp ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:o}=Ge(n,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Ul(n),u=Object.freeze({ORDER:n,BITS:i,BYTES:o,MASK:We(i),ZERO:J,ONE:K,create:c=>nn(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return J<=c&&c<n},is0:c=>c===J,isOdd:c=>(c&K)===K,neg:c=>nn(-c,n),eql:(c,a)=>c===a,sqr:c=>nn(c*c,n),add:(c,a)=>nn(c+a,n),sub:(c,a)=>nn(c-a,n),mul:(c,a)=>nn(c*a,n),pow:(c,a)=>Hl(u,c,a),div:(c,a)=>nn(c*Ye(a,n),n),sqrN:c=>c*c,addN:(c,a)=>c+a,subN:(c,a)=>c-a,mulN:(c,a)=>c*a,inv:c=>Ye(c,n),sqrt:r.sqrt||(c=>s(u,c)),invertBatch:c=>Ml(u,c),cmov:(c,a,f)=>f?a:c,toBytes:c=>e?_i(c,o):Xn(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return e?Ve(c):fn(c)}});return Object.freeze(u)}function Vl(n,t,e=!1){n=tn("privateHash",n);const r=n.length,i=Ge(t).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);const o=e?Ve(n):fn(n);return nn(o,t-K)+K}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wl=BigInt(0),Qe=BigInt(1);function Zl(n,t){const e=(i,o)=>{const s=o.negate();return i?s:o},r=i=>{const o=Math.ceil(t/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:e,unsafeLadder(i,o){let s=n.ZERO,u=i;for(;o>Wl;)o&Qe&&(s=s.add(u)),u=u.double(),o>>=Qe;return s},precomputeWindow(i,o){const{windows:s,windowSize:u}=r(o),c=[];let a=i,f=a;for(let l=0;l<s;l++){f=a,c.push(f);for(let g=1;g<u;g++)f=f.add(a),c.push(f);a=f.double()}return c},wNAF(i,o,s){const{windows:u,windowSize:c}=r(i);let a=n.ZERO,f=n.BASE;const l=BigInt(2**i-1),g=2**i,h=BigInt(i);for(let x=0;x<u;x++){const w=x*c;let k=Number(s&l);s>>=h,k>c&&(k-=g,s+=Qe);const d=w,y=w+Math.abs(k)-1,E=x%2!==0,_=k<0;k===0?f=f.add(e(E,o[d])):a=a.add(e(_,o[y]))}return{p:a,f}},wNAFCached(i,o,s,u){const c=i._WINDOW_SIZE||1;let a=o.get(i);return a||(a=this.precomputeWindow(i,c),c!==1&&o.set(i,u(a))),this.wNAF(c,a,s)}}}function Oi(n){return Ti(n.Fp),pt(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ge(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Kl(n){const t=Oi(n);pt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:i}=t;if(e){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:Yl,hexToBytes:Gl}=Fl,ut={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(n){const{Err:t}=ut;if(n.length<2||n[0]!==2)throw new t("Invalid signature integer tag");const e=n[1],r=n.subarray(2,e+2);if(!e||r.length!==e)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Yl(r),l:n.subarray(e+2)}},toSig(n){const{Err:t}=ut,e=typeof n=="string"?Gl(n):n;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let r=e.length;if(r<2||e[0]!=48)throw new t("Invalid signature tag");if(e[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:i,l:o}=ut._parseInt(e.subarray(2)),{d:s,l:u}=ut._parseInt(o);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(n){const t=a=>Number.parseInt(a[0],16)&8?"00"+a:a,e=a=>{const f=a.toString(16);return f.length&1?`0${f}`:f},r=t(e(n.s)),i=t(e(n.r)),o=r.length/2,s=i.length/2,u=e(o),c=e(s);return`30${e(s+o+4)}02${c}${i}02${u}${r}`}},_n=BigInt(0),Q=BigInt(1),Mn=BigInt(2),Jt=BigInt(3),$i=BigInt(4);function Ql(n){const t=Kl(n),{Fp:e}=t,r=t.toBytes||((x,w,k)=>{const d=w.toAffine();return wn(Uint8Array.from([4]),e.toBytes(d.x),e.toBytes(d.y))}),i=t.fromBytes||(x=>{const w=x.subarray(1),k=e.fromBytes(w.subarray(0,e.BYTES)),d=e.fromBytes(w.subarray(e.BYTES,2*e.BYTES));return{x:k,y:d}});function o(x){const{a:w,b:k}=t,d=e.sqr(x),y=e.mul(d,x);return e.add(e.add(y,e.mul(x,w)),k)}if(!e.eql(e.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function s(x){return typeof x=="bigint"&&_n<x&&x<t.n}function u(x){if(!s(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(x){const{allowedPrivateKeyLengths:w,nByteLength:k,wrapPrivateKey:d,n:y}=t;if(w&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=dt(x)),typeof x!="string"||!w.includes(x.length))throw new Error("Invalid key");x=x.padStart(k*2,"0")}let E;try{E=typeof x=="bigint"?x:fn(tn("private key",x,k))}catch{throw new Error(`private key must be ${k} bytes, hex or bigint, not ${typeof x}`)}return d&&(E=nn(E,y)),u(E),E}const a=new Map;function f(x){if(!(x instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(w,k,d){if(this.px=w,this.py=k,this.pz=d,w==null||!e.isValid(w))throw new Error("x required");if(k==null||!e.isValid(k))throw new Error("y required");if(d==null||!e.isValid(d))throw new Error("z required")}static fromAffine(w){const{x:k,y:d}=w||{};if(!w||!e.isValid(k)||!e.isValid(d))throw new Error("invalid affine point");if(w instanceof l)throw new Error("projective point not allowed");const y=E=>e.eql(E,e.ZERO);return y(k)&&y(d)?l.ZERO:new l(k,d,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const k=e.invertBatch(w.map(d=>d.pz));return w.map((d,y)=>d.toAffine(k[y])).map(l.fromAffine)}static fromHex(w){const k=l.fromAffine(i(tn("pointHex",w)));return k.assertValidity(),k}static fromPrivateKey(w){return l.BASE.multiply(c(w))}_setWindowSize(w){this._WINDOW_SIZE=w,a.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:w,y:k}=this.toAffine();if(!e.isValid(w)||!e.isValid(k))throw new Error("bad point: x or y not FE");const d=e.sqr(k),y=o(w);if(!e.eql(d,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:w}=this.toAffine();if(e.isOdd)return!e.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){f(w);const{px:k,py:d,pz:y}=this,{px:E,py:_,pz:C}=w,m=e.eql(e.mul(k,C),e.mul(E,y)),A=e.eql(e.mul(d,C),e.mul(_,y));return m&&A}negate(){return new l(this.px,e.neg(this.py),this.pz)}double(){const{a:w,b:k}=t,d=e.mul(k,Jt),{px:y,py:E,pz:_}=this;let C=e.ZERO,m=e.ZERO,A=e.ZERO,I=e.mul(y,y),N=e.mul(E,E),L=e.mul(_,_),z=e.mul(y,E);return z=e.add(z,z),A=e.mul(y,_),A=e.add(A,A),C=e.mul(w,A),m=e.mul(d,L),m=e.add(C,m),C=e.sub(N,m),m=e.add(N,m),m=e.mul(C,m),C=e.mul(z,C),A=e.mul(d,A),L=e.mul(w,L),z=e.sub(I,L),z=e.mul(w,z),z=e.add(z,A),A=e.add(I,I),I=e.add(A,I),I=e.add(I,L),I=e.mul(I,z),m=e.add(m,I),L=e.mul(E,_),L=e.add(L,L),I=e.mul(L,z),C=e.sub(C,I),A=e.mul(L,N),A=e.add(A,A),A=e.add(A,A),new l(C,m,A)}add(w){f(w);const{px:k,py:d,pz:y}=this,{px:E,py:_,pz:C}=w;let m=e.ZERO,A=e.ZERO,I=e.ZERO;const N=t.a,L=e.mul(t.b,Jt);let z=e.mul(k,E),T=e.mul(d,_),F=e.mul(y,C),q=e.add(k,d),S=e.add(E,_);q=e.mul(q,S),S=e.add(z,T),q=e.sub(q,S),S=e.add(k,y);let v=e.add(E,C);return S=e.mul(S,v),v=e.add(z,F),S=e.sub(S,v),v=e.add(d,y),m=e.add(_,C),v=e.mul(v,m),m=e.add(T,F),v=e.sub(v,m),I=e.mul(N,S),m=e.mul(L,F),I=e.add(m,I),m=e.sub(T,I),I=e.add(T,I),A=e.mul(m,I),T=e.add(z,z),T=e.add(T,z),F=e.mul(N,F),S=e.mul(L,S),T=e.add(T,F),F=e.sub(z,F),F=e.mul(N,F),S=e.add(S,F),z=e.mul(T,S),A=e.add(A,z),z=e.mul(v,S),m=e.mul(q,m),m=e.sub(m,z),z=e.mul(q,T),I=e.mul(v,I),I=e.add(I,z),new l(m,A,I)}subtract(w){return this.add(w.negate())}is0(){return this.equals(l.ZERO)}wNAF(w){return h.wNAFCached(this,a,w,k=>{const d=e.invertBatch(k.map(y=>y.pz));return k.map((y,E)=>y.toAffine(d[E])).map(l.fromAffine)})}multiplyUnsafe(w){const k=l.ZERO;if(w===_n)return k;if(u(w),w===Q)return this;const{endo:d}=t;if(!d)return h.unsafeLadder(this,w);let{k1neg:y,k1:E,k2neg:_,k2:C}=d.splitScalar(w),m=k,A=k,I=this;for(;E>_n||C>_n;)E&Q&&(m=m.add(I)),C&Q&&(A=A.add(I)),I=I.double(),E>>=Q,C>>=Q;return y&&(m=m.negate()),_&&(A=A.negate()),A=new l(e.mul(A.px,d.beta),A.py,A.pz),m.add(A)}multiply(w){u(w);let k=w,d,y;const{endo:E}=t;if(E){const{k1neg:_,k1:C,k2neg:m,k2:A}=E.splitScalar(k);let{p:I,f:N}=this.wNAF(C),{p:L,f:z}=this.wNAF(A);I=h.constTimeNegate(_,I),L=h.constTimeNegate(m,L),L=new l(e.mul(L.px,E.beta),L.py,L.pz),d=I.add(L),y=N.add(z)}else{const{p:_,f:C}=this.wNAF(k);d=_,y=C}return l.normalizeZ([d,y])[0]}multiplyAndAddUnsafe(w,k,d){const y=l.BASE,E=(C,m)=>m===_n||m===Q||!C.equals(y)?C.multiplyUnsafe(m):C.multiply(m),_=E(this,k).add(E(w,d));return _.is0()?void 0:_}toAffine(w){const{px:k,py:d,pz:y}=this,E=this.is0();w==null&&(w=E?e.ONE:e.inv(y));const _=e.mul(k,w),C=e.mul(d,w),m=e.mul(y,w);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(m,e.ONE))throw new Error("invZ was invalid");return{x:_,y:C}}isTorsionFree(){const{h:w,isTorsionFree:k}=t;if(w===Q)return!0;if(k)return k(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:k}=t;return w===Q?this:k?k(l,this):this.multiplyUnsafe(t.h)}toRawBytes(w=!0){return this.assertValidity(),r(l,this,w)}toHex(w=!0){return dt(this.toRawBytes(w))}}l.BASE=new l(t.Gx,t.Gy,e.ONE),l.ZERO=new l(e.ZERO,e.ONE,e.ZERO);const g=t.nBitLength,h=Zl(l,t.endo?Math.ceil(g/2):g);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function Xl(n){const t=Oi(n);return pt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Jl(n){const t=Xl(n),{Fp:e,n:r}=t,i=e.BYTES+1,o=2*e.BYTES+1;function s(S){return _n<S&&S<e.ORDER}function u(S){return nn(S,r)}function c(S){return Ye(S,r)}const{ProjectivePoint:a,normPrivateKeyToScalar:f,weierstrassEquation:l,isWithinCurveOrder:g}=Ql({...t,toBytes(S,v,O){const R=v.toAffine(),D=e.toBytes(R.x),p=wn;return O?p(Uint8Array.from([v.hasEvenY()?2:3]),D):p(Uint8Array.from([4]),D,e.toBytes(R.y))},fromBytes(S){const v=S.length,O=S[0],R=S.subarray(1);if(v===i&&(O===2||O===3)){const D=fn(R);if(!s(D))throw new Error("Point is not on curve");const p=l(D);let j=e.sqrt(p);const V=(j&Q)===Q;return(O&1)===1!==V&&(j=e.neg(j)),{x:D,y:j}}else if(v===o&&O===4){const D=e.fromBytes(R.subarray(0,e.BYTES)),p=e.fromBytes(R.subarray(e.BYTES,2*e.BYTES));return{x:D,y:p}}else throw new Error(`Point of length ${v} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),h=S=>dt(Xn(S,t.nByteLength));function x(S){const v=r>>Q;return S>v}function w(S){return x(S)?u(-S):S}const k=(S,v,O)=>fn(S.slice(v,O));class d{constructor(v,O,R){this.r=v,this.s=O,this.recovery=R,this.assertValidity()}static fromCompact(v){const O=t.nByteLength;return v=tn("compactSignature",v,O*2),new d(k(v,0,O),k(v,O,2*O))}static fromDER(v){const{r:O,s:R}=ut.toSig(tn("DER",v));return new d(O,R)}assertValidity(){if(!g(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!g(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new d(this.r,this.s,v)}recoverPublicKey(v){const{r:O,s:R,recovery:D}=this,p=A(tn("msgHash",v));if(D==null||![0,1,2,3].includes(D))throw new Error("recovery id invalid");const j=D===2||D===3?O+t.n:O;if(j>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const V=D&1?"03":"02",b=a.fromHex(V+h(j)),X=c(j),xn=u(-p*X),W=u(R*X),gn=a.BASE.multiplyAndAddUnsafe(b,xn,W);if(!gn)throw new Error("point at infinify");return gn.assertValidity(),gn}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new d(this.r,u(-this.s),this.recovery):this}toDERRawBytes(){return gt(this.toDERHex())}toDERHex(){return ut.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return gt(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const y={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const S=t.randomBytes(e.BYTES+8),v=Vl(S,r);return Xn(v,t.nByteLength)},precompute(S=8,v=a.BASE){return v._setWindowSize(S),v.multiply(BigInt(3)),v}};function E(S,v=!0){return a.fromPrivateKey(S).toRawBytes(v)}function _(S){const v=S instanceof Uint8Array,O=typeof S=="string",R=(v||O)&&S.length;return v?R===i||R===o:O?R===2*i||R===2*o:S instanceof a}function C(S,v,O=!0){if(_(S))throw new Error("first arg must be private key");if(!_(v))throw new Error("second arg must be public key");return a.fromHex(v).multiply(f(S)).toRawBytes(O)}const m=t.bits2int||function(S){const v=fn(S),O=S.length*8-t.nBitLength;return O>0?v>>BigInt(O):v},A=t.bits2int_modN||function(S){return u(m(S))},I=We(t.nBitLength);function N(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(_n<=S&&S<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Xn(S,t.nByteLength)}function L(S,v,O=z){if(["recovered","canonical"].some(pn=>pn in O))throw new Error("sign() legacy options not supported");const{hash:R,randomBytes:D}=t;let{lowS:p,prehash:j,extraEntropy:V}=O;p==null&&(p=!0),S=tn("msgHash",S),j&&(S=tn("prehashed msgHash",R(S)));const b=A(S),X=f(v),xn=[N(X),N(b)];if(V!=null){const pn=V===!0?D(e.BYTES):V;xn.push(tn("extraEntropy",pn,e.BYTES))}const W=wn(...xn),gn=b;function An(pn){const yn=m(pn);if(!g(yn))return;const mt=c(yn),jn=a.BASE.multiply(yn).toAffine(),En=u(jn.x);if(En===_n)return;const tt=u(mt*u(gn+En*X));if(tt===_n)return;let ue=(jn.x===En?0:2)|Number(jn.y&Q),le=tt;return p&&x(tt)&&(le=w(tt),ue^=1),new d(En,le,ue)}return{seed:W,k2sig:An}}const z={lowS:t.lowS,prehash:!1},T={lowS:t.lowS,prehash:!1};function F(S,v,O=z){const{seed:R,k2sig:D}=L(S,v,O);return vi(t.hash.outputLen,t.nByteLength,t.hmac)(R,D)}a.BASE._setWindowSize(8);function q(S,v,O,R=T){var jn;const D=S;if(v=tn("msgHash",v),O=tn("publicKey",O),"strict"in R)throw new Error("options.strict was renamed to lowS");const{lowS:p,prehash:j}=R;let V,b;try{if(typeof D=="string"||D instanceof Uint8Array)try{V=d.fromDER(D)}catch(En){if(!(En instanceof ut.Err))throw En;V=d.fromCompact(D)}else if(typeof D=="object"&&typeof D.r=="bigint"&&typeof D.s=="bigint"){const{r:En,s:tt}=D;V=new d(En,tt)}else throw new Error("PARSE");b=a.fromHex(O)}catch(En){if(En.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(p&&V.hasHighS())return!1;j&&(v=t.hash(v));const{r:X,s:xn}=V,W=A(v),gn=c(xn),An=u(W*gn),pn=u(X*gn),yn=(jn=a.BASE.multiplyAndAddUnsafe(b,An,pn))==null?void 0:jn.toAffine();return yn?u(yn.x)===X:!1}return{CURVE:t,getPublicKey:E,getSharedSecret:C,sign:F,verify:q,ProjectivePoint:a,Signature:d,utils:y}}function na(n,t){const e=n.ORDER;let r=_n;for(let g=e-Q;g%Mn===_n;g/=Mn)r+=Q;const i=r,o=(e-Q)/Mn**i,s=(o-Q)/Mn,u=Mn**i-Q,c=Mn**(i-Q),a=n.pow(t,o),f=n.pow(t,(o+Q)/Mn);let l=(g,h)=>{let x=a,w=n.pow(h,u),k=n.sqr(w);k=n.mul(k,h);let d=n.mul(g,k);d=n.pow(d,s),d=n.mul(d,w),w=n.mul(d,h),k=n.mul(d,g);let y=n.mul(k,w);d=n.pow(y,c);let E=n.eql(d,n.ONE);w=n.mul(k,f),d=n.mul(y,x),k=n.cmov(w,k,E),y=n.cmov(d,y,E);for(let _=i;_>Q;_--){let C=Mn**(_-Mn),m=n.pow(y,C);const A=n.eql(m,n.ONE);w=n.mul(k,x),x=n.mul(x,x),m=n.mul(y,x),k=n.cmov(w,k,A),y=n.cmov(m,y,A)}return{isValid:E,value:k}};if(n.ORDER%$i===Jt){const g=(n.ORDER-Jt)/$i,h=n.sqrt(n.neg(t));l=(x,w)=>{let k=n.sqr(w);const d=n.mul(x,w);k=n.mul(k,d);let y=n.pow(k,g);y=n.mul(y,d);const E=n.mul(y,h),_=n.mul(n.sqr(y),w),C=n.eql(_,x);let m=n.cmov(E,y,C);return{isValid:C,value:m}}}return l}function ta(n,t){if(Ti(n),!n.isValid(t.A)||!n.isValid(t.B)||!n.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const e=na(n,t.Z);if(!n.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,o,s,u,c,a,f,l;i=n.sqr(r),i=n.mul(i,t.Z),o=n.sqr(i),o=n.add(o,i),s=n.add(o,n.ONE),s=n.mul(s,t.B),u=n.cmov(t.Z,n.neg(o),!n.eql(o,n.ZERO)),u=n.mul(u,t.A),o=n.sqr(s),a=n.sqr(u),c=n.mul(a,t.A),o=n.add(o,c),o=n.mul(o,s),a=n.mul(a,u),c=n.mul(a,t.B),o=n.add(o,c),f=n.mul(i,s);const{isValid:g,value:h}=e(o,a);l=n.mul(i,r),l=n.mul(l,h),f=n.cmov(f,s,g),l=n.cmov(l,h,g);const x=n.isOdd(r)===n.isOdd(l);return l=n.cmov(n.neg(l),l,x),f=n.div(f,u),{x:f,y:l}}}function ea(n){if(n instanceof Uint8Array)return n;if(typeof n=="string")return Xt(n);throw new Error("DST must be Uint8Array or string")}const ra=fn;function Jn(n,t){if(n<0||n>=1<<8*t)throw new Error(`bad I2OSP call: value=${n} length=${t}`);const e=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)e[r]=n&255,n>>>=8;return new Uint8Array(e)}function ia(n,t){const e=new Uint8Array(n.length);for(let r=0;r<n.length;r++)e[r]=n[r]^t[r];return e}function vt(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected")}function Xe(n){if(!Number.isSafeInteger(n))throw new Error("number expected")}function oa(n,t,e,r){vt(n),vt(t),Xe(e),t.length>255&&(t=r(wn(Xt("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:o}=r,s=Math.ceil(e/i);if(s>255)throw new Error("Invalid xmd length");const u=wn(t,Jn(t.length,1)),c=Jn(0,o),a=Jn(e,2),f=new Array(s),l=r(wn(c,n,a,Jn(0,1),u));f[0]=r(wn(l,Jn(1,1),u));for(let h=1;h<=s;h++){const x=[ia(l,f[h-1]),Jn(h+1,1),u];f[h]=r(wn(...x))}return wn(...f).slice(0,e)}function sa(n,t,e,r,i){if(vt(n),vt(t),Xe(e),t.length>255){const o=Math.ceil(2*r/8);t=i.create({dkLen:o}).update(Xt("H2C-OVERSIZE-DST-")).update(t).digest()}if(e>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:e}).update(n).update(Jn(e,2)).update(t).update(Jn(t.length,1)).digest()}function Li(n,t,e){pt(e,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:o,hash:s,expand:u,DST:c}=e;vt(n),Xe(t);const a=ea(c),f=r.toString(2).length,l=Math.ceil((f+i)/8),g=t*o*l;let h;if(u==="xmd")h=oa(n,a,g,s);else if(u==="xof")h=sa(n,a,g,i,s);else if(u==="_internal_pass")h=n;else throw new Error('expand must be "xmd" or "xof"');const x=new Array(t);for(let w=0;w<t;w++){const k=new Array(o);for(let d=0;d<o;d++){const y=l*(d+w*o),E=h.subarray(y,y+l);k[d]=nn(ra(E),r)}x[w]=k}return x}function ua(n,t){const e=t.map(r=>Array.from(r).reverse());return(r,i)=>{const[o,s,u,c]=e.map(a=>a.reduce((f,l)=>n.add(n.mul(f,r),l)));return r=n.div(o,s),i=n.mul(i,n.div(u,c)),{x:r,y:i}}}function la(n,t,e){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,i){const o=Li(r,2,{...e,DST:e.DST,...i}),s=n.fromAffine(t(o[0])),u=n.fromAffine(t(o[1])),c=s.add(u).clearCofactor();return c.assertValidity(),c},encodeToCurve(r,i){const o=Li(r,1,{...e,DST:e.encodeDST,...i}),s=n.fromAffine(t(o[0])).clearCofactor();return s.assertValidity(),s}}}class Pi extends ui{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,ot.hash(t);const r=Le(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?t.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(t){return ot.exists(this),this.iHash.update(t),this}digestInto(t){ot.exists(this),ot.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:i,destroyed:o,blockLen:s,outputLen:u}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=s,t.outputLen=u,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Fi=(n,t,e)=>new Pi(n,t).update(e).digest();Fi.create=(n,t)=>new Pi(n,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function aa(n){return{hash:n,hmac:(t,...e)=>Fi(n,t,si(...e)),randomBytes:ai}}function ca(n,t){const e=r=>Jl({...n,...aa(r)});return Object.freeze({...e(t),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ne=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),te=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ri=BigInt(1),ee=BigInt(2),Ni=(n,t)=>(n+t/ee)/t;function Di(n){const t=ne,e=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),u=BigInt(44),c=BigInt(88),a=n*n*n%t,f=a*a*n%t,l=Sn(f,e,t)*f%t,g=Sn(l,e,t)*f%t,h=Sn(g,ee,t)*a%t,x=Sn(h,i,t)*h%t,w=Sn(x,o,t)*x%t,k=Sn(w,u,t)*w%t,d=Sn(k,c,t)*k%t,y=Sn(d,u,t)*w%t,E=Sn(y,e,t)*f%t,_=Sn(E,s,t)*x%t,C=Sn(_,r,t)*a%t,m=Sn(C,ee,t);if(!nt.eql(nt.sqr(m),n))throw new Error("Cannot find square root");return m}const nt=jl(ne,void 0,void 0,{sqrt:Di}),re=ca({a:BigInt(0),b:BigInt(7),Fp:nt,n:te,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const t=te,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Ri*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,s=BigInt("0x100000000000000000000000000000000"),u=Ni(o*n,t),c=Ni(-r*n,t);let a=nn(n-u*e-c*i,t),f=nn(-u*r-c*o,t);const l=a>s,g=f>s;if(l&&(a=t-a),g&&(f=t-f),a>s||f>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:l,k1:a,k2neg:g,k2:f}}}},zt),ie=BigInt(0),Ui=n=>typeof n=="bigint"&&ie<n&&n<ne,fa=n=>typeof n=="bigint"&&ie<n&&n<te,qi={};function oe(n,...t){let e=qi[n];if(e===void 0){const r=zt(Uint8Array.from(n,i=>i.charCodeAt(0)));e=wn(r,r),qi[n]=e}return zt(wn(e,...t))}const Je=n=>n.toRawBytes(!0).slice(1),nr=n=>Xn(n,32),tr=n=>nn(n,ne),Bt=n=>nn(n,te),er=re.ProjectivePoint,ha=(n,t,e)=>er.BASE.multiplyAndAddUnsafe(n,t,e);function rr(n){let t=re.utils.normPrivateKeyToScalar(n),e=er.fromPrivateKey(t);return{scalar:e.hasEvenY()?t:Bt(-t),bytes:Je(e)}}function Hi(n){if(!Ui(n))throw new Error("bad x: need 0 < x < p");const t=tr(n*n),e=tr(t*n+BigInt(7));let r=Di(e);r%ee!==ie&&(r=tr(-r));const i=new er(n,r,Ri);return i.assertValidity(),i}function Mi(...n){return Bt(fn(oe("BIP0340/challenge",...n)))}function da(n){return rr(n).bytes}function ga(n,t,e=ai(32)){const r=tn("message",n),{bytes:i,scalar:o}=rr(t),s=tn("auxRand",e,32),u=nr(o^fn(oe("BIP0340/aux",s))),c=oe("BIP0340/nonce",u,i,r),a=Bt(fn(c));if(a===ie)throw new Error("sign failed: k is zero");const{bytes:f,scalar:l}=rr(a),g=Mi(f,i,r),h=new Uint8Array(64);if(h.set(f,0),h.set(nr(Bt(l+g*o)),32),!ji(h,r,i))throw new Error("sign: Invalid signature produced");return h}function ji(n,t,e){const r=tn("signature",n,64),i=tn("message",t),o=tn("publicKey",e,32);try{const s=Hi(fn(o)),u=fn(r.subarray(0,32));if(!Ui(u))return!1;const c=fn(r.subarray(32,64));if(!fa(c))return!1;const a=Mi(nr(u),Je(s),i),f=ha(s,c,Bt(-a));return!(!f||!f.hasEvenY()||f.toAffine().x!==u)}catch{return!1}}const se={getPublicKey:da,sign:ga,verify:ji,utils:{randomPrivateKey:re.utils.randomPrivateKey,lift_x:Hi,pointToBytes:Je,numberToBytesBE:Xn,bytesToNumberBE:fn,taggedHash:oe,mod:nn}},pa=ua(nt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(n=>n.map(t=>BigInt(t)))),ma=ta(nt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:nt.create(BigInt("-11"))});la(re.ProjectivePoint,n=>{const{x:t,y:e}=ma(nt.create(n[0]));return pa(t,e)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:nt.ORDER,m:1,k:128,expand:"xmd",hash:zt});function ba(){return On(se.utils.randomPrivateKey())}function wa(n){return On(se.getPublicKey(n))}function xa(n){if(!Vi(n))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,n.pubkey,n.created_at,n.kind,n.tags,n.content])}function ir(n){let t=zt(De.encode(xa(n)));return On(t)}const ya=n=>n instanceof Object;function Vi(n){if(!ya(n)||typeof n.kind!="number"||typeof n.content!="string"||typeof n.created_at!="number"||typeof n.pubkey!="string"||!n.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(n.tags))return!1;for(let t=0;t<n.tags.length;t++){let e=n.tags[t];if(!Array.isArray(e))return!1;for(let r=0;r<e.length;r++)if(typeof e[r]=="object")return!1}return!0}function Ea(n){try{return se.verify(n.sig,ir(n),n.pubkey)}catch{return!1}}function ka(n,t){return On(se.sign(ir(n),t))}const Sa=on('<div class="ztr-reply-form"><textarea placeholder="Add your comment..."></textarea><div class="ztr-reply-controls"><div class="ztr-comment-info-picture"><img></div><button class="ztr-reply-button">Reply'),Aa=on('<span class="ztr-reply-error">Publishing is disabled'),Ca=on('<span class="ztr-reply-error">'),_a=on('<svg width="16" height="16" class="ztr-spinner" viewBox="0 0 50 50"><circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5">'),za=on('<button class="ztr-reply-login-button">Log-in'),va=on('<li class="ztr-comment-action-zap"><a><svg viewBox="0 -2 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18,11.74a1,1,0,0,0-.52-.63L14.09,9.43,15,3.14a1,1,0,0,0-1.78-.75l-7,9a1,1,0,0,0-.17.87,1,1,0,0,0,.59.67l4.27,1.71L10,20.86a1,1,0,0,0,.63,1.07A.92.92,0,0,0,11,22a1,1,0,0,0,.83-.45l6-9A1,1,0,0,0,18,11.74Z"></path></svg></a><span> sats'),Ba=on('<li class="ztr-comment-action-like"><a><svg viewBox="0 -16 180 180" xmlns="http://www.w3.org/2000/svg"><path d="M60.732 29.7C41.107 29.7 22 39.7 22 67.41c0 27.29 45.274 67.29 74 94.89 28.744-27.6 74-67.6 74-94.89 0-27.71-19.092-37.71-38.695-37.71C116 29.7 104.325 41.575 96 54.066 87.638 41.516 76 29.7 60.732 29.7z"></path></svg></a><span> likes'),Ia=on('<div class="ztr-comment-new"><div class="ztr-comment-body"><ul class="ztr-comment-actions">'),Wi=n=>{const{pool:t,relays:e,filter:r,pubkey:i}=so(ii),[o,s]=Cn(""),[u,c]=Cn(!1),[a,f]=Cn("");bt(()=>{var w;i()&&!((w=ln[i()])!=null&&w.loggedIn)&&(h(),g()),!i()&&l()&&h()});const l=()=>Object.values(ln).find(w=>w.loggedIn===!0),g=async()=>{const w=i()||await window.nostr.getPublicKey();if(w){if(ln[w]={timestamp:0,loggedIn:!0,npub:Wt(w),signEvent:async function(k){const d=await window.nostr.getPublicKey();if(i()!==d)throw`Pubkey mismatch: ${i()} !== ${d}`;return window.nostr.signEvent(k)}},!ln[w].name){const k=await t.list(e(),[{kinds:[0],authors:[w]}]);yi(k)}}else alert("Access was denied")},h=()=>{const w=l();w&&(w.loggedIn=!1)},x=async w=>{if(!w&&!ln.anonymous){const A=ba();w=ln.anonymous={timestamp:0,npub:Wt(wa(A)),signEvent:async I=>({sig:ka(I,A)})}}if(!w.signEvent)return;const k=o().trim();if(!k)return;const d={kind:1,created_at:Math.round(Date.now()/1e3),content:k,pubkey:qe(w.npub).data.toString(),tags:[]};if(d.tags.push(dl(r())),n.replyTo){const A=["e",n.replyTo,"","reply"];d.tags.push(A)}const y=ir(d),E=await w.signEvent(d),_={id:y,...d,...E},C=()=>{var A;c(!1),s(""),f(""),it[_.id]=_,(A=n.onDone)==null||A.call(globalThis)},m=()=>{c(!1),f("Your comment was not published to relays. Try again.")};if(c(!0),console.log(JSON.stringify(_,null,2)),In.disablePublish)setTimeout(()=>{C()},1500);else{const A=t.publish(e(),_);A.on("ok",()=>{C(),A.off("ok",C)}),A.on("failed",()=>{m(),A.off("failed",m)})}};return(()=>{const w=Sa(),k=w.firstChild,d=k.nextSibling,y=d.firstChild,E=y.firstChild,_=y.nextSibling,C=_.firstChild;return k.addEventListener("change",m=>s(m.target.value)),k.autofocus=!0,H(d,(()=>{const m=bn(()=>!!In.disablePublish);return()=>m()&&Aa()})(),y),H(d,(()=>{const m=bn(()=>!!a());return()=>m()&&(()=>{const A=Ca();return H(A,a),A})()})(),y),_.$$click=()=>x(l()||ln.anonymous),H(_,(()=>{const m=bn(()=>!!u());return()=>m()&&_a()})(),C),H(_,()=>u()?"ing":"",null),H(_,(()=>{const m=bn(()=>!!l());return()=>m()?` as ${l().name||Zt(l().npub)}`:" anonymously"})(),null),H(d,(()=>{const m=bn(()=>!!(!l()&&window.nostr));return()=>m()&&(()=>{const A=za();return A.$$click=g,A})()})(),null),Zn(m=>{var L;const A=u(),I=((L=l())==null?void 0:L.imgUrl)||Yt,N=u();return A!==m._v$&&(k.disabled=m._v$=A),I!==m._v$2&&an(E,"src",m._v$2=I),N!==m._v$3&&(_.disabled=m._v$3=N),m},{_v$:void 0,_v$2:void 0,_v$3:void 0}),Zn(()=>k.value=o()),w})()},Ta=()=>(()=>{const n=Ia(),t=n.firstChild,e=t.firstChild;return H(e,hn(yt,{get when(){return!In.disableZaps},get children(){const r=va(),i=r.firstChild,o=i.firstChild,s=i.nextSibling,u=s.firstChild;return an(o,"width",kn),an(o,"height",kn),H(s,()=>Kt()*11,u),r}}),null),H(e,hn(yt,{get when(){return!In.disableLikes},get children(){const r=Ba(),i=r.firstChild,o=i.firstChild,s=i.nextSibling,u=s.firstChild;return an(o,"width",kn),an(o,"height",kn),H(s,Kt,u),r}}),null),H(t,hn(Wi,{}),null),n})();mr(["click"]);const Oa=on('<div class="ztr-thread">'),$a=on('<li class="ztr-comment-action-zap"><a><svg viewBox="0 -2 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18,11.74a1,1,0,0,0-.52-.63L14.09,9.43,15,3.14a1,1,0,0,0-1.78-.75l-7,9a1,1,0,0,0-.17.87,1,1,0,0,0,.59.67l4.27,1.71L10,20.86a1,1,0,0,0,.63,1.07A.92.92,0,0,0,11,22a1,1,0,0,0,.83-.45l6-9A1,1,0,0,0,18,11.74Z"></path></svg></a><span> sats'),La=on('<li class="ztr-comment-action-like"><a><svg viewBox="0 -16 180 180" xmlns="http://www.w3.org/2000/svg"><path d="M60.732 29.7C41.107 29.7 22 39.7 22 67.41c0 27.29 45.274 67.29 74 94.89 28.744-27.6 74-67.6 74-94.89 0-27.71-19.092-37.71-38.695-37.71C116 29.7 104.325 41.575 96 54.066 87.638 41.516 76 29.7 60.732 29.7z"></path></svg></a><span> likes'),Pa=on('<div class="ztr-comment"><div class="ztr-comment-text"><div class="ztr-comment-body"><span></span><ul class="ztr-comment-actions"><li class="ztr-comment-action-reply"><a><svg viewBox="0 -6 60 60" xmlns="http://www.w3.org/2000/svg"><path d="M 12.6030 50.4905 C 13.3758 50.4905 13.9307 50.1140 14.8621 49.2421 L 20.6483 43.8720 C 19.5188 42.9803 18.6073 41.5733 18.6073 38.3433 L 18.6073 25.2052 C 18.6073 19.1217 22.3129 15.5152 28.3766 15.5152 L 42.2479 15.5152 L 42.2281 14.7622 C 41.9306 10.6999 39.2557 8.0643 34.7177 8.0643 L 7.5301 8.0643 C 2.9922 8.0643 0 10.7791 0 15.4954 L 0 34.9548 C 0 39.6710 2.9922 42.7028 7.5301 42.7028 L 10.8195 42.7028 L 10.8195 48.4693 C 10.8195 49.6979 11.4735 50.4905 12.6030 50.4905 Z M 44.6058 53.2450 C 45.7353 53.2450 46.3895 52.4325 46.3895 51.2237 L 46.3895 45.4374 L 48.4702 45.4374 C 53.0078 45.4374 56 42.4056 56 37.7092 L 56 25.6610 C 56 20.9250 53.0078 18.2300 48.4702 18.2300 L 28.8522 18.2300 C 24.1161 18.2300 21.3221 20.9250 21.3221 25.6610 L 21.3221 37.7092 C 21.3221 42.4056 24.1161 45.4374 28.8522 45.4374 L 35.1735 45.4374 L 42.3470 51.9767 C 43.2784 52.8487 43.8331 53.2450 44.6058 53.2450 Z"></path></svg></a><span></span></li></ul></div></div><div class="ztr-comment-replies">'),Fa=on('<div class="ztr-comment-info"><div class="ztr-comment-info-picture"><img></div><ul class="ztr-comment-info-items"><li class="ztr-comment-info-item ztr-comment-info-author"><a target="_blank"></a></li><li class="ztr-comment-info-item ztr-comment-info-time"></li><li class="ztr-comment-info-item ztr-comment-info-replies">'),Zi=n=>(()=>{const t=Oa();return H(t,hn(mo,{get each(){return Na(n.nestedEvents())},children:e=>{const[r,i]=Cn(!1);return(()=>{const o=Pa(),s=o.firstChild,u=s.firstChild,c=u.firstChild,a=c.nextSibling,f=a.firstChild,l=f.firstChild,g=l.firstChild,h=l.nextSibling,x=s.nextSibling;return H(s,hn(Ra,{event:e}),u),H(a,hn(yt,{get when(){return!In.disableZaps},get children(){const w=$a(),k=w.firstChild,d=k.firstChild,y=k.nextSibling,E=y.firstChild;return an(d,"width",kn),an(d,"height",kn),H(y,()=>Kt()*11,E),w}}),f),H(a,hn(yt,{get when(){return!In.disableLikes},get children(){const w=La(),k=w.firstChild,d=k.firstChild,y=k.nextSibling,E=y.firstChild;return an(d,"width",kn),an(d,"height",kn),H(y,Kt,E),w}}),f),l.$$click=()=>i(!r()),an(g,"width",kn),an(g,"height",kn),h.$$click=()=>i(!r()),H(h,()=>r()?"Cancel":"Reply"),H(u,(()=>{const w=bn(()=>!!r());return()=>w()&&hn(Wi,{get replyTo(){return e().id},onDone:()=>i(!1)})})(),null),H(x,hn(Zi,{nestedEvents:()=>e().children})),Zn(()=>c.innerHTML=gl(e())),o})()}})),t})(),Ra=n=>{const[t,e]=Cn(Yt),r=()=>n.event().pubkey,i=()=>Wt(r());bt(()=>{var f,l;ln[f=r()]||(ln[f]={timestamp:0,npub:i()});const a=(l=ln[r()])==null?void 0:l.imgUrl;e(a||Yt)});let o;const s=()=>pl(n.event().created_at*1e3),[u,c]=Cn();return bt(()=>{c(s()),o=setInterval(()=>{c(s())},60*1e3)}),wt(()=>clearInterval(o)),(()=>{const a=Fa(),f=a.firstChild,l=f.firstChild,g=f.nextSibling,h=g.firstChild,x=h.firstChild,w=h.nextSibling,k=w.nextSibling;return l.addEventListener("error",()=>e(Yt)),an(l,"width",kn),an(l,"height",kn),H(x,()=>{var d;return((d=ln[r()])==null?void 0:d.name)||Zt(i())}),H(w,u),H(k,(()=>{const d=bn(()=>He(n.event())==1);return()=>d()?"1 reply":`${He(n.event())} replies`})()),Zn(d=>{const y=t(),E="https://nostr.com/"+i();return y!==d._v$&&an(l,"src",d._v$=y),E!==d._v$2&&an(x,"href",d._v$2=E),d},{_v$:void 0,_v$2:void 0}),a})()},Na=n=>n.sort((t,e)=>(t.created_at||0)>=(e.created_at||0)?-1:1);mr(["click"]);function Da(n,t){if(n.ids&&n.ids.indexOf(t.id)===-1&&!n.ids.some(e=>t.id.startsWith(e))||n.kinds&&n.kinds.indexOf(t.kind)===-1||n.authors&&n.authors.indexOf(t.pubkey)===-1&&!n.authors.some(e=>t.pubkey.startsWith(e)))return!1;for(let e in n)if(e[0]==="#"){let r=e.slice(1),i=n[`#${r}`];if(i&&!t.tags.find(([o,s])=>o===e.slice(1)&&i.indexOf(s)!==-1))return!1}return!(n.since&&t.created_at<n.since||n.until&&t.created_at>=n.until)}function Ua(n,t){for(let e=0;e<n.length;e++)if(Da(n[e],t))return!0;return!1}function qa(n,t){let e=t.length+3,r=n.indexOf(`"${t}":`)+e,i=n.slice(r).indexOf('"')+r+1;return n.slice(i,i+64)}function Ha(n){let t=n.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let e=n.slice(t+7+1).indexOf('"');if(e===-1)return null;let r=t+7+1+e,i=n.slice(r+1,80).indexOf('"');if(i===-1)return null;let o=r+1+i;return n.slice(r+1,o)}const Ki=()=>({connect:[],disconnect:[],error:[],notice:[],auth:[]});function Ma(n,t={}){let{listTimeout:e=3e3,getTimeout:r=3e3,countTimeout:i=3e3}=t;var o,s={},u=Ki(),c={},a={},f;async function l(){return f||(f=new Promise((d,y)=>{try{o=new WebSocket(n)}catch(m){y(m)}o.onopen=()=>{u.connect.forEach(m=>m()),d()},o.onerror=()=>{f=void 0,u.error.forEach(m=>m()),y()},o.onclose=async()=>{f=void 0,u.disconnect.forEach(m=>m())};let E=new il,_;o.onmessage=m=>{E.enqueue(m.data),_||(_=setInterval(C,0))};function C(){var I,N,L;if(E.size===0){clearInterval(_),_=null;return}var m=E.dequeue();if(!m)return;let A=Ha(m);if(A){let z=s[A];if(z&&z.alreadyHaveEvent&&z.alreadyHaveEvent(qa(m,"id"),n))return}try{let z=JSON.parse(m);switch(z[0]){case"EVENT":{let S=z[1],v=z[2];Vi(v)&&s[S]&&(s[S].skipVerification||Ea(v))&&Ua(s[S].filters,v)&&(s[S],(((I=c[S])==null?void 0:I.event)||[]).forEach(O=>O(v)));return}case"COUNT":let T=z[1],F=z[2];s[T]&&(((N=c[T])==null?void 0:N.count)||[]).forEach(S=>S(F));return;case"EOSE":{let S=z[1];S in c&&(c[S].eose.forEach(v=>v()),c[S].eose=[]);return}case"OK":{let S=z[1],v=z[2],O=z[3]||"";S in a&&(v?a[S].ok.forEach(R=>R()):a[S].failed.forEach(R=>R(O)),a[S].ok=[],a[S].failed=[]);return}case"NOTICE":let q=z[1];u.notice.forEach(S=>S(q));return;case"AUTH":{let S=z[1];(L=u.auth)==null||L.forEach(v=>v(S));return}}}catch{return}}}),f)}function g(){return(o==null?void 0:o.readyState)===1}async function h(){g()||await l()}async function x(d){let y=JSON.stringify(d);if(!(!g()&&(await new Promise(E=>setTimeout(E,1e3)),!g())))try{o.send(y)}catch(E){console.log(E)}}const w=(d,{verb:y="REQ",skipVerification:E=!1,alreadyHaveEvent:_=null,id:C=Math.random().toString().slice(2)}={})=>{let m=C;return s[m]={id:m,filters:d,skipVerification:E,alreadyHaveEvent:_},x([y,m,...d]),{sub:(A,I={})=>w(A||d,{skipVerification:I.skipVerification||E,alreadyHaveEvent:I.alreadyHaveEvent||_,id:m}),unsub:()=>{delete s[m],delete c[m],x(["CLOSE",m])},on:(A,I)=>{c[m]=c[m]||{event:[],count:[],eose:[]},c[m][A].push(I)},off:(A,I)=>{let N=c[m],L=N[A].indexOf(I);L>=0&&N[A].splice(L,1)}}};function k(d,y){if(!d.id)throw new Error(`event ${d} has no id`);let E=d.id;return x([y,d]),{on:(_,C)=>{a[E]=a[E]||{ok:[],failed:[]},a[E][_].push(C)},off:(_,C)=>{let m=a[E];if(!m)return;let A=m[_].indexOf(C);A>=0&&m[_].splice(A,1)}}}return{url:n,sub:w,on:(d,y)=>{u[d].push(y),d==="connect"&&(o==null?void 0:o.readyState)===1&&y()},off:(d,y)=>{let E=u[d].indexOf(y);E!==-1&&u[d].splice(E,1)},list:(d,y)=>new Promise(E=>{let _=w(d,y),C=[],m=setTimeout(()=>{_.unsub(),E(C)},e);_.on("eose",()=>{_.unsub(),clearTimeout(m),E(C)}),_.on("event",A=>{C.push(A)})}),get:(d,y)=>new Promise(E=>{let _=w([d],y),C=setTimeout(()=>{_.unsub(),E(null)},r);_.on("event",m=>{_.unsub(),clearTimeout(C),E(m)})}),count:d=>new Promise(y=>{let E=w(d,{...w,verb:"COUNT"}),_=setTimeout(()=>{E.unsub(),y(null)},i);E.on("count",C=>{E.unsub(),clearTimeout(_),y(C)})}),publish(d){return k(d,"EVENT")},auth(d){return k(d,"AUTH")},connect:h,close(){u=Ki(),c={},a={},o.readyState===WebSocket.OPEN&&(o==null||o.close())},get status(){return(o==null?void 0:o.readyState)??3}}}class ja{constructor(t={}){Pn(this,"_conn");Pn(this,"_seenOn",{});Pn(this,"eoseSubTimeout");Pn(this,"getTimeout");this._conn={},this.eoseSubTimeout=t.eoseSubTimeout||3400,this.getTimeout=t.getTimeout||3400}close(t){t.forEach(e=>{let r=this._conn[wi(e)];r&&r.close()})}async ensureRelay(t){const e=wi(t);this._conn[e]||(this._conn[e]=Ma(e,{getTimeout:this.getTimeout*.9,listTimeout:this.getTimeout*.9}));const r=this._conn[e];return await r.connect(),r}sub(t,e,r){let i=new Set,o={...r||{}};o.alreadyHaveEvent=(h,x)=>{var k;if((k=r==null?void 0:r.alreadyHaveEvent)!=null&&k.call(r,h,x))return!0;let w=this._seenOn[h]||new Set;return w.add(x),this._seenOn[h]=w,i.has(h)};let s=[],u=new Set,c=new Set,a=t.length,f=!1,l=setTimeout(()=>{f=!0;for(let h of c.values())h()},this.eoseSubTimeout);t.forEach(async h=>{let x;try{x=await this.ensureRelay(h)}catch{k();return}if(!x)return;let w=x.sub(e,o);w.on("event",d=>{i.add(d.id);for(let y of u.values())y(d)}),w.on("eose",()=>{f||k()}),s.push(w);function k(){if(a--,a===0){clearTimeout(l);for(let d of c.values())d()}}});let g={sub(h,x){return s.forEach(w=>w.sub(h,x)),g},unsub(){s.forEach(h=>h.unsub())},on(h,x){h==="event"?u.add(x):h==="eose"&&c.add(x)},off(h,x){h==="event"?u.delete(x):h==="eose"&&c.delete(x)}};return g}get(t,e,r){return new Promise(i=>{let o=this.sub(t,[e],r),s=setTimeout(()=>{o.unsub(),i(null)},this.getTimeout);o.on("event",u=>{i(u),clearTimeout(s),o.unsub()})})}list(t,e,r){return new Promise(i=>{let o=[],s=this.sub(t,e,r);s.on("event",u=>{o.push(u)}),s.on("eose",()=>{s.unsub(),i(o)})})}publish(t,e){const r=t.map(async o=>{let s;try{return s=await this.ensureRelay(o),s.publish(e)}catch{return{on(){},off(){}}}}),i=new Map;return{on(o,s){t.forEach(async(u,c)=>{let a=await r[c],f=()=>s(u);i.set(s,f),a.on(o,f)})},off(o,s){t.forEach(async(u,c)=>{let a=i.get(s);a&&(await r[c]).off(o,a)})}}}seenOn(t){var e,r;return Array.from(((r=(e=this._seenOn[t])==null?void 0:e.values)==null?void 0:r.call(e))||[])}}const Va=on('<h2 id="ztr-title"> comments'),Wa=on('<h3 id="ztr-subtitle">2397 sats'),Za=on('<div id="ztr-root"><style>');function Yi(n){if(!["http","naddr","note","nevent"].some(f=>n.anchor.startsWith(f)))throw"Only NIP-19 naddr, note and nevent encoded entities and URLs are supported";In.disableLikes=n.disableLikes||!1,In.disableZaps=n.disableZaps||!1,In.disablePublish=n.disablePublish||!1;const[t,e]=Cn(),r=()=>n.pubkey,i=new ja,o=()=>n.relays.length>0?n.relays:["wss://relay.damus.io","wss://eden.nostr.land"];ro(async()=>{try{if(n.anchor.startsWith("http")){const g=(await i.list(o(),[{"#r":[n.anchor],kinds:[1]}])).map(h=>h.id);e({"#e":g})}else e(hl(n.anchor));const f=i.sub(o(),[{...t(),kinds:[1]}]);f.on("event",l=>{l.content&&(it[l.id]=l)}),wt(()=>f==null?void 0:f.unsub())}catch(f){console.log(f)}});const s=xr(f=>wr(f,16)),u=bn((f=[])=>s()&&Object.keys(it).length>0?Object.values(it):f),c=()=>bl(u()),a=xr(f=>wr(f,700));return bt(async()=>{if(a()&&Object.keys(it).length>0){const f=Object.values(it).map(g=>g.pubkey),l=await i.list(o(),[{kinds:[0],authors:[...new Set(f)]}]);yi(l)}}),(()=>{const f=Za(),l=f.firstChild;return H(l,Oo),H(f,hn(ii.Provider,{value:{pool:i,relays:o,filter:t,pubkey:r},get children(){return[hn(Ta,{}),(()=>{const g=Va(),h=g.firstChild;return H(g,()=>Object.keys(it).length,h),g})(),hn(yt,{get when(){return!In.disableZaps},get children(){return Wa()}}),hn(Zi,{nestedEvents:c})]}}),null),f})()}return To("zap-threads",{relays:"",anchor:"","disable-likes":"","disable-zaps":"","disable-publish":"",pubkey:""},n=>{const t=n.relays===""?[]:n.relays.split(",");return hn(Yi,{get anchor(){return n.anchor},relays:t,get pubkey(){return n.pubkey},get disableLikes(){return n["disable-likes"]==="true"},get disableZaps(){return n["disable-zaps"]==="true"},get disablePublish(){return n["disable-publish"]==="true"}})}),Yi}();
