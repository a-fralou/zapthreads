"use strict";var Co=Object.defineProperty;var _o=(n,t,e)=>t in n?Co(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Bn=(n,t,e)=>(_o(n,typeof t!="symbol"?t+"":t,e),e);const zo=(n,t)=>n===t,Kn=Symbol("solid-proxy"),me=Symbol("solid-track"),Pt={equals:zo};let Vr=Yr;const Xn=1,Ft=2,Wr={owned:null,cleanups:null,context:null,owner:null};var Q=null;let ue=null,Z=null,sn=null,Nn=null,Gt=0;function be(n,t){const e=Z,r=Q,i=n.length===0,o=i?Wr:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},s=i?n:()=>n(()=>Dn(()=>Qt(o)));Q=o,Z=null;try{return ht(s,!0)}finally{Z=e,Q=r}}function _n(n,t){t=t?Object.assign({},Pt,t):Pt;const e={value:n,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(e.value)),Kr(e,i));return[Zr.bind(e),r]}function Gn(n,t,e){const r=Re(n,t,!1,Xn);vt(r)}function yt(n,t,e){Vr=Po;const r=Re(n,t,!1,Xn),i=fr&&Ne(Q,fr.id);i&&(r.suspense=i),(!e||!e.render)&&(r.user=!0),Nn?Nn.push(r):vt(r)}function yn(n,t,e){e=e?Object.assign({},Pt,e):Pt;const r=Re(n,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=e.equals||void 0,vt(r),Zr.bind(r)}function Ot(n){return ht(n,!1)}function Dn(n){if(Z===null)return n();const t=Z;Z=null;try{return n()}finally{Z=t}}function vo(n){yt(()=>Dn(n))}function zt(n){return Q===null||(Q.cleanups===null?Q.cleanups=[n]:Q.cleanups.push(n)),n}function Fe(){return Z}function Bo(){return Q}function Io(n,t){const e=Symbol("context");return{id:e,Provider:Fo(e),defaultValue:n}}function To(n){let t;return(t=Ne(Q,n.id))!==void 0?t:n.defaultValue}function Oo(n){const t=yn(n),e=yn(()=>we(t()));return e.toArray=()=>{const r=e();return Array.isArray(r)?r:r!=null?[r]:[]},e}let fr;function Zr(){if(this.sources&&this.state)if(this.state===Xn)vt(this);else{const n=sn;sn=null,ht(()=>Nt(this),!1),sn=n}if(Z){const n=this.observers?this.observers.length:0;Z.sources?(Z.sources.push(this),Z.sourceSlots.push(n)):(Z.sources=[this],Z.sourceSlots=[n]),this.observers?(this.observers.push(Z),this.observerSlots.push(Z.sources.length-1)):(this.observers=[Z],this.observerSlots=[Z.sources.length-1])}return this.value}function Kr(n,t,e){let r=n.value;return(!n.comparator||!n.comparator(r,t))&&(n.value=t,n.observers&&n.observers.length&&ht(()=>{for(let i=0;i<n.observers.length;i+=1){const o=n.observers[i],s=ue&&ue.running;s&&ue.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?sn.push(o):Nn.push(o),o.observers&&Gr(o)),s||(o.state=Xn)}if(sn.length>1e6)throw sn=[],new Error},!1)),t}function vt(n){if(!n.fn)return;Qt(n);const t=Q,e=Z,r=Gt;Z=Q=n,$o(n,n.value,r),Z=e,Q=t}function $o(n,t,e){let r;try{r=n.fn(t)}catch(i){return n.pure&&(n.state=Xn,n.owned&&n.owned.forEach(Qt),n.owned=null),n.updatedAt=e+1,Qr(i)}(!n.updatedAt||n.updatedAt<=e)&&(n.updatedAt!=null&&"observers"in n?Kr(n,r):n.value=r,n.updatedAt=e)}function Re(n,t,e,r=Xn,i){const o={fn:n,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Q,context:null,pure:e};return Q===null||Q!==Wr&&(Q.owned?Q.owned.push(o):Q.owned=[o]),o}function Rt(n){if(n.state===0)return;if(n.state===Ft)return Nt(n);if(n.suspense&&Dn(n.suspense.inFallback))return n.suspense.effects.push(n);const t=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Gt);)n.state&&t.push(n);for(let e=t.length-1;e>=0;e--)if(n=t[e],n.state===Xn)vt(n);else if(n.state===Ft){const r=sn;sn=null,ht(()=>Nt(n,t[0]),!1),sn=r}}function ht(n,t){if(sn)return n();let e=!1;t||(sn=[]),Nn?e=!0:Nn=[],Gt++;try{const r=n();return Lo(e),r}catch(r){e||(Nn=null),sn=null,Qr(r)}}function Lo(n){if(sn&&(Yr(sn),sn=null),n)return;const t=Nn;Nn=null,t.length&&ht(()=>Vr(t),!1)}function Yr(n){for(let t=0;t<n.length;t++)Rt(n[t])}function Po(n){let t,e=0;for(t=0;t<n.length;t++){const r=n[t];r.user?n[e++]=r:Rt(r)}for(t=0;t<e;t++)Rt(n[t])}function Nt(n,t){n.state=0;for(let e=0;e<n.sources.length;e+=1){const r=n.sources[e];if(r.sources){const i=r.state;i===Xn?r!==t&&(!r.updatedAt||r.updatedAt<Gt)&&Rt(r):i===Ft&&Nt(r,t)}}}function Gr(n){for(let t=0;t<n.observers.length;t+=1){const e=n.observers[t];e.state||(e.state=Ft,e.pure?sn.push(e):Nn.push(e),e.observers&&Gr(e))}}function Qt(n){let t;if(n.sources)for(;n.sources.length;){const e=n.sources.pop(),r=n.sourceSlots.pop(),i=e.observers;if(i&&i.length){const o=i.pop(),s=e.observerSlots.pop();r<i.length&&(o.sourceSlots[s]=r,i[r]=o,e.observerSlots[r]=s)}}if(n.owned){for(t=n.owned.length-1;t>=0;t--)Qt(n.owned[t]);n.owned=null}if(n.cleanups){for(t=n.cleanups.length-1;t>=0;t--)n.cleanups[t]();n.cleanups=null}n.state=0,n.context=null}function Qr(n){throw n}function Ne(n,t){return n?n.context&&n.context[t]!==void 0?n.context[t]:Ne(n.owner,t):void 0}function we(n){if(typeof n=="function"&&!n.length)return we(n());if(Array.isArray(n)){const t=[];for(let e=0;e<n.length;e++){const r=we(n[e]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return n}function Fo(n,t){return function(r){let i;return Gn(()=>i=Dn(()=>(Q.context={[n]:r.value},Oo(()=>r.children))),void 0),i}}const hr=Symbol("fallback");function dr(n){for(let t=0;t<n.length;t++)n[t]()}function Ro(n,t,e={}){let r=[],i=[],o=[],s=[],u=0,c;return zt(()=>dr(o)),()=>{const a=n()||[];return a[me],Dn(()=>{if(a.length===0)return u!==0&&(dr(o),o=[],r=[],i=[],u=0,s=[]),e.fallback&&(r=[hr],i[0]=be(l=>(o[0]=l,e.fallback())),u=1),i;for(r[0]===hr&&(o[0](),o=[],r=[],i=[],u=0),c=0;c<a.length;c++)c<r.length&&r[c]!==a[c]?s[c](()=>a[c]):c>=r.length&&(i[c]=be(f));for(;c<r.length;c++)o[c]();return u=s.length=o.length=a.length,r=a.slice(0),i=i.slice(0,u)});function f(l){o[c]=l;const[g,h]=_n(a[c]);return s[c]=h,t(g,c)}}}let No=!1;function pn(n,t){return Dn(()=>n(t||{}))}const Do=n=>`Stale read from <${n}>.`;function Uo(n){const t="fallback"in n&&{fallback:()=>n.fallback};return yn(Ro(()=>n.each,n.children,t||void 0))}function Et(n){const t=n.keyed,e=yn(()=>n.when,void 0,{equals:(r,i)=>t?r===i:!r==!i});return yn(()=>{const r=e();if(r){const i=n.children;return typeof i=="function"&&i.length>0?Dn(()=>i(t?r:()=>{if(!Dn(e))throw Do("Show");return n.when})):i}return n.fallback},void 0,void 0)}function qo(n,t,e){let r=e.length,i=t.length,o=r,s=0,u=0,c=t[i-1].nextSibling,a=null;for(;s<i||u<o;){if(t[s]===e[u]){s++,u++;continue}for(;t[i-1]===e[o-1];)i--,o--;if(i===s){const f=o<r?u?e[u-1].nextSibling:e[o-u]:c;for(;u<o;)n.insertBefore(e[u++],f)}else if(o===u)for(;s<i;)(!a||!a.has(t[s]))&&t[s].remove(),s++;else if(t[s]===e[o-1]&&e[u]===t[i-1]){const f=t[--i].nextSibling;n.insertBefore(e[u++],t[s++].nextSibling),n.insertBefore(e[--o],f),t[i]=e[o]}else{if(!a){a=new Map;let l=u;for(;l<o;)a.set(e[l],l++)}const f=a.get(t[s]);if(f!=null)if(u<f&&f<o){let l=s,g=1,h;for(;++l<i&&l<o&&!((h=a.get(t[l]))==null||h!==f+g);)g++;if(g>f-u){const x=t[s];for(;u<f;)n.insertBefore(e[u++],x)}else n.replaceChild(e[u++],t[s++])}else s++;else t[s++].remove()}}}const gr="_$DX_DELEGATE";function un(n,t,e){let r;const i=()=>{const s=document.createElement("template");return s.innerHTML=n,e?s.content.firstChild.firstChild:s.content.firstChild},o=t?()=>Dn(()=>document.importNode(r||(r=i()),!0)):()=>(r||(r=i())).cloneNode(!0);return o.cloneNode=o,o}function Xr(n,t=window.document){const e=t[gr]||(t[gr]=new Set);for(let r=0,i=n.length;r<i;r++){const o=n[r];e.has(o)||(e.add(o),t.addEventListener(o,Ho))}}function ln(n,t,e){e==null?n.removeAttribute(t):n.setAttribute(t,e)}function H(n,t,e,r){if(e!==void 0&&!r&&(r=[]),typeof t!="function")return Dt(n,t,r,e);Gn(i=>Dt(n,t(),i,e),r)}function Ho(n){const t=`$$${n.type}`;let e=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==e&&Object.defineProperty(n,"target",{configurable:!0,value:e}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}});e;){const r=e[t];if(r&&!e.disabled){const i=e[`${t}Data`];if(i!==void 0?r.call(e,i,n):r.call(e,n),n.cancelBubble)return}e=e._$host||e.parentNode||e.host}}function Dt(n,t,e,r,i){for(;typeof e=="function";)e=e();if(t===e)return e;const o=typeof t,s=r!==void 0;if(n=s&&e[0]&&e[0].parentNode||n,o==="string"||o==="number")if(o==="number"&&(t=t.toString()),s){let u=e[0];u&&u.nodeType===3?u.data=t:u=document.createTextNode(t),e=ut(n,e,r,u)}else e!==""&&typeof e=="string"?e=n.firstChild.data=t:e=n.textContent=t;else if(t==null||o==="boolean")e=ut(n,e,r);else{if(o==="function")return Gn(()=>{let u=t();for(;typeof u=="function";)u=u();e=Dt(n,u,e,r)}),()=>e;if(Array.isArray(t)){const u=[],c=e&&Array.isArray(e);if(xe(u,t,e,i))return Gn(()=>e=Dt(n,u,e,r,!0)),()=>e;if(u.length===0){if(e=ut(n,e,r),s)return e}else c?e.length===0?pr(n,u,r):qo(n,e,u):(e&&ut(n),pr(n,u));e=u}else if(t.nodeType){if(Array.isArray(e)){if(s)return e=ut(n,e,r,t);ut(n,e,null,t)}else e==null||e===""||!n.firstChild?n.appendChild(t):n.replaceChild(t,n.firstChild);e=t}else console.warn("Unrecognized value. Skipped inserting",t)}return e}function xe(n,t,e,r){let i=!1;for(let o=0,s=t.length;o<s;o++){let u=t[o],c=e&&e[o],a;if(!(u==null||u===!0||u===!1))if((a=typeof u)=="object"&&u.nodeType)n.push(u);else if(Array.isArray(u))i=xe(n,u,c)||i;else if(a==="function")if(r){for(;typeof u=="function";)u=u();i=xe(n,Array.isArray(u)?u:[u],Array.isArray(c)?c:[c])||i}else n.push(u),i=!0;else{const f=String(u);c&&c.nodeType===3&&c.data===f?n.push(c):n.push(document.createTextNode(f))}}return i}function pr(n,t,e=null){for(let r=0,i=t.length;r<i;r++)n.insertBefore(t[r],e)}function ut(n,t,e,r){if(e===void 0)return n.textContent="";const i=r||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const u=t[s];if(i!==u){const c=u.parentNode===n;!o&&!s?c?n.replaceChild(i,u):n.insertBefore(i,e):c&&u.remove()}else o=!0}}else n.insertBefore(i,e);return[i]}var mr=(n,t)=>{let e;const r=()=>clearTimeout(e);return Bo()&&zt(r),Object.assign((...o)=>{e!==void 0&&r(),e=setTimeout(()=>n(...o),t)},{clear:r})};function br(n){let t=0,e=!1;const[r,i]=_n(void 0,{equals:!1}),o=n(()=>{e=!0,i()});return()=>(e||(o(),r()),e?(e=!!t,!0):(Fe()&&(t++,zt(()=>t--)),!1))}function Mo(n){return Object.keys(n).reduce((e,r)=>{const i=n[r];return e[r]=Object.assign({},i),ni(i.value)&&!Ko(i.value)&&!Array.isArray(i.value)&&(e[r].value=Object.assign({},i.value)),Array.isArray(i.value)&&(e[r].value=i.value.slice(0)),e},{})}function jo(n){return n?Object.keys(n).reduce((e,r)=>{const i=n[r];return e[r]=ni(i)&&"value"in i?i:{value:i},e[r].attribute||(e[r].attribute=Zo(r)),e[r].parse="parse"in e[r]?e[r].parse:typeof e[r].value!="string",e},{}):{}}function Vo(n){return Object.keys(n).reduce((e,r)=>(e[r]=n[r].value,e),{})}function Wo(n,t){const e=Mo(t);return Object.keys(t).forEach(i=>{const o=e[i],s=n.getAttribute(o.attribute),u=n[i];s&&(o.value=o.parse?Jr(s):s),u!=null&&(o.value=Array.isArray(u)?u.slice(0):u),o.reflect&&wr(n,o.attribute,o.value),Object.defineProperty(n,i,{get(){return o.value},set(c){const a=o.value;o.value=c,o.reflect&&wr(this,o.attribute,o.value);for(let f=0,l=this.__propertyChangedCallbacks.length;f<l;f++)this.__propertyChangedCallbacks[f](i,c,a)},enumerable:!0,configurable:!0})}),e}function Jr(n){if(n)try{return JSON.parse(n)}catch{return n}}function wr(n,t,e){if(e==null||e===!1)return n.removeAttribute(t);let r=JSON.stringify(e);n.__updating[t]=!0,r==="true"&&(r=""),n.setAttribute(t,r),Promise.resolve().then(()=>delete n.__updating[t])}function Zo(n){return n.replace(/\.?([A-Z]+)/g,(t,e)=>"-"+e.toLowerCase()).replace("_","-").replace(/^-/,"")}function ni(n){return n!=null&&(typeof n=="object"||typeof n=="function")}function Ko(n){return Object.prototype.toString.call(n)==="[object Function]"}function Yo(n){return typeof n=="function"&&n.toString().indexOf("class")===0}let le;function Go(n,t){const e=Object.keys(t);return class extends n{static get observedAttributes(){return e.map(i=>t[i].attribute)}constructor(){super(),this.__initialized=!1,this.__released=!1,this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props={}}connectedCallback(){if(this.__initialized)return;this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props=Wo(this,t);const i=Vo(this.props),o=this.Component,s=le;try{le=this,this.__initialized=!0,Yo(o)?new o(i,{element:this}):o(i,{element:this})}finally{le=s}}async disconnectedCallback(){if(await Promise.resolve(),this.isConnected)return;this.__propertyChangedCallbacks.length=0;let i=null;for(;i=this.__releaseCallbacks.pop();)i(this);delete this.__initialized,this.__released=!0}attributeChangedCallback(i,o,s){if(this.__initialized&&!this.__updating[i]&&(i=this.lookupProp(i),i in t)){if(s==null&&!this[i])return;this[i]=t[i].parse?Jr(s):s}}lookupProp(i){if(t)return e.find(o=>i===o||i===t[o].attribute)}get renderRoot(){return this.shadowRoot||this.attachShadow({mode:"open"})}addReleaseCallback(i){this.__releaseCallbacks.push(i)}addPropertyChangedCallback(i){this.__propertyChangedCallbacks.push(i)}}}function Qo(n,t={},e={}){const{BaseElement:r=HTMLElement,extension:i}=e;return o=>{if(!n)throw new Error("tag is required to register a Component");let s=customElements.get(n);return s?(s.prototype.Component=o,s):(s=Go(r,jo(t)),s.prototype.Component=o,s.prototype.registeredTag=n,customElements.define(n,s,i),s)}}function Xo(n){const t=Object.keys(n),e={};for(let r=0;r<t.length;r++){const[i,o]=_n(n[t[r]]);Object.defineProperty(e,t[r],{get:i,set(s){o(()=>s)}})}return e}function Jo(n){if(n.assignedSlot&&n.assignedSlot._$owner)return n.assignedSlot._$owner;let t=n.parentNode;for(;t&&!t._$owner&&!(t.assignedSlot&&t.assignedSlot._$owner);)t=t.parentNode;return t&&t.assignedSlot?t.assignedSlot._$owner:n._$owner}function ns(n){return(t,e)=>{const{element:r}=e;return be(i=>{const o=Xo(t);r.addPropertyChangedCallback((u,c)=>o[u]=c),r.addReleaseCallback(()=>{r.renderRoot.textContent="",i()});const s=n(o,e);return H(r.renderRoot,s)},Jo(r))}}function ts(n,t,e){return arguments.length===2&&(e=t,t={}),Qo(n,t)(ns(e))}const es=`:root {
  --ztr-font: -apple-system, "BlinkMacSystemFont", "Segoe UI", "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  --ztr-font-size: 16px;
  --ztr-text-color: #2B2B2B;
  --ztr-textarea-color: #2B2B2B;
  --ztr-icon-color: #656565;
  --ztr-link-color:  #92379c;
  --ztr-login-button-color: #92379c;
  --ztr-background-color: rgba(0, 0, 0, 0.03);
}

/****/

#ztr-root {
  font-family: var(--ztr-font);
  font-size: var(--ztr-font-size);
  color: var(--ztr-text-color);
  line-height: 19px;
  border: 1px solid transparent; /* Removes margin collapse */
}

#ztr-root {
  margin-top: 3rem;
}

#ztr-subtitle {
  font-size: 1.2rem;
  color: #666;
}

/* Comment */

.ztr-comment {
  position: relative;
  margin: 0rem;
  padding: 0rem;
  background-color: var(--ztr-background-color, rgba(0, 0, 0, 0.03));
}

.ztr-comment-text {
  line-break: loose;
  word-break: break-word;
  padding: 1rem;
}

.ztr-comment-text pre {
  white-space: pre-wrap;
  white-space: -moz-pre-wrap;
}

.ztr-comment:first-child {
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

.ztr-comment:last-child {
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}

.ztr-comment-info {
  display: flex;
  align-items: center;
}

.ztr-comment-info-picture {
  width: 4rem;
}

ul.ztr-comment-info-items {
  display: flex;
  align-items: center;
  list-style: none;
  margin: 0;
  padding: 0;
  font-size: 0.95rem;
}

ul.ztr-comment-info-items li {
  display: inline-block;
  text-align: center;
  cursor: default;
}

ul.ztr-comment-info-items li:not(:first-child)::before {
  padding: 0 0.2rem 0 0.35rem;
  content: " • ";
}

ul.ztr-comment-info-items li a {
  color: var(--ztr-link-color, #2B2B2B);
  text-decoration: none;
  font-weight: 600;
}

.ztr-comment-info-picture img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  padding: 0.5rem;
  position: relative;
  display: block;
  object-fit: cover;
}

.ztr-comment-body {
  margin-top: -1rem;
  padding-left: 4rem;
}

.ztr-comment-body a {
  color: var(--ztr-link-color, #2B2B2B);
}

.ztr-comment-replies {
  margin-left: 2em;
}

/* Styling the reply to comment form */

ul.ztr-comment-actions {
  display: flex;
  align-items: center;
  list-style: none;
  margin: 0;
  padding: 0;
  font-size: 0.9rem;
  font-weight: 600;
  user-select: none;
}

ul.ztr-comment-actions li {
  display: inline-flex;
  align-items: center;
  text-align: center;
  padding: 0 2rem 0 0;
  cursor: default;
}

ul.ztr-comment-actions li a {
  cursor: pointer;
  padding: 0 0.25rem 0 0;
}

ul.ztr-comment-actions li span {
  padding: 0;
}

.ztr-comment-actions svg {
  fill: var(--ztr-icon-color);
}

.ztr-comment-action-zap svg:hover {
  fill: #ffd53d;
  stroke: #b2ac68;
  stroke-width: 1px;
}

.ztr-comment-action-like svg:hover {
  fill: #e74c4c;
}

.ztr-comment-action-reply svg:hover {
  fill: #b65bf3;
}

.ztr-reply-form {
  padding-right: 0.5rem;
}

.ztr-reply-form textarea {
  font-family: var(--ztr-font);
  font-size: 16px;
  color: var(--ztr-textarea-color, #2B2B2B);
  line-height: 19px;

  background-color: #fdfdfd;
  border: 1px solid #BBB;
  outline: none;
  width: calc(100% - 1.5rem);
  padding: 0.7rem;
  margin: 0.5rem 0;
  height: 4rem;
  border-radius: 4px;
  resize: none;
}

.ztr-reply-form:disabled {
  opacity: 65%;
  user-select: none;
}

.ztr-reply-error {
  font-weight: bold;
  font-size: 0.85rem;
  margin-right: 1rem;
  user-select: none;
  cursor: default;
}

.ztr-reply-controls {
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

.ztr-reply-controls .ztr-comment-info-picture {
  width: 3rem;
}

.ztr-reply-controls .ztr-comment-info-picture img {
  width: 30px;
  height: 30px;
}

.ztr-reply-controls button {
  font-family: var(--ztr-font);
  appearance: none;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
}

.ztr-reply-login-button {
  margin-left: 1rem;
  background-color: var(--ztr-login-button-color);
  color: white;
}

.ztr-reply-button {
  color: var(--ztr-text-color);
  background-color: var(--ztr-background-color);
  display: flex;
  align-items: center;
}

.ztr-spinner {
  width: var(--ztr-font-size);
  height: var(--ztr-font-size);
  margin-right: 1rem;
  animation: rotate 4s linear infinite;
}

.ztr-reply-button:disabled {
  opacity: 65%;
  pointer-events: none;
  cursor: pointer;
  user-select: none;
}

.ztr-spinner .path {
  stroke: var(--ztr-text-color);
  stroke-linecap: round;
  animation: dash 1.5s ease-in-out infinite;
}

@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}

/* new */

.ztr-comment-new .ztr-reply-form {
  margin-top: 0.5rem;
}

.ztr-comment-new .ztr-comment-body {
  padding: 0;
}

.ztr-comment-new .ztr-comment-actions {
  font-size: 1.1rem;
}`,xr=document.createElement("i");function ti(n){const t="&"+n+";";xr.innerHTML=t;const e=xr.textContent;return e.charCodeAt(e.length-1)===59&&n!=="semi"||e===t?!1:e}function $n(n,t,e,r){const i=n.length;let o=0,s;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,e=e>0?e:0,r.length<1e4)s=Array.from(r),s.unshift(t,e),n.splice(...s);else for(e&&n.splice(t,e);o<r.length;)s=r.slice(o,o+1e4),s.unshift(t,0),n.splice(...s),o+=1e4,t+=1e4}function rn(n,t){return n.length>0?($n(n,n.length,0,t),n):t}const ye={}.hasOwnProperty;function rs(n){const t={};let e=-1;for(;++e<n.length;)is(t,n[e]);return t}function is(n,t){let e;for(e in t){const i=(ye.call(n,e)?n[e]:void 0)||(n[e]={}),o=t[e];let s;if(o)for(s in o){ye.call(i,s)||(i[s]=[]);const u=o[s];os(i[s],Array.isArray(u)?u:u?[u]:[])}}}function os(n,t){let e=-1;const r=[];for(;++e<t.length;)(t[e].add==="after"?n:r).push(t[e]);$n(n,0,0,r)}function ss(n){const t={};let e=-1;for(;++e<n.length;)us(t,n[e]);return t}function us(n,t){let e;for(e in t){const i=(ye.call(n,e)?n[e]:void 0)||(n[e]={}),o=t[e];let s;if(o)for(s in o)i[s]=o[s]}}function ls(n,t){const e=Number.parseInt(n,t);return e<9||e===11||e>13&&e<32||e>126&&e<160||e>55295&&e<57344||e>64975&&e<65008||(e&65535)===65535||(e&65535)===65534||e>1114111?"�":String.fromCharCode(e)}const as={'"':"quot","&":"amp","<":"lt",">":"gt"};function ei(n){return n.replace(/["&<>]/g,t);function t(e){return"&"+as[e]+";"}}function kt(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const cs=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,an=Jn(/[A-Za-z]/),on=Jn(/[\dA-Za-z]/),fs=Jn(/[#-'*+\--9=?A-Z^-~]/);function Ut(n){return n!==null&&(n<32||n===127)}const Ee=Jn(/\d/),hs=Jn(/[\dA-Fa-f]/),ds=Jn(/[!-/:-@[-`{-~]/);function P(n){return n!==null&&n<-2}function X(n){return n!==null&&(n<0||n===32)}function q(n){return n===-2||n===-1||n===32}const De=Jn(cs),lt=Jn(/\s/);function Jn(n){return t;function t(e){return e!==null&&n.test(String.fromCharCode(e))}}function wt(n,t){const e=ei(gs(n||""));if(!t)return e;const r=e.indexOf(":"),i=e.indexOf("?"),o=e.indexOf("#"),s=e.indexOf("/");return r<0||s>-1&&r>s||i>-1&&r>i||o>-1&&r>o||t.test(e.slice(0,r))?e:""}function gs(n){const t=[];let e=-1,r=0,i=0;for(;++e<n.length;){const o=n.charCodeAt(e);let s="";if(o===37&&on(n.charCodeAt(e+1))&&on(n.charCodeAt(e+2)))i=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(s=String.fromCharCode(o));else if(o>55295&&o<57344){const u=n.charCodeAt(e+1);o<56320&&u>56319&&u<57344?(s=String.fromCharCode(o,u),i=1):s="�"}else s=String.fromCharCode(o);s&&(t.push(n.slice(r,e),encodeURIComponent(s)),r=e+i+1,s=""),i&&(e+=i,i=0)}return t.join("")+n.slice(r)}const yr={}.hasOwnProperty,Er=/^(https?|ircs?|mailto|xmpp)$/i,ps=/^https?$/i;function ms(n){const t=n||{};let e=!0;const r={},i=[[]],o=[],s=[],c=ss([{enter:{blockQuote:U,codeFenced:R,codeFencedFenceInfo:k,codeFencedFenceMeta:k,codeIndented:j,codeText:bo,content:io,definition:wn,definitionDestinationString:Bt,definitionLabelString:k,definitionTitleString:k,emphasis:po,htmlFlow:go,htmlText:sr,image:b,label:k,link:Y,listItemMarker:L,listItemValue:N,listOrdered:A,listUnordered:I,paragraph:v,reference:k,resource:En,resourceDestinationString:hn,resourceTitleString:k,setextHeading:so,strong:mo},exit:{atxHeading:lo,atxHeadingSequence:oo,autolinkEmail:Ao,autolinkProtocol:So,blockQuote:S,characterEscapeValue:pt,characterReferenceMarkerHexadecimal:ur,characterReferenceMarkerNumeric:ur,characterReferenceValue:ko,codeFenced:V,codeFencedFence:p,codeFencedFenceInfo:D,codeFencedFenceMeta:d,codeFlowValue:ho,codeIndented:V,codeText:wo,codeTextData:pt,data:pt,definition:ro,definitionDestinationString:It,definitionLabelString:jn,definitionTitleString:eo,emphasis:xo,hardBreakEscape:ir,hardBreakTrailing:ir,htmlFlow:or,htmlFlowData:pt,htmlText:or,htmlTextData:pt,image:Pn,label:W,labelText:mn,lineEnding:fo,link:Pn,listOrdered:z,listUnordered:T,paragraph:O,reference:d,referenceString:fn,resource:d,resourceDestinationString:bn,resourceTitleString:st,setextHeading:co,setextHeadingLineSequence:ao,setextHeadingText:uo,strong:yo,thematicBreak:Eo}}].concat(t.htmlExtensions||[])),a={tightStack:s,definitions:r},f={lineEndingIfNeeded:C,options:t,encode:m,raw:E,tag:y,buffer:k,resume:d,setData:x,getData:w};let l=t.defaultLineEnding;return g;function g(B){let $=-1,dn=0;const An=[];let zn=[],Fn=[];for(;++$<B.length;)!l&&(B[$][1].type==="lineEnding"||B[$][1].type==="lineEndingBlank")&&(l=B[$][2].sliceSerialize(B[$][1])),(B[$][1].type==="listOrdered"||B[$][1].type==="listUnordered")&&(B[$][0]==="enter"?An.push($):h(B.slice(An.pop(),$))),B[$][1].type==="definition"&&(B[$][0]==="enter"?(Fn=rn(Fn,B.slice(dn,$)),dn=$):(zn=rn(zn,B.slice(dn,$+1)),dn=$+1));zn=rn(zn,Fn),zn=rn(zn,B.slice(dn)),$=-1;const vn=zn;for(c.enter.null&&c.enter.null.call(f);++$<B.length;){const lr=c[vn[$][0]],ar=vn[$][1].type,cr=lr[ar];yr.call(lr,ar)&&cr&&cr.call(Object.assign({sliceSerialize:vn[$][2].sliceSerialize},f),vn[$][1])}return c.exit.null&&c.exit.null.call(f),i[0].join("")}function h(B){const $=B.length;let dn=0,An=0,zn=!1,Fn;for(;++dn<$;){const vn=B[dn];if(vn[1]._container)Fn=void 0,vn[0]==="enter"?An++:An--;else switch(vn[1].type){case"listItemPrefix":{vn[0]==="exit"&&(Fn=!0);break}case"linePrefix":break;case"lineEndingBlank":{vn[0]==="enter"&&!An&&(Fn?Fn=void 0:zn=!0);break}default:Fn=void 0}}B[0][1]._loose=zn}function x(B,$){a[B]=$}function w(B){return a[B]}function k(){i.push([])}function d(){return i.pop().join("")}function y(B){e&&(x("lastWasTag",!0),i[i.length-1].push(B))}function E(B){x("lastWasTag"),i[i.length-1].push(B)}function _(){E(l||`
`)}function C(){const B=i[i.length-1],$=B[B.length-1],dn=$?$.charCodeAt($.length-1):null;dn===10||dn===13||dn===null||_()}function m(B){return w("ignoreEncode")?B:ei(B)}function A(B){s.push(!B._loose),C(),y("<ol"),x("expectFirstItem",!0)}function I(B){s.push(!B._loose),C(),y("<ul"),x("expectFirstItem",!0)}function N(B){if(w("expectFirstItem")){const $=Number.parseInt(this.sliceSerialize(B),10);$!==1&&y(' start="'+m(String($))+'"')}}function L(){w("expectFirstItem")?y(">"):F(),C(),y("<li>"),x("expectFirstItem"),x("lastWasTag")}function z(){F(),s.pop(),_(),y("</ol>")}function T(){F(),s.pop(),_(),y("</ul>")}function F(){w("lastWasTag")&&!w("slurpAllLineEndings")&&C(),y("</li>"),x("slurpAllLineEndings")}function U(){s.push(!1),C(),y("<blockquote>")}function S(){s.pop(),C(),y("</blockquote>"),x("slurpAllLineEndings")}function v(){s[s.length-1]||(C(),y("<p>")),x("slurpAllLineEndings")}function O(){s[s.length-1]?x("slurpAllLineEndings",!0):y("</p>")}function R(){C(),y("<pre><code"),x("fencesCount",0)}function D(){const B=d();y(' class="language-'+B+'"')}function p(){const B=w("fencesCount")||0;B||(y(">"),x("slurpOneLineEnding",!0)),x("fencesCount",B+1)}function j(){C(),y("<pre><code>")}function V(){const B=w("fencesCount");B!==void 0&&B<2&&a.tightStack.length>0&&!w("lastWasTag")&&_(),w("flowCodeSeenData")&&C(),y("</code></pre>"),B!==void 0&&B<2&&C(),x("flowCodeSeenData"),x("fencesCount"),x("slurpOneLineEnding")}function b(){o.push({image:!0}),e=void 0}function Y(){o.push({})}function mn(B){o[o.length-1].labelId=this.sliceSerialize(B)}function W(){o[o.length-1].label=d()}function fn(B){o[o.length-1].referenceId=this.sliceSerialize(B)}function En(){k(),o[o.length-1].destination=""}function hn(){k(),x("ignoreEncode",!0)}function bn(){o[o.length-1].destination=d(),x("ignoreEncode")}function st(){o[o.length-1].title=d()}function Pn(){let B=o.length-1;const $=o[B],dn=$.referenceId||$.labelId,An=$.destination===void 0?r[kt(dn)]:$;for(e=!0;B--;)if(o[B].image){e=void 0;break}$.image?(y('<img src="'+wt(An.destination,t.allowDangerousProtocol?void 0:ps)+'" alt="'),E($.label),y('"')):y('<a href="'+wt(An.destination,t.allowDangerousProtocol?void 0:Er)+'"'),y(An.title?' title="'+An.title+'"':""),$.image?y(" />"):(y(">"),E($.label),y("</a>")),o.pop()}function wn(){k(),o.push({})}function jn(B){d(),o[o.length-1].labelId=this.sliceSerialize(B)}function Bt(){k(),x("ignoreEncode",!0)}function It(){o[o.length-1].destination=d(),x("ignoreEncode")}function eo(){o[o.length-1].title=d()}function ro(){const B=o[o.length-1],$=kt(B.labelId);d(),yr.call(r,$)||(r[$]=o[o.length-1]),o.pop()}function io(){x("slurpAllLineEndings",!0)}function oo(B){w("headingRank")||(x("headingRank",this.sliceSerialize(B).length),C(),y("<h"+w("headingRank")+">"))}function so(){k(),x("slurpAllLineEndings")}function uo(){x("slurpAllLineEndings",!0)}function lo(){y("</h"+w("headingRank")+">"),x("headingRank")}function ao(B){x("headingRank",this.sliceSerialize(B).charCodeAt(0)===61?1:2)}function co(){const B=d();C(),y("<h"+w("headingRank")+">"),E(B),y("</h"+w("headingRank")+">"),x("slurpAllLineEndings"),x("headingRank")}function pt(B){E(m(this.sliceSerialize(B)))}function fo(B){if(!w("slurpAllLineEndings")){if(w("slurpOneLineEnding")){x("slurpOneLineEnding");return}if(w("inCodeText")){E(" ");return}E(m(this.sliceSerialize(B)))}}function ho(B){E(m(this.sliceSerialize(B))),x("flowCodeSeenData",!0)}function ir(){y("<br />")}function go(){C(),sr()}function or(){x("ignoreEncode")}function sr(){t.allowDangerousHtml&&x("ignoreEncode",!0)}function po(){y("<em>")}function mo(){y("<strong>")}function bo(){x("inCodeText",!0),y("<code>")}function wo(){x("inCodeText"),y("</code>")}function xo(){y("</em>")}function yo(){y("</strong>")}function Eo(){C(),y("<hr />")}function ur(B){x("characterReferenceType",B.type)}function ko(B){let $=this.sliceSerialize(B);$=w("characterReferenceType")?ls($,w("characterReferenceType")==="characterReferenceMarkerNumeric"?10:16):ti($),E(m($)),x("characterReferenceType")}function So(B){const $=this.sliceSerialize(B);y('<a href="'+wt($,t.allowDangerousProtocol?void 0:Er)+'">'),E(m($)),y("</a>")}function Ao(B){const $=this.sliceSerialize(B);y('<a href="'+wt("mailto:"+$)+'">'),E(m($)),y("</a>")}}function M(n,t,e,r){const i=r?r-1:Number.POSITIVE_INFINITY;let o=0;return s;function s(c){return q(c)?(n.enter(e),u(c)):t(c)}function u(c){return q(c)&&o++<i?(n.consume(c),u):(n.exit(e),t(c))}}const bs={tokenize:ws};function ws(n){const t=n.attempt(this.parser.constructs.contentInitial,r,i);let e;return t;function r(u){if(u===null){n.consume(u);return}return n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),M(n,t,"linePrefix")}function i(u){return n.enter("paragraph"),o(u)}function o(u){const c=n.enter("chunkText",{contentType:"text",previous:e});return e&&(e.next=c),e=c,s(u)}function s(u){if(u===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(u);return}return P(u)?(n.consume(u),n.exit("chunkText"),o):(n.consume(u),s)}}const xs={tokenize:ys},kr={tokenize:Es};function ys(n){const t=this,e=[];let r=0,i,o,s;return u;function u(E){if(r<e.length){const _=e[r];return t.containerState=_[1],n.attempt(_[0].continuation,c,a)(E)}return a(E)}function c(E){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&y();const _=t.events.length;let C=_,m;for(;C--;)if(t.events[C][0]==="exit"&&t.events[C][1].type==="chunkFlow"){m=t.events[C][1].end;break}d(r);let A=_;for(;A<t.events.length;)t.events[A][1].end=Object.assign({},m),A++;return $n(t.events,C+1,0,t.events.slice(_)),t.events.length=A,a(E)}return u(E)}function a(E){if(r===e.length){if(!i)return g(E);if(i.currentConstruct&&i.currentConstruct.concrete)return x(E);t.interrupt=Boolean(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},n.check(kr,f,l)(E)}function f(E){return i&&y(),d(r),g(E)}function l(E){return t.parser.lazy[t.now().line]=r!==e.length,s=t.now().offset,x(E)}function g(E){return t.containerState={},n.attempt(kr,h,x)(E)}function h(E){return r++,e.push([t.currentConstruct,t.containerState]),g(E)}function x(E){if(E===null){i&&y(),d(0),n.consume(E);return}return i=i||t.parser.flow(t.now()),n.enter("chunkFlow",{contentType:"flow",previous:o,_tokenizer:i}),w(E)}function w(E){if(E===null){k(n.exit("chunkFlow"),!0),d(0),n.consume(E);return}return P(E)?(n.consume(E),k(n.exit("chunkFlow")),r=0,t.interrupt=void 0,u):(n.consume(E),w)}function k(E,_){const C=t.sliceStream(E);if(_&&C.push(null),E.previous=o,o&&(o.next=E),o=E,i.defineSkip(E.start),i.write(C),t.parser.lazy[E.start.line]){let m=i.events.length;for(;m--;)if(i.events[m][1].start.offset<s&&(!i.events[m][1].end||i.events[m][1].end.offset>s))return;const A=t.events.length;let I=A,N,L;for(;I--;)if(t.events[I][0]==="exit"&&t.events[I][1].type==="chunkFlow"){if(N){L=t.events[I][1].end;break}N=!0}for(d(r),m=A;m<t.events.length;)t.events[m][1].end=Object.assign({},L),m++;$n(t.events,I+1,0,t.events.slice(A)),t.events.length=m}}function d(E){let _=e.length;for(;_-- >E;){const C=e[_];t.containerState=C[1],C[0].exit.call(t,n)}e.length=E}function y(){i.write([null]),o=void 0,i=void 0,t.containerState._closeFlow=void 0}}function Es(n,t,e){return M(n,n.attempt(this.parser.constructs.document,t,e),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Sr(n){if(n===null||X(n)||lt(n))return 1;if(De(n))return 2}function Ue(n,t,e){const r=[];let i=-1;for(;++i<n.length;){const o=n[i].resolveAll;o&&!r.includes(o)&&(t=o(t,e),r.push(o))}return t}const ke={name:"attention",tokenize:Ss,resolveAll:ks};function ks(n,t){let e=-1,r,i,o,s,u,c,a,f;for(;++e<n.length;)if(n[e][0]==="enter"&&n[e][1].type==="attentionSequence"&&n[e][1]._close){for(r=e;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&t.sliceSerialize(n[r][1]).charCodeAt(0)===t.sliceSerialize(n[e][1]).charCodeAt(0)){if((n[r][1]._close||n[e][1]._open)&&(n[e][1].end.offset-n[e][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[e][1].end.offset-n[e][1].start.offset)%3))continue;c=n[r][1].end.offset-n[r][1].start.offset>1&&n[e][1].end.offset-n[e][1].start.offset>1?2:1;const l=Object.assign({},n[r][1].end),g=Object.assign({},n[e][1].start);Ar(l,-c),Ar(g,c),s={type:c>1?"strongSequence":"emphasisSequence",start:l,end:Object.assign({},n[r][1].end)},u={type:c>1?"strongSequence":"emphasisSequence",start:Object.assign({},n[e][1].start),end:g},o={type:c>1?"strongText":"emphasisText",start:Object.assign({},n[r][1].end),end:Object.assign({},n[e][1].start)},i={type:c>1?"strong":"emphasis",start:Object.assign({},s.start),end:Object.assign({},u.end)},n[r][1].end=Object.assign({},s.start),n[e][1].start=Object.assign({},u.end),a=[],n[r][1].end.offset-n[r][1].start.offset&&(a=rn(a,[["enter",n[r][1],t],["exit",n[r][1],t]])),a=rn(a,[["enter",i,t],["enter",s,t],["exit",s,t],["enter",o,t]]),a=rn(a,Ue(t.parser.constructs.insideSpan.null,n.slice(r+1,e),t)),a=rn(a,[["exit",o,t],["enter",u,t],["exit",u,t],["exit",i,t]]),n[e][1].end.offset-n[e][1].start.offset?(f=2,a=rn(a,[["enter",n[e][1],t],["exit",n[e][1],t]])):f=0,$n(n,r-1,e-r+3,a),e=r+a.length-f-2;break}}for(e=-1;++e<n.length;)n[e][1].type==="attentionSequence"&&(n[e][1].type="data");return n}function Ss(n,t){const e=this.parser.constructs.attentionMarkers.null,r=this.previous,i=Sr(r);let o;return s;function s(c){return o=c,n.enter("attentionSequence"),u(c)}function u(c){if(c===o)return n.consume(c),u;const a=n.exit("attentionSequence"),f=Sr(c),l=!f||f===2&&i||e.includes(c),g=!i||i===2&&f||e.includes(r);return a._open=Boolean(o===42?l:l&&(i||!g)),a._close=Boolean(o===42?g:g&&(f||!l)),t(c)}}function Ar(n,t){n.column+=t,n.offset+=t,n._bufferIndex+=t}const As={name:"autolink",tokenize:Cs};function Cs(n,t,e){let r=0;return i;function i(h){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(h),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),o}function o(h){return an(h)?(n.consume(h),s):a(h)}function s(h){return h===43||h===45||h===46||on(h)?(r=1,u(h)):a(h)}function u(h){return h===58?(n.consume(h),r=0,c):(h===43||h===45||h===46||on(h))&&r++<32?(n.consume(h),u):(r=0,a(h))}function c(h){return h===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(h),n.exit("autolinkMarker"),n.exit("autolink"),t):h===null||h===32||h===60||Ut(h)?e(h):(n.consume(h),c)}function a(h){return h===64?(n.consume(h),f):fs(h)?(n.consume(h),a):e(h)}function f(h){return on(h)?l(h):e(h)}function l(h){return h===46?(n.consume(h),r=0,f):h===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(h),n.exit("autolinkMarker"),n.exit("autolink"),t):g(h)}function g(h){if((h===45||on(h))&&r++<63){const x=h===45?g:l;return n.consume(h),x}return e(h)}}const Xt={tokenize:_s,partial:!0};function _s(n,t,e){return r;function r(o){return q(o)?M(n,i,"linePrefix")(o):i(o)}function i(o){return o===null||P(o)?t(o):e(o)}}const ri={name:"blockQuote",tokenize:zs,continuation:{tokenize:vs},exit:Bs};function zs(n,t,e){const r=this;return i;function i(s){if(s===62){const u=r.containerState;return u.open||(n.enter("blockQuote",{_container:!0}),u.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(s),n.exit("blockQuoteMarker"),o}return e(s)}function o(s){return q(s)?(n.enter("blockQuotePrefixWhitespace"),n.consume(s),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),t):(n.exit("blockQuotePrefix"),t(s))}}function vs(n,t,e){const r=this;return i;function i(s){return q(s)?M(n,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):o(s)}function o(s){return n.attempt(ri,t,e)(s)}}function Bs(n){n.exit("blockQuote")}const ii={name:"characterEscape",tokenize:Is};function Is(n,t,e){return r;function r(o){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(o),n.exit("escapeMarker"),i}function i(o){return ds(o)?(n.enter("characterEscapeValue"),n.consume(o),n.exit("characterEscapeValue"),n.exit("characterEscape"),t):e(o)}}const oi={name:"characterReference",tokenize:Ts};function Ts(n,t,e){const r=this;let i=0,o,s;return u;function u(l){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(l),n.exit("characterReferenceMarker"),c}function c(l){return l===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(l),n.exit("characterReferenceMarkerNumeric"),a):(n.enter("characterReferenceValue"),o=31,s=on,f(l))}function a(l){return l===88||l===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(l),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),o=6,s=hs,f):(n.enter("characterReferenceValue"),o=7,s=Ee,f(l))}function f(l){if(l===59&&i){const g=n.exit("characterReferenceValue");return s===on&&!ti(r.sliceSerialize(g))?e(l):(n.enter("characterReferenceMarker"),n.consume(l),n.exit("characterReferenceMarker"),n.exit("characterReference"),t)}return s(l)&&i++<o?(n.consume(l),f):e(l)}}const Cr={tokenize:$s,partial:!0},_r={name:"codeFenced",tokenize:Os,concrete:!0};function Os(n,t,e){const r=this,i={tokenize:C,partial:!0};let o=0,s=0,u;return c;function c(m){return a(m)}function a(m){const A=r.events[r.events.length-1];return o=A&&A[1].type==="linePrefix"?A[2].sliceSerialize(A[1],!0).length:0,u=m,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),f(m)}function f(m){return m===u?(s++,n.consume(m),f):s<3?e(m):(n.exit("codeFencedFenceSequence"),q(m)?M(n,l,"whitespace")(m):l(m))}function l(m){return m===null||P(m)?(n.exit("codeFencedFence"),r.interrupt?t(m):n.check(Cr,w,_)(m)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),g(m))}function g(m){return m===null||P(m)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),l(m)):q(m)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),M(n,h,"whitespace")(m)):m===96&&m===u?e(m):(n.consume(m),g)}function h(m){return m===null||P(m)?l(m):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),x(m))}function x(m){return m===null||P(m)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),l(m)):m===96&&m===u?e(m):(n.consume(m),x)}function w(m){return n.attempt(i,_,k)(m)}function k(m){return n.enter("lineEnding"),n.consume(m),n.exit("lineEnding"),d}function d(m){return o>0&&q(m)?M(n,y,"linePrefix",o+1)(m):y(m)}function y(m){return m===null||P(m)?n.check(Cr,w,_)(m):(n.enter("codeFlowValue"),E(m))}function E(m){return m===null||P(m)?(n.exit("codeFlowValue"),y(m)):(n.consume(m),E)}function _(m){return n.exit("codeFenced"),t(m)}function C(m,A,I){let N=0;return L;function L(S){return m.enter("lineEnding"),m.consume(S),m.exit("lineEnding"),z}function z(S){return m.enter("codeFencedFence"),q(S)?M(m,T,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(S):T(S)}function T(S){return S===u?(m.enter("codeFencedFenceSequence"),F(S)):I(S)}function F(S){return S===u?(N++,m.consume(S),F):N>=s?(m.exit("codeFencedFenceSequence"),q(S)?M(m,U,"whitespace")(S):U(S)):I(S)}function U(S){return S===null||P(S)?(m.exit("codeFencedFence"),A(S)):I(S)}}}function $s(n,t,e){const r=this;return i;function i(s){return s===null?e(s):(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),o)}function o(s){return r.parser.lazy[r.now().line]?e(s):t(s)}}const ae={name:"codeIndented",tokenize:Ps},Ls={tokenize:Fs,partial:!0};function Ps(n,t,e){const r=this;return i;function i(a){return n.enter("codeIndented"),M(n,o,"linePrefix",4+1)(a)}function o(a){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?s(a):e(a)}function s(a){return a===null?c(a):P(a)?n.attempt(Ls,s,c)(a):(n.enter("codeFlowValue"),u(a))}function u(a){return a===null||P(a)?(n.exit("codeFlowValue"),s(a)):(n.consume(a),u)}function c(a){return n.exit("codeIndented"),t(a)}}function Fs(n,t,e){const r=this;return i;function i(s){return r.parser.lazy[r.now().line]?e(s):P(s)?(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),i):M(n,o,"linePrefix",4+1)(s)}function o(s){const u=r.events[r.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?t(s):P(s)?i(s):e(s)}}const Rs={name:"codeText",tokenize:Us,resolve:Ns,previous:Ds};function Ns(n){let t=n.length-4,e=3,r,i;if((n[e][1].type==="lineEnding"||n[e][1].type==="space")&&(n[t][1].type==="lineEnding"||n[t][1].type==="space")){for(r=e;++r<t;)if(n[r][1].type==="codeTextData"){n[e][1].type="codeTextPadding",n[t][1].type="codeTextPadding",e+=2,t-=2;break}}for(r=e-1,t++;++r<=t;)i===void 0?r!==t&&n[r][1].type!=="lineEnding"&&(i=r):(r===t||n[r][1].type==="lineEnding")&&(n[i][1].type="codeTextData",r!==i+2&&(n[i][1].end=n[r-1][1].end,n.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return n}function Ds(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Us(n,t,e){let r=0,i,o;return s;function s(l){return n.enter("codeText"),n.enter("codeTextSequence"),u(l)}function u(l){return l===96?(n.consume(l),r++,u):(n.exit("codeTextSequence"),c(l))}function c(l){return l===null?e(l):l===32?(n.enter("space"),n.consume(l),n.exit("space"),c):l===96?(o=n.enter("codeTextSequence"),i=0,f(l)):P(l)?(n.enter("lineEnding"),n.consume(l),n.exit("lineEnding"),c):(n.enter("codeTextData"),a(l))}function a(l){return l===null||l===32||l===96||P(l)?(n.exit("codeTextData"),c(l)):(n.consume(l),a)}function f(l){return l===96?(n.consume(l),i++,f):i===r?(n.exit("codeTextSequence"),n.exit("codeText"),t(l)):(o.type="codeTextData",a(l))}}function si(n){const t={};let e=-1,r,i,o,s,u,c,a;for(;++e<n.length;){for(;e in t;)e=t[e];if(r=n[e],e&&r[1].type==="chunkFlow"&&n[e-1][1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,o=0,o<c.length&&c[o][1].type==="lineEndingBlank"&&(o+=2),o<c.length&&c[o][1].type==="content"))for(;++o<c.length&&c[o][1].type!=="content";)c[o][1].type==="chunkText"&&(c[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,qs(n,e)),e=t[e],a=!0);else if(r[1]._container){for(o=e,i=void 0;o--&&(s=n[o],s[1].type==="lineEnding"||s[1].type==="lineEndingBlank");)s[0]==="enter"&&(i&&(n[i][1].type="lineEndingBlank"),s[1].type="lineEnding",i=o);i&&(r[1].end=Object.assign({},n[i][1].start),u=n.slice(i,e),u.unshift(r),$n(n,i,e-i+1,u))}}return!a}function qs(n,t){const e=n[t][1],r=n[t][2];let i=t-1;const o=[],s=e._tokenizer||r.parser[e.contentType](e.start),u=s.events,c=[],a={};let f,l,g=-1,h=e,x=0,w=0;const k=[w];for(;h;){for(;n[++i][1]!==h;);o.push(i),h._tokenizer||(f=r.sliceStream(h),h.next||f.push(null),l&&s.defineSkip(h.start),h._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(f),h._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),l=h,h=h.next}for(h=e;++g<u.length;)u[g][0]==="exit"&&u[g-1][0]==="enter"&&u[g][1].type===u[g-1][1].type&&u[g][1].start.line!==u[g][1].end.line&&(w=g+1,k.push(w),h._tokenizer=void 0,h.previous=void 0,h=h.next);for(s.events=[],h?(h._tokenizer=void 0,h.previous=void 0):k.pop(),g=k.length;g--;){const d=u.slice(k[g],k[g+1]),y=o.pop();c.unshift([y,y+d.length-1]),$n(n,y,2,d)}for(g=-1;++g<c.length;)a[x+c[g][0]]=x+c[g][1],x+=c[g][1]-c[g][0]-1;return a}const Hs={tokenize:Vs,resolve:js},Ms={tokenize:Ws,partial:!0};function js(n){return si(n),n}function Vs(n,t){let e;return r;function r(u){return n.enter("content"),e=n.enter("chunkContent",{contentType:"content"}),i(u)}function i(u){return u===null?o(u):P(u)?n.check(Ms,s,o)(u):(n.consume(u),i)}function o(u){return n.exit("chunkContent"),n.exit("content"),t(u)}function s(u){return n.consume(u),n.exit("chunkContent"),e.next=n.enter("chunkContent",{contentType:"content",previous:e}),e=e.next,i}}function Ws(n,t,e){const r=this;return i;function i(s){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),M(n,o,"linePrefix")}function o(s){if(s===null||P(s))return e(s);const u=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?t(s):n.interrupt(r.parser.constructs.flow,e,t)(s)}}function ui(n,t,e,r,i,o,s,u,c){const a=c||Number.POSITIVE_INFINITY;let f=0;return l;function l(d){return d===60?(n.enter(r),n.enter(i),n.enter(o),n.consume(d),n.exit(o),g):d===null||d===32||d===41||Ut(d)?e(d):(n.enter(r),n.enter(s),n.enter(u),n.enter("chunkString",{contentType:"string"}),w(d))}function g(d){return d===62?(n.enter(o),n.consume(d),n.exit(o),n.exit(i),n.exit(r),t):(n.enter(u),n.enter("chunkString",{contentType:"string"}),h(d))}function h(d){return d===62?(n.exit("chunkString"),n.exit(u),g(d)):d===null||d===60||P(d)?e(d):(n.consume(d),d===92?x:h)}function x(d){return d===60||d===62||d===92?(n.consume(d),h):h(d)}function w(d){return!f&&(d===null||d===41||X(d))?(n.exit("chunkString"),n.exit(u),n.exit(s),n.exit(r),t(d)):f<a&&d===40?(n.consume(d),f++,w):d===41?(n.consume(d),f--,w):d===null||d===32||d===40||Ut(d)?e(d):(n.consume(d),d===92?k:w)}function k(d){return d===40||d===41||d===92?(n.consume(d),w):w(d)}}function li(n,t,e,r,i,o){const s=this;let u=0,c;return a;function a(h){return n.enter(r),n.enter(i),n.consume(h),n.exit(i),n.enter(o),f}function f(h){return u>999||h===null||h===91||h===93&&!c||h===94&&!u&&"_hiddenFootnoteSupport"in s.parser.constructs?e(h):h===93?(n.exit(o),n.enter(i),n.consume(h),n.exit(i),n.exit(r),t):P(h)?(n.enter("lineEnding"),n.consume(h),n.exit("lineEnding"),f):(n.enter("chunkString",{contentType:"string"}),l(h))}function l(h){return h===null||h===91||h===93||P(h)||u++>999?(n.exit("chunkString"),f(h)):(n.consume(h),c||(c=!q(h)),h===92?g:l)}function g(h){return h===91||h===92||h===93?(n.consume(h),u++,l):l(h)}}function ai(n,t,e,r,i,o){let s;return u;function u(g){return g===34||g===39||g===40?(n.enter(r),n.enter(i),n.consume(g),n.exit(i),s=g===40?41:g,c):e(g)}function c(g){return g===s?(n.enter(i),n.consume(g),n.exit(i),n.exit(r),t):(n.enter(o),a(g))}function a(g){return g===s?(n.exit(o),c(s)):g===null?e(g):P(g)?(n.enter("lineEnding"),n.consume(g),n.exit("lineEnding"),M(n,a,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),f(g))}function f(g){return g===s||g===null||P(g)?(n.exit("chunkString"),a(g)):(n.consume(g),g===92?l:f)}function l(g){return g===s||g===92?(n.consume(g),f):f(g)}}function xt(n,t){let e;return r;function r(i){return P(i)?(n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),e=!0,r):q(i)?M(n,r,e?"linePrefix":"lineSuffix")(i):t(i)}}const Zs={name:"definition",tokenize:Ys},Ks={tokenize:Gs,partial:!0};function Ys(n,t,e){const r=this;let i;return o;function o(h){return n.enter("definition"),s(h)}function s(h){return li.call(r,n,u,e,"definitionLabel","definitionLabelMarker","definitionLabelString")(h)}function u(h){return i=kt(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),h===58?(n.enter("definitionMarker"),n.consume(h),n.exit("definitionMarker"),c):e(h)}function c(h){return X(h)?xt(n,a)(h):a(h)}function a(h){return ui(n,f,e,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(h)}function f(h){return n.attempt(Ks,l,l)(h)}function l(h){return q(h)?M(n,g,"whitespace")(h):g(h)}function g(h){return h===null||P(h)?(n.exit("definition"),r.parser.defined.push(i),t(h)):e(h)}}function Gs(n,t,e){return r;function r(u){return X(u)?xt(n,i)(u):e(u)}function i(u){return ai(n,o,e,"definitionTitle","definitionTitleMarker","definitionTitleString")(u)}function o(u){return q(u)?M(n,s,"whitespace")(u):s(u)}function s(u){return u===null||P(u)?t(u):e(u)}}const Qs={name:"hardBreakEscape",tokenize:Xs};function Xs(n,t,e){return r;function r(o){return n.enter("hardBreakEscape"),n.consume(o),i}function i(o){return P(o)?(n.exit("hardBreakEscape"),t(o)):e(o)}}const Js={name:"headingAtx",tokenize:tu,resolve:nu};function nu(n,t){let e=n.length-2,r=3,i,o;return n[r][1].type==="whitespace"&&(r+=2),e-2>r&&n[e][1].type==="whitespace"&&(e-=2),n[e][1].type==="atxHeadingSequence"&&(r===e-1||e-4>r&&n[e-2][1].type==="whitespace")&&(e-=r+1===e?2:4),e>r&&(i={type:"atxHeadingText",start:n[r][1].start,end:n[e][1].end},o={type:"chunkText",start:n[r][1].start,end:n[e][1].end,contentType:"text"},$n(n,r,e-r+1,[["enter",i,t],["enter",o,t],["exit",o,t],["exit",i,t]])),n}function tu(n,t,e){let r=0;return i;function i(f){return n.enter("atxHeading"),o(f)}function o(f){return n.enter("atxHeadingSequence"),s(f)}function s(f){return f===35&&r++<6?(n.consume(f),s):f===null||X(f)?(n.exit("atxHeadingSequence"),u(f)):e(f)}function u(f){return f===35?(n.enter("atxHeadingSequence"),c(f)):f===null||P(f)?(n.exit("atxHeading"),t(f)):q(f)?M(n,u,"whitespace")(f):(n.enter("atxHeadingText"),a(f))}function c(f){return f===35?(n.consume(f),c):(n.exit("atxHeadingSequence"),u(f))}function a(f){return f===null||f===35||X(f)?(n.exit("atxHeadingText"),u(f)):(n.consume(f),a)}}const eu=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],zr=["pre","script","style","textarea"],ru={name:"htmlFlow",tokenize:uu,resolveTo:su,concrete:!0},iu={tokenize:au,partial:!0},ou={tokenize:lu,partial:!0};function su(n){let t=n.length;for(;t--&&!(n[t][0]==="enter"&&n[t][1].type==="htmlFlow"););return t>1&&n[t-2][1].type==="linePrefix"&&(n[t][1].start=n[t-2][1].start,n[t+1][1].start=n[t-2][1].start,n.splice(t-2,2)),n}function uu(n,t,e){const r=this;let i,o,s,u,c;return a;function a(b){return f(b)}function f(b){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(b),l}function l(b){return b===33?(n.consume(b),g):b===47?(n.consume(b),o=!0,w):b===63?(n.consume(b),i=3,r.interrupt?t:p):an(b)?(n.consume(b),s=String.fromCharCode(b),k):e(b)}function g(b){return b===45?(n.consume(b),i=2,h):b===91?(n.consume(b),i=5,u=0,x):an(b)?(n.consume(b),i=4,r.interrupt?t:p):e(b)}function h(b){return b===45?(n.consume(b),r.interrupt?t:p):e(b)}function x(b){const Y="CDATA[";return b===Y.charCodeAt(u++)?(n.consume(b),u===Y.length?r.interrupt?t:T:x):e(b)}function w(b){return an(b)?(n.consume(b),s=String.fromCharCode(b),k):e(b)}function k(b){if(b===null||b===47||b===62||X(b)){const Y=b===47,mn=s.toLowerCase();return!Y&&!o&&zr.includes(mn)?(i=1,r.interrupt?t(b):T(b)):eu.includes(s.toLowerCase())?(i=6,Y?(n.consume(b),d):r.interrupt?t(b):T(b)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?e(b):o?y(b):E(b))}return b===45||on(b)?(n.consume(b),s+=String.fromCharCode(b),k):e(b)}function d(b){return b===62?(n.consume(b),r.interrupt?t:T):e(b)}function y(b){return q(b)?(n.consume(b),y):L(b)}function E(b){return b===47?(n.consume(b),L):b===58||b===95||an(b)?(n.consume(b),_):q(b)?(n.consume(b),E):L(b)}function _(b){return b===45||b===46||b===58||b===95||on(b)?(n.consume(b),_):C(b)}function C(b){return b===61?(n.consume(b),m):q(b)?(n.consume(b),C):E(b)}function m(b){return b===null||b===60||b===61||b===62||b===96?e(b):b===34||b===39?(n.consume(b),c=b,A):q(b)?(n.consume(b),m):I(b)}function A(b){return b===c?(n.consume(b),c=null,N):b===null||P(b)?e(b):(n.consume(b),A)}function I(b){return b===null||b===34||b===39||b===47||b===60||b===61||b===62||b===96||X(b)?C(b):(n.consume(b),I)}function N(b){return b===47||b===62||q(b)?E(b):e(b)}function L(b){return b===62?(n.consume(b),z):e(b)}function z(b){return b===null||P(b)?T(b):q(b)?(n.consume(b),z):e(b)}function T(b){return b===45&&i===2?(n.consume(b),v):b===60&&i===1?(n.consume(b),O):b===62&&i===4?(n.consume(b),j):b===63&&i===3?(n.consume(b),p):b===93&&i===5?(n.consume(b),D):P(b)&&(i===6||i===7)?(n.exit("htmlFlowData"),n.check(iu,V,F)(b)):b===null||P(b)?(n.exit("htmlFlowData"),F(b)):(n.consume(b),T)}function F(b){return n.check(ou,U,V)(b)}function U(b){return n.enter("lineEnding"),n.consume(b),n.exit("lineEnding"),S}function S(b){return b===null||P(b)?F(b):(n.enter("htmlFlowData"),T(b))}function v(b){return b===45?(n.consume(b),p):T(b)}function O(b){return b===47?(n.consume(b),s="",R):T(b)}function R(b){if(b===62){const Y=s.toLowerCase();return zr.includes(Y)?(n.consume(b),j):T(b)}return an(b)&&s.length<8?(n.consume(b),s+=String.fromCharCode(b),R):T(b)}function D(b){return b===93?(n.consume(b),p):T(b)}function p(b){return b===62?(n.consume(b),j):b===45&&i===2?(n.consume(b),p):T(b)}function j(b){return b===null||P(b)?(n.exit("htmlFlowData"),V(b)):(n.consume(b),j)}function V(b){return n.exit("htmlFlow"),t(b)}}function lu(n,t,e){const r=this;return i;function i(s){return P(s)?(n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),o):e(s)}function o(s){return r.parser.lazy[r.now().line]?e(s):t(s)}}function au(n,t,e){return r;function r(i){return n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),n.attempt(Xt,t,e)}}const cu={name:"htmlText",tokenize:fu};function fu(n,t,e){const r=this;let i,o,s;return u;function u(p){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(p),c}function c(p){return p===33?(n.consume(p),a):p===47?(n.consume(p),C):p===63?(n.consume(p),E):an(p)?(n.consume(p),I):e(p)}function a(p){return p===45?(n.consume(p),f):p===91?(n.consume(p),o=0,x):an(p)?(n.consume(p),y):e(p)}function f(p){return p===45?(n.consume(p),h):e(p)}function l(p){return p===null?e(p):p===45?(n.consume(p),g):P(p)?(s=l,O(p)):(n.consume(p),l)}function g(p){return p===45?(n.consume(p),h):l(p)}function h(p){return p===62?v(p):p===45?g(p):l(p)}function x(p){const j="CDATA[";return p===j.charCodeAt(o++)?(n.consume(p),o===j.length?w:x):e(p)}function w(p){return p===null?e(p):p===93?(n.consume(p),k):P(p)?(s=w,O(p)):(n.consume(p),w)}function k(p){return p===93?(n.consume(p),d):w(p)}function d(p){return p===62?v(p):p===93?(n.consume(p),d):w(p)}function y(p){return p===null||p===62?v(p):P(p)?(s=y,O(p)):(n.consume(p),y)}function E(p){return p===null?e(p):p===63?(n.consume(p),_):P(p)?(s=E,O(p)):(n.consume(p),E)}function _(p){return p===62?v(p):E(p)}function C(p){return an(p)?(n.consume(p),m):e(p)}function m(p){return p===45||on(p)?(n.consume(p),m):A(p)}function A(p){return P(p)?(s=A,O(p)):q(p)?(n.consume(p),A):v(p)}function I(p){return p===45||on(p)?(n.consume(p),I):p===47||p===62||X(p)?N(p):e(p)}function N(p){return p===47?(n.consume(p),v):p===58||p===95||an(p)?(n.consume(p),L):P(p)?(s=N,O(p)):q(p)?(n.consume(p),N):v(p)}function L(p){return p===45||p===46||p===58||p===95||on(p)?(n.consume(p),L):z(p)}function z(p){return p===61?(n.consume(p),T):P(p)?(s=z,O(p)):q(p)?(n.consume(p),z):N(p)}function T(p){return p===null||p===60||p===61||p===62||p===96?e(p):p===34||p===39?(n.consume(p),i=p,F):P(p)?(s=T,O(p)):q(p)?(n.consume(p),T):(n.consume(p),U)}function F(p){return p===i?(n.consume(p),i=void 0,S):p===null?e(p):P(p)?(s=F,O(p)):(n.consume(p),F)}function U(p){return p===null||p===34||p===39||p===60||p===61||p===96?e(p):p===47||p===62||X(p)?N(p):(n.consume(p),U)}function S(p){return p===47||p===62||X(p)?N(p):e(p)}function v(p){return p===62?(n.consume(p),n.exit("htmlTextData"),n.exit("htmlText"),t):e(p)}function O(p){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(p),n.exit("lineEnding"),R}function R(p){return q(p)?M(n,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(p):D(p)}function D(p){return n.enter("htmlTextData"),s(p)}}const qe={name:"labelEnd",tokenize:bu,resolveTo:mu,resolveAll:pu},hu={tokenize:wu},du={tokenize:xu},gu={tokenize:yu};function pu(n){let t=-1;for(;++t<n.length;){const e=n[t][1];(e.type==="labelImage"||e.type==="labelLink"||e.type==="labelEnd")&&(n.splice(t+1,e.type==="labelImage"?4:2),e.type="data",t++)}return n}function mu(n,t){let e=n.length,r=0,i,o,s,u;for(;e--;)if(i=n[e][1],o){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;n[e][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(s){if(n[e][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(o=e,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(s=e);const c={type:n[o][1].type==="labelLink"?"link":"image",start:Object.assign({},n[o][1].start),end:Object.assign({},n[n.length-1][1].end)},a={type:"label",start:Object.assign({},n[o][1].start),end:Object.assign({},n[s][1].end)},f={type:"labelText",start:Object.assign({},n[o+r+2][1].end),end:Object.assign({},n[s-2][1].start)};return u=[["enter",c,t],["enter",a,t]],u=rn(u,n.slice(o+1,o+r+3)),u=rn(u,[["enter",f,t]]),u=rn(u,Ue(t.parser.constructs.insideSpan.null,n.slice(o+r+4,s-3),t)),u=rn(u,[["exit",f,t],n[s-2],n[s-1],["exit",a,t]]),u=rn(u,n.slice(s+1)),u=rn(u,[["exit",c,t]]),$n(n,o,n.length,u),n}function bu(n,t,e){const r=this;let i=r.events.length,o,s;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){o=r.events[i][1];break}return u;function u(g){return o?o._inactive?l(g):(s=r.parser.defined.includes(kt(r.sliceSerialize({start:o.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(g),n.exit("labelMarker"),n.exit("labelEnd"),c):e(g)}function c(g){return g===40?n.attempt(hu,f,s?f:l)(g):g===91?n.attempt(du,f,s?a:l)(g):s?f(g):l(g)}function a(g){return n.attempt(gu,f,l)(g)}function f(g){return t(g)}function l(g){return o._balanced=!0,e(g)}}function wu(n,t,e){return r;function r(l){return n.enter("resource"),n.enter("resourceMarker"),n.consume(l),n.exit("resourceMarker"),i}function i(l){return X(l)?xt(n,o)(l):o(l)}function o(l){return l===41?f(l):ui(n,s,u,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(l)}function s(l){return X(l)?xt(n,c)(l):f(l)}function u(l){return e(l)}function c(l){return l===34||l===39||l===40?ai(n,a,e,"resourceTitle","resourceTitleMarker","resourceTitleString")(l):f(l)}function a(l){return X(l)?xt(n,f)(l):f(l)}function f(l){return l===41?(n.enter("resourceMarker"),n.consume(l),n.exit("resourceMarker"),n.exit("resource"),t):e(l)}}function xu(n,t,e){const r=this;return i;function i(u){return li.call(r,n,o,s,"reference","referenceMarker","referenceString")(u)}function o(u){return r.parser.defined.includes(kt(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(u):e(u)}function s(u){return e(u)}}function yu(n,t,e){return r;function r(o){return n.enter("reference"),n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),i}function i(o){return o===93?(n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),n.exit("reference"),t):e(o)}}const Eu={name:"labelStartImage",tokenize:ku,resolveAll:qe.resolveAll};function ku(n,t,e){const r=this;return i;function i(u){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(u),n.exit("labelImageMarker"),o}function o(u){return u===91?(n.enter("labelMarker"),n.consume(u),n.exit("labelMarker"),n.exit("labelImage"),s):e(u)}function s(u){return u===94&&"_hiddenFootnoteSupport"in r.parser.constructs?e(u):t(u)}}const Su={name:"labelStartLink",tokenize:Au,resolveAll:qe.resolveAll};function Au(n,t,e){const r=this;return i;function i(s){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(s),n.exit("labelMarker"),n.exit("labelLink"),o}function o(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?e(s):t(s)}}const ce={name:"lineEnding",tokenize:Cu};function Cu(n,t){return e;function e(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),M(n,t,"linePrefix")}}const $t={name:"thematicBreak",tokenize:_u};function _u(n,t,e){let r=0,i;return o;function o(a){return n.enter("thematicBreak"),s(a)}function s(a){return i=a,u(a)}function u(a){return a===i?(n.enter("thematicBreakSequence"),c(a)):r>=3&&(a===null||P(a))?(n.exit("thematicBreak"),t(a)):e(a)}function c(a){return a===i?(n.consume(a),r++,c):(n.exit("thematicBreakSequence"),q(a)?M(n,u,"whitespace")(a):u(a))}}const gn={name:"list",tokenize:Bu,continuation:{tokenize:Iu},exit:Ou},zu={tokenize:$u,partial:!0},vu={tokenize:Tu,partial:!0};function Bu(n,t,e){const r=this,i=r.events[r.events.length-1];let o=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,s=0;return u;function u(h){const x=r.containerState.type||(h===42||h===43||h===45?"listUnordered":"listOrdered");if(x==="listUnordered"?!r.containerState.marker||h===r.containerState.marker:Ee(h)){if(r.containerState.type||(r.containerState.type=x,n.enter(x,{_container:!0})),x==="listUnordered")return n.enter("listItemPrefix"),h===42||h===45?n.check($t,e,a)(h):a(h);if(!r.interrupt||h===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),c(h)}return e(h)}function c(h){return Ee(h)&&++s<10?(n.consume(h),c):(!r.interrupt||s<2)&&(r.containerState.marker?h===r.containerState.marker:h===41||h===46)?(n.exit("listItemValue"),a(h)):e(h)}function a(h){return n.enter("listItemMarker"),n.consume(h),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||h,n.check(Xt,r.interrupt?e:f,n.attempt(zu,g,l))}function f(h){return r.containerState.initialBlankLine=!0,o++,g(h)}function l(h){return q(h)?(n.enter("listItemPrefixWhitespace"),n.consume(h),n.exit("listItemPrefixWhitespace"),g):e(h)}function g(h){return r.containerState.size=o+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,t(h)}}function Iu(n,t,e){const r=this;return r.containerState._closeFlow=void 0,n.check(Xt,i,o);function i(u){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,M(n,t,"listItemIndent",r.containerState.size+1)(u)}function o(u){return r.containerState.furtherBlankLines||!q(u)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,s(u)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(vu,t,s)(u))}function s(u){return r.containerState._closeFlow=!0,r.interrupt=void 0,M(n,n.attempt(gn,t,e),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u)}}function Tu(n,t,e){const r=this;return M(n,i,"listItemIndent",r.containerState.size+1);function i(o){const s=r.events[r.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===r.containerState.size?t(o):e(o)}}function Ou(n){n.exit(this.containerState.type)}function $u(n,t,e){const r=this;return M(n,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function i(o){const s=r.events[r.events.length-1];return!q(o)&&s&&s[1].type==="listItemPrefixWhitespace"?t(o):e(o)}}const vr={name:"setextUnderline",tokenize:Pu,resolveTo:Lu};function Lu(n,t){let e=n.length,r,i,o;for(;e--;)if(n[e][0]==="enter"){if(n[e][1].type==="content"){r=e;break}n[e][1].type==="paragraph"&&(i=e)}else n[e][1].type==="content"&&n.splice(e,1),!o&&n[e][1].type==="definition"&&(o=e);const s={type:"setextHeading",start:Object.assign({},n[i][1].start),end:Object.assign({},n[n.length-1][1].end)};return n[i][1].type="setextHeadingText",o?(n.splice(i,0,["enter",s,t]),n.splice(o+1,0,["exit",n[r][1],t]),n[r][1].end=Object.assign({},n[o][1].end)):n[r][1]=s,n.push(["exit",s,t]),n}function Pu(n,t,e){const r=this;let i;return o;function o(a){let f=r.events.length,l;for(;f--;)if(r.events[f][1].type!=="lineEnding"&&r.events[f][1].type!=="linePrefix"&&r.events[f][1].type!=="content"){l=r.events[f][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||l)?(n.enter("setextHeadingLine"),i=a,s(a)):e(a)}function s(a){return n.enter("setextHeadingLineSequence"),u(a)}function u(a){return a===i?(n.consume(a),u):(n.exit("setextHeadingLineSequence"),q(a)?M(n,c,"lineSuffix")(a):c(a))}function c(a){return a===null||P(a)?(n.exit("setextHeadingLine"),t(a)):e(a)}}const Fu={tokenize:Ru};function Ru(n){const t=this,e=n.attempt(Xt,r,n.attempt(this.parser.constructs.flowInitial,i,M(n,n.attempt(this.parser.constructs.flow,i,n.attempt(Hs,i)),"linePrefix")));return e;function r(o){if(o===null){n.consume(o);return}return n.enter("lineEndingBlank"),n.consume(o),n.exit("lineEndingBlank"),t.currentConstruct=void 0,e}function i(o){if(o===null){n.consume(o);return}return n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),t.currentConstruct=void 0,e}}const Nu={resolveAll:fi()},Du=ci("string"),Uu=ci("text");function ci(n){return{tokenize:t,resolveAll:fi(n==="text"?qu:void 0)};function t(e){const r=this,i=this.parser.constructs[n],o=e.attempt(i,s,u);return s;function s(f){return a(f)?o(f):u(f)}function u(f){if(f===null){e.consume(f);return}return e.enter("data"),e.consume(f),c}function c(f){return a(f)?(e.exit("data"),o(f)):(e.consume(f),c)}function a(f){if(f===null)return!0;const l=i[f];let g=-1;if(l)for(;++g<l.length;){const h=l[g];if(!h.previous||h.previous.call(r,r.previous))return!0}return!1}}}function fi(n){return t;function t(e,r){let i=-1,o;for(;++i<=e.length;)o===void 0?e[i]&&e[i][1].type==="data"&&(o=i,i++):(!e[i]||e[i][1].type!=="data")&&(i!==o+2&&(e[o][1].end=e[i-1][1].end,e.splice(o+2,i-o-2),i=o+2),o=void 0);return n?n(e,r):e}}function qu(n,t){let e=0;for(;++e<=n.length;)if((e===n.length||n[e][1].type==="lineEnding")&&n[e-1][1].type==="data"){const r=n[e-1][1],i=t.sliceStream(r);let o=i.length,s=-1,u=0,c;for(;o--;){const a=i[o];if(typeof a=="string"){for(s=a.length;a.charCodeAt(s-1)===32;)u++,s--;if(s)break;s=-1}else if(a===-2)c=!0,u++;else if(a!==-1){o++;break}}if(u){const a={type:e===n.length||c||u<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-u,offset:r.end.offset-u,_index:r.start._index+o,_bufferIndex:o?s:r.start._bufferIndex+s},end:Object.assign({},r.end)};r.end=Object.assign({},a.start),r.start.offset===r.end.offset?Object.assign(r,a):(n.splice(e,0,["enter",a,t],["exit",a,t]),e+=2)}e++}return n}function Hu(n,t,e){let r=Object.assign(e?Object.assign({},e):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const i={},o=[];let s=[],u=[];const c={consume:y,enter:E,exit:_,attempt:A(C),check:A(m),interrupt:A(m,{interrupt:!0})},a={previous:null,code:null,containerState:{},events:[],parser:n,sliceStream:h,sliceSerialize:g,now:x,defineSkip:w,write:l};let f=t.tokenize.call(a,c);return t.resolveAll&&o.push(t),a;function l(z){return s=rn(s,z),k(),s[s.length-1]!==null?[]:(I(t,0),a.events=Ue(o,a.events,a),a.events)}function g(z,T){return ju(h(z),T)}function h(z){return Mu(s,z)}function x(){const{line:z,column:T,offset:F,_index:U,_bufferIndex:S}=r;return{line:z,column:T,offset:F,_index:U,_bufferIndex:S}}function w(z){i[z.line]=z.column,L()}function k(){let z;for(;r._index<s.length;){const T=s[r._index];if(typeof T=="string")for(z=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===z&&r._bufferIndex<T.length;)d(T.charCodeAt(r._bufferIndex));else d(T)}}function d(z){f=f(z)}function y(z){P(z)?(r.line++,r.column=1,r.offset+=z===-3?2:1,L()):z!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++)),a.previous=z}function E(z,T){const F=T||{};return F.type=z,F.start=x(),a.events.push(["enter",F,a]),u.push(F),F}function _(z){const T=u.pop();return T.end=x(),a.events.push(["exit",T,a]),T}function C(z,T){I(z,T.from)}function m(z,T){T.restore()}function A(z,T){return F;function F(U,S,v){let O,R,D,p;return Array.isArray(U)?V(U):"tokenize"in U?V([U]):j(U);function j(W){return fn;function fn(En){const hn=En!==null&&W[En],bn=En!==null&&W.null,st=[...Array.isArray(hn)?hn:hn?[hn]:[],...Array.isArray(bn)?bn:bn?[bn]:[]];return V(st)(En)}}function V(W){return O=W,R=0,W.length===0?v:b(W[R])}function b(W){return fn;function fn(En){return p=N(),D=W,W.partial||(a.currentConstruct=W),W.name&&a.parser.constructs.disable.null.includes(W.name)?mn():W.tokenize.call(T?Object.assign(Object.create(a),T):a,c,Y,mn)(En)}}function Y(W){return z(D,p),S}function mn(W){return p.restore(),++R<O.length?b(O[R]):v}}}function I(z,T){z.resolveAll&&!o.includes(z)&&o.push(z),z.resolve&&$n(a.events,T,a.events.length-T,z.resolve(a.events.slice(T),a)),z.resolveTo&&(a.events=z.resolveTo(a.events,a))}function N(){const z=x(),T=a.previous,F=a.currentConstruct,U=a.events.length,S=Array.from(u);return{restore:v,from:U};function v(){r=z,a.previous=T,a.currentConstruct=F,a.events.length=U,u=S,L()}}function L(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function Mu(n,t){const e=t.start._index,r=t.start._bufferIndex,i=t.end._index,o=t.end._bufferIndex;let s;if(e===i)s=[n[e].slice(r,o)];else{if(s=n.slice(e,i),r>-1){const u=s[0];typeof u=="string"?s[0]=u.slice(r):s.shift()}o>0&&s.push(n[i].slice(0,o))}return s}function ju(n,t){let e=-1;const r=[];let i;for(;++e<n.length;){const o=n[e];let s;if(typeof o=="string")s=o;else switch(o){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=t?" ":"	";break}case-1:{if(!t&&i)continue;s=" ";break}default:s=String.fromCharCode(o)}i=o===-2,r.push(s)}return r.join("")}const Vu={[42]:gn,[43]:gn,[45]:gn,[48]:gn,[49]:gn,[50]:gn,[51]:gn,[52]:gn,[53]:gn,[54]:gn,[55]:gn,[56]:gn,[57]:gn,[62]:ri},Wu={[91]:Zs},Zu={[-2]:ae,[-1]:ae,[32]:ae},Ku={[35]:Js,[42]:$t,[45]:[vr,$t],[60]:ru,[61]:vr,[95]:$t,[96]:_r,[126]:_r},Yu={[38]:oi,[92]:ii},Gu={[-5]:ce,[-4]:ce,[-3]:ce,[33]:Eu,[38]:oi,[42]:ke,[60]:[As,cu],[91]:Su,[92]:[Qs,ii],[93]:qe,[95]:ke,[96]:Rs},Qu={null:[ke,Nu]},Xu={null:[42,95]},Ju={null:[]},nl=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Xu,contentInitial:Wu,disable:Ju,document:Vu,flow:Ku,flowInitial:Zu,insideSpan:Qu,string:Yu,text:Gu},Symbol.toStringTag,{value:"Module"}));function tl(n){const e=rs([nl,...(n||{}).extensions||[]]),r={defined:[],lazy:{},constructs:e,content:i(bs),document:i(xs),flow:i(Fu),string:i(Du),text:i(Uu)};return r;function i(o){return s;function s(u){return Hu(r,o,u)}}}function el(n){for(;!si(n););return n}const Br=/[\0\t\n\r]/g;function rl(){let n=1,t="",e=!0,r;return i;function i(o,s,u){const c=[];let a,f,l,g,h;for(o=t+o.toString(s),l=0,t="",e&&(o.charCodeAt(0)===65279&&l++,e=void 0);l<o.length;){if(Br.lastIndex=l,a=Br.exec(o),g=a&&a.index!==void 0?a.index:o.length,h=o.charCodeAt(g),!a){t=o.slice(l);break}if(h===10&&l===g&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),l<g&&(c.push(o.slice(l,g)),n+=g-l),h){case 0:{c.push(65533),n++;break}case 9:{for(f=Math.ceil(n/4)*4,c.push(-2);n++<f;)c.push(-1);break}case 10:{c.push(-4),n=1;break}default:r=!0,n=1}l=g+1}return u&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}function il(n,t,e){return typeof t!="string"&&(e=t,t=void 0),ms(e)(el(tl(e).document().write(rl()(n,t,!0))))}const ol={tokenize:fl,partial:!0},hi={tokenize:hl,partial:!0},di={tokenize:dl,partial:!0},gi={tokenize:gl,partial:!0},sl={tokenize:pl,partial:!0},pi={tokenize:al,previous:bi},mi={tokenize:cl,previous:wi},Un={tokenize:ll,previous:xi},Ln={},ul={text:Ln};let tt=48;for(;tt<123;)Ln[tt]=Un,tt++,tt===58?tt=65:tt===91&&(tt=97);Ln[43]=Un;Ln[45]=Un;Ln[46]=Un;Ln[95]=Un;Ln[72]=[Un,mi];Ln[104]=[Un,mi];Ln[87]=[Un,pi];Ln[119]=[Un,pi];function ll(n,t,e){const r=this;let i,o;return s;function s(l){return!Se(l)||!xi.call(r,r.previous)||He(r.events)?e(l):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),u(l))}function u(l){return Se(l)?(n.consume(l),u):l===64?(n.consume(l),c):e(l)}function c(l){return l===46?n.check(sl,f,a)(l):l===45||l===95||on(l)?(o=!0,n.consume(l),c):f(l)}function a(l){return n.consume(l),i=!0,c}function f(l){return o&&i&&an(r.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),t(l)):e(l)}}function al(n,t,e){const r=this;return i;function i(s){return s!==87&&s!==119||!bi.call(r,r.previous)||He(r.events)?e(s):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(ol,n.attempt(hi,n.attempt(di,o),e),e)(s))}function o(s){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),t(s)}}function cl(n,t,e){const r=this;let i="",o=!1;return s;function s(l){return(l===72||l===104)&&wi.call(r,r.previous)&&!He(r.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),i+=String.fromCodePoint(l),n.consume(l),u):e(l)}function u(l){if(an(l)&&i.length<5)return i+=String.fromCodePoint(l),n.consume(l),u;if(l===58){const g=i.toLowerCase();if(g==="http"||g==="https")return n.consume(l),c}return e(l)}function c(l){return l===47?(n.consume(l),o?a:(o=!0,c)):e(l)}function a(l){return l===null||Ut(l)||X(l)||lt(l)||De(l)?e(l):n.attempt(hi,n.attempt(di,f),e)(l)}function f(l){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),t(l)}}function fl(n,t,e){let r=0;return i;function i(s){return(s===87||s===119)&&r<3?(r++,n.consume(s),i):s===46&&r===3?(n.consume(s),o):e(s)}function o(s){return s===null?e(s):t(s)}}function hl(n,t,e){let r,i,o;return s;function s(a){return a===46||a===95?n.check(gi,c,u)(a):a===null||X(a)||lt(a)||a!==45&&De(a)?c(a):(o=!0,n.consume(a),s)}function u(a){return a===95?r=!0:(i=r,r=void 0),n.consume(a),s}function c(a){return i||r||!o?e(a):t(a)}}function dl(n,t){let e=0,r=0;return i;function i(s){return s===40?(e++,n.consume(s),i):s===41&&r<e?o(s):s===33||s===34||s===38||s===39||s===41||s===42||s===44||s===46||s===58||s===59||s===60||s===63||s===93||s===95||s===126?n.check(gi,t,o)(s):s===null||X(s)||lt(s)?t(s):(n.consume(s),i)}function o(s){return s===41&&r++,n.consume(s),i}}function gl(n,t,e){return r;function r(u){return u===33||u===34||u===39||u===41||u===42||u===44||u===46||u===58||u===59||u===63||u===95||u===126?(n.consume(u),r):u===38?(n.consume(u),o):u===93?(n.consume(u),i):u===60||u===null||X(u)||lt(u)?t(u):e(u)}function i(u){return u===null||u===40||u===91||X(u)||lt(u)?t(u):r(u)}function o(u){return an(u)?s(u):e(u)}function s(u){return u===59?(n.consume(u),r):an(u)?(n.consume(u),s):e(u)}}function pl(n,t,e){return r;function r(o){return n.consume(o),i}function i(o){return on(o)?e(o):t(o)}}function bi(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||X(n)}function wi(n){return!an(n)}function xi(n){return!(n===47||Se(n))}function Se(n){return n===43||n===45||n===46||n===95||on(n)}function He(n){let t=n.length,e=!1;for(;t--;){const r=n[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){e=!0;break}if(r._gfmAutolinkLiteralWalkedInto){e=!1;break}}return n.length>0&&!e&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),e}const ml={exit:{literalAutolinkEmail:wl,literalAutolinkHttp:xl,literalAutolinkWww:bl}};function bl(n){Me.call(this,n,"http://")}function wl(n){Me.call(this,n,"mailto:")}function xl(n){Me.call(this,n)}function Me(n,t){const e=this.sliceSerialize(n);this.tag('<a href="'+wt((t||"")+e)+'">'),this.raw(this.encode(e)),this.tag("</a>")}const Ae=Symbol("store-raw"),St=Symbol("store-node");function yi(n){let t;return n!=null&&typeof n=="object"&&(n[Kn]||!(t=Object.getPrototypeOf(n))||t===Object.prototype||Array.isArray(n))}function qt(n,t=new Set){let e,r,i,o;if(e=n!=null&&n[Ae])return e;if(!yi(n)||t.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):t.add(n);for(let s=0,u=n.length;s<u;s++)i=n[s],(r=qt(i,t))!==i&&(n[s]=r)}else{Object.isFrozen(n)?n=Object.assign({},n):t.add(n);const s=Object.keys(n),u=Object.getOwnPropertyDescriptors(n);for(let c=0,a=s.length;c<a;c++)o=s[c],!u[o].get&&(i=n[o],(r=qt(i,t))!==i&&(n[o]=r))}return n}function je(n){let t=n[St];return t||Object.defineProperty(n,St,{value:t=Object.create(null)}),t}function Ce(n,t,e){return n[t]||(n[t]=ki(e))}function Ei(n){if(Fe()){const t=je(n);(t._||(t._=ki()))()}}function yl(n){return Ei(n),Reflect.ownKeys(n)}function ki(n){const[t,e]=_n(n,{equals:!1,internal:!0});return t.$=e,t}function Ir(n,t,e,r=!1){if(!r&&n[t]===e)return;const i=n[t],o=n.length;e===void 0?delete n[t]:n[t]=e;let s=je(n),u;if((u=Ce(s,t,i))&&u.$(()=>e),Array.isArray(n)&&n.length!==o){for(let c=n.length;c<o;c++)(u=s[c])&&u.$();(u=Ce(s,"length",o))&&u.$(n.length)}(u=s._)&&u.$()}function El(n,t){const e=Reflect.getOwnPropertyDescriptor(n,t);return!e||e.get||e.set||!e.configurable||t===Kn||t===St||(delete e.value,delete e.writable,e.get=()=>n[Kn][t],e.set=r=>n[Kn][t]=r),e}const kl={get(n,t,e){if(t===Ae)return n;if(t===Kn)return e;if(t===me)return Ei(n),e;const r=je(n),i=r[t];let o=i?i():n[t];if(t===St||t==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(n,t),u=typeof o=="function";if(Fe()&&(!u||n.hasOwnProperty(t))&&!(s&&s.get))o=Ce(r,t,o)();else if(o!=null&&u&&o===Array.prototype[t])return(...c)=>Ot(()=>Array.prototype[t].apply(e,c))}return yi(o)?Si(o):o},has(n,t){return t===Ae||t===Kn||t===me||t===St||t==="__proto__"?!0:(this.get(n,t,n),t in n)},set(n,t,e){return Ot(()=>Ir(n,t,qt(e))),!0},deleteProperty(n,t){return Ot(()=>Ir(n,t,void 0,!0)),!0},ownKeys:yl,getOwnPropertyDescriptor:El};function Si(n){let t=n[Kn];if(!t){Object.defineProperty(n,Kn,{value:t=new Proxy(n,kl)});const e=Object.keys(n),r=Object.getOwnPropertyDescriptors(n);for(let i=0,o=e.length;i<o;i++){const s=e[i];if(r[s].get){const u=r[s].get.bind(t);Object.defineProperty(n,s,{get:u})}if(r[s].set){const u=r[s].set;Object.defineProperty(n,s,{set:a=>Ot(()=>u.call(t,a))})}}}return t}function Ve(n,t){const e=qt(n||{});return Si(e)}const en=Ve({}),et=Ve({}),On=Ve({}),Ai=Io(),fe=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const he=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),In=(n,t)=>n<<32-t|n>>>t,Sl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Sl)throw new Error("Non little-endian hardware is not supported");const Al=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function Tn(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let e=0;e<n.length;e++)t+=Al[n[e]];return t}function Ci(n){if(typeof n!="string")throw new TypeError("hexToBytes: expected string, got "+typeof n);if(n.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(n.length/2);for(let e=0;e<t.length;e++){const r=e*2,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[e]=o}return t}function Cl(n){if(typeof n!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof n}`);return new TextEncoder().encode(n)}function We(n){if(typeof n=="string"&&(n=Cl(n)),!(n instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof n})`);return n}function _i(...n){if(!n.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(n.length===1)return n[0];const t=n.reduce((r,i)=>r+i.length,0),e=new Uint8Array(t);for(let r=0,i=0;r<n.length;r++){const o=n[r];e.set(o,i),i+=o.length}return e}class zi{clone(){return this._cloneInto()}}function vi(n){const t=r=>n().update(We(r)).digest(),e=n();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>n(),t}function Bi(n=32){if(fe&&typeof fe.getRandomValues=="function")return fe.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function dt(n){if(!Number.isSafeInteger(n))throw new Error(`Wrong integer: ${n}`)}function qn(...n){const t=(i,o)=>s=>i(o(s)),e=Array.from(n).reverse().reduce((i,o)=>i?t(i,o.encode):o.encode,void 0),r=n.reduce((i,o)=>i?t(i,o.decode):o.decode,void 0);return{encode:e,decode:r}}function Hn(n){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(e=>{if(dt(e),e<0||e>=n.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${n.length})`);return n[e]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(e=>{if(typeof e!="string")throw new Error(`alphabet.decode: not string element=${e}`);const r=n.indexOf(e);if(r===-1)throw new Error(`Unknown letter: "${e}". Allowed: ${n}`);return r})}}}function Mn(n=""){if(typeof n!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let e of t)if(typeof e!="string")throw new Error(`join.encode: non-string input=${e}`);return t.join(n)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(n)}}}function Jt(n,t="="){if(dt(n),typeof t!="string")throw new Error("padding chr should be string");return{encode(e){if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of e)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;e.length*n%8;)e.push(t);return e},decode(e){if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("padding.encode input should be array of strings");for(let i of e)if(typeof i!="string")throw new Error(`padding.decode: non-string input=${i}`);let r=e.length;if(r*n%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&e[r-1]===t;r--)if(!((r-1)*n%8))throw new Error("Invalid padding: string has too much padding");return e.slice(0,r)}}}function Ii(n){if(typeof n!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>n(t)}}function Tr(n,t,e){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(e<2)throw new Error(`convertRadix: wrong to=${e}, base cannot be less than 2`);if(!Array.isArray(n))throw new Error("convertRadix: data should be array");if(!n.length)return[];let r=0;const i=[],o=Array.from(n);for(o.forEach(s=>{if(dt(s),s<0||s>=t)throw new Error(`Wrong integer: ${s}`)});;){let s=0,u=!0;for(let c=r;c<o.length;c++){const a=o[c],f=t*s+a;if(!Number.isSafeInteger(f)||t*s/t!==s||f-a!==t*s)throw new Error("convertRadix: carry overflow");if(s=f%e,o[c]=Math.floor(f/e),!Number.isSafeInteger(o[c])||o[c]*e+s!==f)throw new Error("convertRadix: carry overflow");if(u)o[c]?u=!1:r=c;else continue}if(i.push(s),u)break}for(let s=0;s<n.length-1&&n[s]===0;s++)i.push(0);return i.reverse()}const Ti=(n,t)=>t?Ti(t,n%t):n,Ht=(n,t)=>n+(t-Ti(n,t));function _e(n,t,e,r){if(!Array.isArray(n))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(e<=0||e>32)throw new Error(`convertRadix2: wrong to=${e}`);if(Ht(t,e)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${e} carryBits=${Ht(t,e)}`);let i=0,o=0;const s=2**e-1,u=[];for(const c of n){if(dt(c),c>=2**t)throw new Error(`convertRadix2: invalid data word=${c} from=${t}`);if(i=i<<t|c,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=e;o-=e)u.push((i>>o-e&s)>>>0);i&=2**o-1}if(i=i<<e-o&s,!r&&o>=t)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&u.push(i>>>0),u}function _l(n){return dt(n),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Tr(Array.from(t),2**8,n)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Tr(t,n,2**8))}}}function nt(n,t=!1){if(dt(n),n<=0||n>32)throw new Error("radix2: bits should be in (0..32]");if(Ht(8,n)>32||Ht(n,8)>32)throw new Error("radix2: carry overflow");return{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return _e(Array.from(e),8,n,!t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(_e(e,n,8,t))}}}function Or(n){if(typeof n!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return n.apply(null,t)}catch{}}}const zl=qn(nt(4),Hn("0123456789ABCDEF"),Mn("")),vl=qn(nt(5),Hn("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Jt(5),Mn(""));qn(nt(5),Hn("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Jt(5),Mn(""));qn(nt(5),Hn("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Mn(""),Ii(n=>n.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const Bl=qn(nt(6),Hn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Jt(6),Mn("")),Il=qn(nt(6),Hn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Jt(6),Mn("")),Ze=n=>qn(_l(58),Hn(n),Mn("")),ze=Ze("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Ze("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Ze("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const $r=[0,2,3,5,6,7,9,10,11],Tl={encode(n){let t="";for(let e=0;e<n.length;e+=8){const r=n.subarray(e,e+8);t+=ze.encode(r).padStart($r[r.length],"1")}return t},decode(n){let t=[];for(let e=0;e<n.length;e+=11){const r=n.slice(e,e+11),i=$r.indexOf(r.length),o=ze.decode(r);for(let s=0;s<o.length-i;s++)if(o[s]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-i)))}return Uint8Array.from(t)}},ve=qn(Hn("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Mn("")),Lr=[996825010,642813549,513874426,1027748829,705979059];function mt(n){const t=n>>25;let e=(n&33554431)<<5;for(let r=0;r<Lr.length;r++)(t>>r&1)===1&&(e^=Lr[r]);return e}function Pr(n,t,e=1){const r=n.length;let i=1;for(let o=0;o<r;o++){const s=n.charCodeAt(o);if(s<33||s>126)throw new Error(`Invalid prefix (${n})`);i=mt(i)^s>>5}i=mt(i);for(let o=0;o<r;o++)i=mt(i)^n.charCodeAt(o)&31;for(let o of t)i=mt(i)^o;for(let o=0;o<6;o++)i=mt(i);return i^=e,ve.encode(_e([i%2**30],30,5,!1))}function Oi(n){const t=n==="bech32"?1:734539939,e=nt(5),r=e.decode,i=e.encode,o=Or(r);function s(f,l,g=90){if(typeof f!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof f}`);if(!Array.isArray(l)||l.length&&typeof l[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof l}`);const h=f.length+7+l.length;if(g!==!1&&h>g)throw new TypeError(`Length ${h} exceeds limit ${g}`);return f=f.toLowerCase(),`${f}1${ve.encode(l)}${Pr(f,l,t)}`}function u(f,l=90){if(typeof f!="string")throw new Error(`bech32.decode input should be string, not ${typeof f}`);if(f.length<8||l!==!1&&f.length>l)throw new TypeError(`Wrong string length: ${f.length} (${f}). Expected (8..${l})`);const g=f.toLowerCase();if(f!==g&&f!==f.toUpperCase())throw new Error("String must be lowercase or uppercase");f=g;const h=f.lastIndexOf("1");if(h===0||h===-1)throw new Error('Letter "1" must be present between prefix and data only');const x=f.slice(0,h),w=f.slice(h+1);if(w.length<6)throw new Error("Data must be at least 6 characters long");const k=ve.decode(w).slice(0,-6),d=Pr(x,k,t);if(!w.endsWith(d))throw new Error(`Invalid checksum in ${f}: expected "${d}"`);return{prefix:x,words:k}}const c=Or(u);function a(f){const{prefix:l,words:g}=u(f,!1);return{prefix:l,words:g,bytes:r(g)}}return{encode:s,decode:u,decodeToBytes:a,decodeUnsafe:c,fromWords:r,fromWordsUnsafe:o,toWords:i}}const at=Oi("bech32");Oi("bech32m");const Ol={encode:n=>new TextDecoder().decode(n),decode:n=>new TextEncoder().encode(n)},$l=qn(nt(4),Hn("0123456789abcdef"),Mn(""),Ii(n=>{if(typeof n!="string"||n.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof n} with length ${n.length}`);return n.toLowerCase()})),Ll={utf8:Ol,hex:$l,base16:zl,base32:vl,base64:Bl,base64url:Il,base58:ze,base58xmr:Tl};`${Object.keys(Ll).join(", ")}`;const bt=new TextDecoder("utf-8"),Be=new TextEncoder;function Fr(n){let t=new URL(n);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}class Pl{constructor(t){Bn(this,"_value");Bn(this,"_next");this._value=t,this._next=null}get value(){return this._value}set value(t){this._value=t}get next(){return this._next}set next(t){this._next=t}}class Fl{constructor(){Bn(this,"_first");Bn(this,"_last");Bn(this,"_size");this._first=null,this._last=null,this._size=0}get first(){return this._first}set first(t){this._first=t}get last(){return this._last}set last(t){this._last=t}get size(){return this._size}set size(t){this._size=t}enqueue(t){const e=new Pl(t);return this._size===0||!this._last?(this._first=e,this._last=e):(this._last.next=e,this._last=e),this._size++,!0}dequeue(){if(this._size===0||!this._first)return null;let t=this._first;return this._first=t.next,t.next=null,this._size--,t.value}}const Ke=5e3,Rl=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Ye(n){var i,o,s,u,c,a,f;let{prefix:t,words:e}=at.decode(n,Ke),r=new Uint8Array(at.fromWords(e));switch(t){case"nprofile":{let l=Tt(r);if(!((i=l[0])!=null&&i[0]))throw new Error("missing TLV 0 for nprofile");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:Tn(l[0][0]),relays:l[1]?l[1].map(g=>bt.decode(g)):[]}}}case"nevent":{let l=Tt(r);if(!((o=l[0])!=null&&o[0]))throw new Error("missing TLV 0 for nevent");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(l[2]&&l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");return{type:"nevent",data:{id:Tn(l[0][0]),relays:l[1]?l[1].map(g=>bt.decode(g)):[],author:(s=l[2])!=null&&s[0]?Tn(l[2][0]):void 0}}}case"naddr":{let l=Tt(r);if(!((u=l[0])!=null&&u[0]))throw new Error("missing TLV 0 for naddr");if(!((c=l[2])!=null&&c[0]))throw new Error("missing TLV 2 for naddr");if(l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((a=l[3])!=null&&a[0]))throw new Error("missing TLV 3 for naddr");if(l[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:bt.decode(l[0][0]),pubkey:Tn(l[2][0]),kind:parseInt(Tn(l[3][0]),16),relays:l[1]?l[1].map(g=>bt.decode(g)):[]}}}case"nrelay":{let l=Tt(r);if(!((f=l[0])!=null&&f[0]))throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:bt.decode(l[0][0])}}case"nsec":case"npub":case"note":return{type:t,data:Tn(r)};default:throw new Error(`unknown prefix ${t}`)}}function Tt(n){let t={},e=n;for(;e.length>0;){let r=e[0],i=e[1],o=e.slice(2,2+i);e=e.slice(2+i),!(o.length<i)&&(t[r]=t[r]||[],t[r].push(o))}return t}function Mt(n){return $i("npub",n)}function Nl(n){return $i("note",n)}function $i(n,t){let e=Ci(t),r=at.toWords(e);return at.encode(n,r,Ke)}function Dl(n){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,n.kind,!1);let e=Ul({0:[Be.encode(n.identifier)],1:(n.relays||[]).map(i=>Be.encode(i)),2:[Ci(n.pubkey)],3:[new Uint8Array(t)]}),r=at.toWords(e);return at.encode("naddr",r,Ke)}function Ul(n){let t=[];return Object.entries(n).forEach(([e,r])=>{r.forEach(i=>{let o=new Uint8Array(i.length+2);o.set([parseInt(e)],0),o.set([i.length],1),o.set(i,2),t.push(o)})}),_i(...t)}const ql=new RegExp(`nostr:(${Rl.source})`),Hl=()=>new RegExp(`\\b${ql.source}\\b`,"g");function Ml(n,t){return n.replaceAll(Hl(),(e,r)=>t({uri:e,value:r,decoded:Ye(r)}))}const Li=n=>{n.forEach(t=>{const e=JSON.parse(t.content);en[t.pubkey].timestamp<t.created_at&&(en[t.pubkey]={...en[t.pubkey],timestamp:t.created_at,imgUrl:e.image||e.picture,name:e.displayName||e.display_name||e.name})})},jl=n=>{const t=Ye(n);switch(t.type){case"nevent":return{"#e":[t.data.id]};case"note":return{"#e":[t.data]};case"naddr":return{"#a":[`${t.data.kind}:${t.data.pubkey}:${t.data.identifier}`]};default:return{}}},Vl=n=>n["#e"]?["e",n["#e"][0],"","root"]:["a",n["#a"][0],"","root"],Wl=n=>{let t=n.content;return t=t.replace(/\#\[([0-9])\]/g,(e,r)=>{var i;switch(n.tags[r][0]){case"e":return"nostr:"+Nl(n.tags[r][1]);case"a":const[o,s,u]=n.tags[r][1].split(":");return"nostr:"+Dl({identifier:u,pubkey:s,kind:parseInt(o)});case"p":const c=n.tags[r][1],a=Mt(c);return`[@${((i=en[c])==null?void 0:i.name)||jt(a)}](https://nostr.com/${a})`;default:return e}}),t=Ml(t,({decoded:e,value:r})=>`[@${jt(r)}](https://nostr.com/${r})`),il(t,{extensions:[ul],htmlExtensions:[ml]})},jt=n=>n.substring(0,8)+"..."+n.substring(n.length-4),Sn=20,Vt=()=>Math.floor(Math.random()*42),Lt='data:image/svg+xml;utf-8,<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><circle cx="512" cy="512" r="512" fill="%23333" fill-rule="evenodd" /></svg>',Zl=n=>{const t=new Date,e=Math.floor((t.getTime()-n)/1e3);if(e<60)return"now";if(e<3600){const r=Math.floor(e/60);return`${r} minute${r===1?"":"s"} ago`}if(e<=86400){const r=Math.floor(e/3600);return`${r} hour${r===1?"":"s"} ago`}if(e>86400){const r=new Date(n),i=r.toLocaleDateString("en-us",{day:"numeric",month:"long"}),o=r.getFullYear()===t.getFullYear()?"":" "+r.getFullYear();return i+o}return""},Ie=n=>n.children.reduce((t,e)=>t+Ie(e),n.children.length);function Kl(n){const t={reply:void 0,root:void 0,mentions:[],profiles:[]},e=[];for(const r of n.tags)r[0]==="e"&&r[1]&&e.push(r),r[0]==="p"&&r[1]&&t.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let r=0;r<e.length;r++){const i=e[r],[o,s,u,c]=i,a={id:s,relays:u?[u]:[]},f=r===0,l=r===e.length-1;if(c==="root"){t.root=a;continue}if(c==="reply"){t.reply=a;continue}if(c==="mention"){t.mentions.push(a);continue}if(f&&!n.tags.some(g=>g[0]==="a")){t.root=a;continue}if(l){t.reply=a;continue}t.mentions.push(a)}return t}function Yl(n,t){const e=n.map(r=>{var c,a,f;let i,o;const s=Kl(r),u=r.tags.find(l=>l[0]==="a");return t&&u?(i=t.find(l=>l===u[1]),o=(c=n.find(l=>{var g,h;return l.id===((g=s.reply)==null?void 0:g.id)||l.id===((h=s.root)==null?void 0:h.id)}))==null?void 0:c.id):(i=(a=n.find(l=>{var g;return l.id===((g=s.root)==null?void 0:g.id)}))==null?void 0:a.id,o=(f=n.find(l=>{var g;return l.id===((g=s.reply)==null?void 0:g.id)}))==null?void 0:f.id),{...r,rootId:i,replyId:o,children:[]}}).filter(r=>t?r.rootId:!0);return Pi(e,t)}function Pi(n,t){const e=new Set(n.filter(r=>t?t.includes(r.replyId||r.rootId):(r.replyId||r.rootId)===void 0));n=n.filter(r=>!e.has(r));for(let r of e)r.children.push(...Pi(n,[r.id]));return[...e]}function Te(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function Gl(n){if(typeof n!="boolean")throw new Error(`Expected boolean, not ${n}`)}function Fi(n,...t){if(!(n instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(n.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${n.length}`)}function Ql(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Te(n.outputLen),Te(n.blockLen)}function Xl(n,t=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(t&&n.finished)throw new Error("Hash#digest() has already been called")}function Jl(n,t){Fi(n);const e=t.outputLen;if(n.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}const it={number:Te,bool:Gl,bytes:Fi,hash:Ql,exists:Xl,output:Jl};function na(n,t,e,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(t,e,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(e>>i&o),u=Number(e&o),c=r?4:0,a=r?0:4;n.setUint32(t+c,s,r),n.setUint32(t+a,u,r)}class ta extends zi{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=he(this.buffer)}update(t){it.exists(this);const{view:e,buffer:r,blockLen:i}=this;t=We(t);const o=t.length;for(let s=0;s<o;){const u=Math.min(i-this.pos,o-s);if(u===i){const c=he(t);for(;i<=o-s;s+=i)this.process(c,s);continue}r.set(t.subarray(s,s+u),this.pos),this.pos+=u,s+=u,this.pos===i&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){it.exists(this),it.output(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:i,isLE:o}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let l=s;l<i;l++)e[l]=0;na(r,i-8,BigInt(this.length*8),o),this.process(r,0);const u=he(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=c/4,f=this.get();if(a>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<a;l++)u.setUint32(4*l,f[l],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:i,finished:o,destroyed:s,pos:u}=this;return t.length=i,t.pos=u,t.finished=o,t.destroyed=s,i%e&&t.buffer.set(r),t}}const ea=(n,t,e)=>n&t^~n&e,ra=(n,t,e)=>n&t^n&e^t&e,ia=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Vn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Wn=new Uint32Array(64);class Ri extends ta{constructor(){super(64,32,8,!1),this.A=Vn[0]|0,this.B=Vn[1]|0,this.C=Vn[2]|0,this.D=Vn[3]|0,this.E=Vn[4]|0,this.F=Vn[5]|0,this.G=Vn[6]|0,this.H=Vn[7]|0}get(){const{A:t,B:e,C:r,D:i,E:o,F:s,G:u,H:c}=this;return[t,e,r,i,o,s,u,c]}set(t,e,r,i,o,s,u,c){this.A=t|0,this.B=e|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=u|0,this.H=c|0}process(t,e){for(let l=0;l<16;l++,e+=4)Wn[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){const g=Wn[l-15],h=Wn[l-2],x=In(g,7)^In(g,18)^g>>>3,w=In(h,17)^In(h,19)^h>>>10;Wn[l]=w+Wn[l-7]+x+Wn[l-16]|0}let{A:r,B:i,C:o,D:s,E:u,F:c,G:a,H:f}=this;for(let l=0;l<64;l++){const g=In(u,6)^In(u,11)^In(u,25),h=f+g+ea(u,c,a)+ia[l]+Wn[l]|0,w=(In(r,2)^In(r,13)^In(r,22))+ra(r,i,o)|0;f=a,a=c,c=u,u=s+h|0,s=o,o=i,i=r,r=h+w|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,u=u+this.E|0,c=c+this.F|0,a=a+this.G|0,f=f+this.H|0,this.set(r,i,o,s,u,c,a,f)}roundClean(){Wn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class oa extends Ri{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const At=vi(()=>new Ri);vi(()=>new oa);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ni=BigInt(0),ne=BigInt(1),sa=BigInt(2),te=n=>n instanceof Uint8Array,ua=Array.from({length:256},(n,t)=>t.toString(16).padStart(2,"0"));function ct(n){if(!te(n))throw new Error("Uint8Array expected");let t="";for(let e=0;e<n.length;e++)t+=ua[n[e]];return t}function Di(n){const t=n.toString(16);return t.length&1?`0${t}`:t}function Ge(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function ft(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(n.length%2)throw new Error("hex string is invalid: unpadded "+n.length);const t=new Uint8Array(n.length/2);for(let e=0;e<t.length;e++){const r=e*2,i=n.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("invalid byte sequence");t[e]=o}return t}function cn(n){return Ge(ct(n))}function Qe(n){if(!te(n))throw new Error("Uint8Array expected");return Ge(ct(Uint8Array.from(n).reverse()))}const Yn=(n,t)=>ft(n.toString(16).padStart(t*2,"0")),Ui=(n,t)=>Yn(n,t).reverse(),la=n=>ft(Di(n));function tn(n,t,e){let r;if(typeof t=="string")try{r=ft(t)}catch(o){throw new Error(`${n} must be valid hex string, got "${t}". Cause: ${o}`)}else if(te(t))r=Uint8Array.from(t);else throw new Error(`${n} must be hex string or Uint8Array`);const i=r.length;if(typeof e=="number"&&i!==e)throw new Error(`${n} expected ${e} bytes, got ${i}`);return r}function xn(...n){const t=new Uint8Array(n.reduce((r,i)=>r+i.length,0));let e=0;return n.forEach(r=>{if(!te(r))throw new Error("Uint8Array expected");t.set(r,e),e+=r.length}),t}function aa(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function ee(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new TextEncoder().encode(n)}function ca(n){let t;for(t=0;n>Ni;n>>=ne,t+=1);return t}const fa=(n,t)=>n>>BigInt(t)&ne,ha=(n,t,e)=>n|(e?ne:Ni)<<BigInt(t),Xe=n=>(sa<<BigInt(n-1))-ne,de=n=>new Uint8Array(n),Rr=n=>Uint8Array.from(n);function qi(n,t,e){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let r=de(n),i=de(n),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},u=(...l)=>e(i,r,...l),c=(l=de())=>{i=u(Rr([0]),l),r=u(),l.length!==0&&(i=u(Rr([1]),l),r=u())},a=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const g=[];for(;l<t;){r=u();const h=r.slice();g.push(h),l+=r.length}return xn(...g)};return(l,g)=>{s(),c(l);let h;for(;!(h=g(a()));)c();return s(),h}}const da={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,t)=>t.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function gt(n,t,e={}){const r=(i,o,s)=>{const u=da[o];if(typeof u!="function")throw new Error(`Invalid validator "${o}", expected function`);const c=n[i];if(!(s&&c===void 0)&&!u(c,n))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(e))r(i,o,!0);return n}const ga=Object.freeze(Object.defineProperty({__proto__:null,bitGet:fa,bitLen:ca,bitMask:Xe,bitSet:ha,bytesToHex:ct,bytesToNumberBE:cn,bytesToNumberLE:Qe,concatBytes:xn,createHmacDrbg:qi,ensureBytes:tn,equalBytes:aa,hexToBytes:ft,hexToNumber:Ge,numberToBytesBE:Yn,numberToBytesLE:Ui,numberToHexUnpadded:Di,numberToVarBytesBE:la,utf8ToBytes:ee,validateObject:gt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nn=BigInt(0),K=BigInt(1),rt=BigInt(2),pa=BigInt(3),Oe=BigInt(4),Nr=BigInt(5),Dr=BigInt(8);BigInt(9);BigInt(16);function J(n,t){const e=n%t;return e>=nn?e:t+e}function ma(n,t,e){if(e<=nn||t<nn)throw new Error("Expected power/modulo > 0");if(e===K)return nn;let r=K;for(;t>nn;)t&K&&(r=r*n%e),n=n*n%e,t>>=K;return r}function kn(n,t,e){let r=n;for(;t-- >nn;)r*=r,r%=e;return r}function $e(n,t){if(n===nn||t<=nn)throw new Error(`invert: expected positive integers, got n=${n} mod=${t}`);let e=J(n,t),r=t,i=nn,o=K;for(;e!==nn;){const u=r/e,c=r%e,a=i-o*u;r=e,e=c,i=o,o=a}if(r!==K)throw new Error("invert: does not exist");return J(i,t)}function ba(n){const t=(n-K)/rt;let e,r,i;for(e=n-K,r=0;e%rt===nn;e/=rt,r++);for(i=rt;i<n&&ma(i,t,n)!==n-K;i++);if(r===1){const s=(n+K)/Oe;return function(c,a){const f=c.pow(a,s);if(!c.eql(c.sqr(f),a))throw new Error("Cannot find square root");return f}}const o=(e+K)/rt;return function(u,c){if(u.pow(c,t)===u.neg(u.ONE))throw new Error("Cannot find square root");let a=r,f=u.pow(u.mul(u.ONE,i),e),l=u.pow(c,o),g=u.pow(c,e);for(;!u.eql(g,u.ONE);){if(u.eql(g,u.ZERO))return u.ZERO;let h=1;for(let w=u.sqr(g);h<a&&!u.eql(w,u.ONE);h++)w=u.sqr(w);const x=u.pow(f,K<<BigInt(a-h-1));f=u.sqr(x),l=u.mul(l,x),g=u.mul(g,f),a=h}return l}}function wa(n){if(n%Oe===pa){const t=(n+K)/Oe;return function(r,i){const o=r.pow(i,t);if(!r.eql(r.sqr(o),i))throw new Error("Cannot find square root");return o}}if(n%Dr===Nr){const t=(n-Nr)/Dr;return function(r,i){const o=r.mul(i,rt),s=r.pow(o,t),u=r.mul(i,s),c=r.mul(r.mul(u,rt),s),a=r.mul(u,r.sub(c,r.ONE));if(!r.eql(r.sqr(a),i))throw new Error("Cannot find square root");return a}}return ba(n)}const xa=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Hi(n){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=xa.reduce((r,i)=>(r[i]="function",r),t);return gt(n,e)}function ya(n,t,e){if(e<nn)throw new Error("Expected power > 0");if(e===nn)return n.ONE;if(e===K)return t;let r=n.ONE,i=t;for(;e>nn;)e&K&&(r=n.mul(r,i)),i=n.sqr(i),e>>=K;return r}function Ea(n,t){const e=new Array(t.length),r=t.reduce((o,s,u)=>n.is0(s)?o:(e[u]=o,n.mul(o,s)),n.ONE),i=n.inv(r);return t.reduceRight((o,s,u)=>n.is0(s)?o:(e[u]=n.mul(o,e[u]),n.mul(o,s)),i),e}function Je(n,t){const e=t!==void 0?t:n.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function ka(n,t,e=!1,r={}){if(n<=nn)throw new Error(`Expected Fp ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:o}=Je(n,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=wa(n),u=Object.freeze({ORDER:n,BITS:i,BYTES:o,MASK:Xe(i),ZERO:nn,ONE:K,create:c=>J(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return nn<=c&&c<n},is0:c=>c===nn,isOdd:c=>(c&K)===K,neg:c=>J(-c,n),eql:(c,a)=>c===a,sqr:c=>J(c*c,n),add:(c,a)=>J(c+a,n),sub:(c,a)=>J(c-a,n),mul:(c,a)=>J(c*a,n),pow:(c,a)=>ya(u,c,a),div:(c,a)=>J(c*$e(a,n),n),sqrN:c=>c*c,addN:(c,a)=>c+a,subN:(c,a)=>c-a,mulN:(c,a)=>c*a,inv:c=>$e(c,n),sqrt:r.sqrt||(c=>s(u,c)),invertBatch:c=>Ea(u,c),cmov:(c,a,f)=>f?a:c,toBytes:c=>e?Ui(c,o):Yn(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return e?Qe(c):cn(c)}});return Object.freeze(u)}function Sa(n,t,e=!1){n=tn("privateHash",n);const r=n.length,i=Je(t).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);const o=e?Qe(n):cn(n);return J(o,t-K)+K}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Aa=BigInt(0),ge=BigInt(1);function Ca(n,t){const e=(i,o)=>{const s=o.negate();return i?s:o},r=i=>{const o=Math.ceil(t/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:e,unsafeLadder(i,o){let s=n.ZERO,u=i;for(;o>Aa;)o&ge&&(s=s.add(u)),u=u.double(),o>>=ge;return s},precomputeWindow(i,o){const{windows:s,windowSize:u}=r(o),c=[];let a=i,f=a;for(let l=0;l<s;l++){f=a,c.push(f);for(let g=1;g<u;g++)f=f.add(a),c.push(f);a=f.double()}return c},wNAF(i,o,s){const{windows:u,windowSize:c}=r(i);let a=n.ZERO,f=n.BASE;const l=BigInt(2**i-1),g=2**i,h=BigInt(i);for(let x=0;x<u;x++){const w=x*c;let k=Number(s&l);s>>=h,k>c&&(k-=g,s+=ge);const d=w,y=w+Math.abs(k)-1,E=x%2!==0,_=k<0;k===0?f=f.add(e(E,o[d])):a=a.add(e(_,o[y]))}return{p:a,f}},wNAFCached(i,o,s,u){const c=i._WINDOW_SIZE||1;let a=o.get(i);return a||(a=this.precomputeWindow(i,c),c!==1&&o.set(i,u(a))),this.wNAF(c,a,s)}}}function Mi(n){return Hi(n.Fp),gt(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Je(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _a(n){const t=Mi(n);gt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:i}=t;if(e){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:za,hexToBytes:va}=ga,ot={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(n){const{Err:t}=ot;if(n.length<2||n[0]!==2)throw new t("Invalid signature integer tag");const e=n[1],r=n.subarray(2,e+2);if(!e||r.length!==e)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:za(r),l:n.subarray(e+2)}},toSig(n){const{Err:t}=ot,e=typeof n=="string"?va(n):n;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let r=e.length;if(r<2||e[0]!=48)throw new t("Invalid signature tag");if(e[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:i,l:o}=ot._parseInt(e.subarray(2)),{d:s,l:u}=ot._parseInt(o);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(n){const t=a=>Number.parseInt(a[0],16)&8?"00"+a:a,e=a=>{const f=a.toString(16);return f.length&1?`0${f}`:f},r=t(e(n.s)),i=t(e(n.r)),o=r.length/2,s=i.length/2,u=e(o),c=e(s);return`30${e(s+o+4)}02${c}${i}02${u}${r}`}},Cn=BigInt(0),G=BigInt(1),Rn=BigInt(2),Wt=BigInt(3),Ur=BigInt(4);function Ba(n){const t=_a(n),{Fp:e}=t,r=t.toBytes||((x,w,k)=>{const d=w.toAffine();return xn(Uint8Array.from([4]),e.toBytes(d.x),e.toBytes(d.y))}),i=t.fromBytes||(x=>{const w=x.subarray(1),k=e.fromBytes(w.subarray(0,e.BYTES)),d=e.fromBytes(w.subarray(e.BYTES,2*e.BYTES));return{x:k,y:d}});function o(x){const{a:w,b:k}=t,d=e.sqr(x),y=e.mul(d,x);return e.add(e.add(y,e.mul(x,w)),k)}if(!e.eql(e.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function s(x){return typeof x=="bigint"&&Cn<x&&x<t.n}function u(x){if(!s(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(x){const{allowedPrivateKeyLengths:w,nByteLength:k,wrapPrivateKey:d,n:y}=t;if(w&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=ct(x)),typeof x!="string"||!w.includes(x.length))throw new Error("Invalid key");x=x.padStart(k*2,"0")}let E;try{E=typeof x=="bigint"?x:cn(tn("private key",x,k))}catch{throw new Error(`private key must be ${k} bytes, hex or bigint, not ${typeof x}`)}return d&&(E=J(E,y)),u(E),E}const a=new Map;function f(x){if(!(x instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(w,k,d){if(this.px=w,this.py=k,this.pz=d,w==null||!e.isValid(w))throw new Error("x required");if(k==null||!e.isValid(k))throw new Error("y required");if(d==null||!e.isValid(d))throw new Error("z required")}static fromAffine(w){const{x:k,y:d}=w||{};if(!w||!e.isValid(k)||!e.isValid(d))throw new Error("invalid affine point");if(w instanceof l)throw new Error("projective point not allowed");const y=E=>e.eql(E,e.ZERO);return y(k)&&y(d)?l.ZERO:new l(k,d,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const k=e.invertBatch(w.map(d=>d.pz));return w.map((d,y)=>d.toAffine(k[y])).map(l.fromAffine)}static fromHex(w){const k=l.fromAffine(i(tn("pointHex",w)));return k.assertValidity(),k}static fromPrivateKey(w){return l.BASE.multiply(c(w))}_setWindowSize(w){this._WINDOW_SIZE=w,a.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:w,y:k}=this.toAffine();if(!e.isValid(w)||!e.isValid(k))throw new Error("bad point: x or y not FE");const d=e.sqr(k),y=o(w);if(!e.eql(d,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:w}=this.toAffine();if(e.isOdd)return!e.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){f(w);const{px:k,py:d,pz:y}=this,{px:E,py:_,pz:C}=w,m=e.eql(e.mul(k,C),e.mul(E,y)),A=e.eql(e.mul(d,C),e.mul(_,y));return m&&A}negate(){return new l(this.px,e.neg(this.py),this.pz)}double(){const{a:w,b:k}=t,d=e.mul(k,Wt),{px:y,py:E,pz:_}=this;let C=e.ZERO,m=e.ZERO,A=e.ZERO,I=e.mul(y,y),N=e.mul(E,E),L=e.mul(_,_),z=e.mul(y,E);return z=e.add(z,z),A=e.mul(y,_),A=e.add(A,A),C=e.mul(w,A),m=e.mul(d,L),m=e.add(C,m),C=e.sub(N,m),m=e.add(N,m),m=e.mul(C,m),C=e.mul(z,C),A=e.mul(d,A),L=e.mul(w,L),z=e.sub(I,L),z=e.mul(w,z),z=e.add(z,A),A=e.add(I,I),I=e.add(A,I),I=e.add(I,L),I=e.mul(I,z),m=e.add(m,I),L=e.mul(E,_),L=e.add(L,L),I=e.mul(L,z),C=e.sub(C,I),A=e.mul(L,N),A=e.add(A,A),A=e.add(A,A),new l(C,m,A)}add(w){f(w);const{px:k,py:d,pz:y}=this,{px:E,py:_,pz:C}=w;let m=e.ZERO,A=e.ZERO,I=e.ZERO;const N=t.a,L=e.mul(t.b,Wt);let z=e.mul(k,E),T=e.mul(d,_),F=e.mul(y,C),U=e.add(k,d),S=e.add(E,_);U=e.mul(U,S),S=e.add(z,T),U=e.sub(U,S),S=e.add(k,y);let v=e.add(E,C);return S=e.mul(S,v),v=e.add(z,F),S=e.sub(S,v),v=e.add(d,y),m=e.add(_,C),v=e.mul(v,m),m=e.add(T,F),v=e.sub(v,m),I=e.mul(N,S),m=e.mul(L,F),I=e.add(m,I),m=e.sub(T,I),I=e.add(T,I),A=e.mul(m,I),T=e.add(z,z),T=e.add(T,z),F=e.mul(N,F),S=e.mul(L,S),T=e.add(T,F),F=e.sub(z,F),F=e.mul(N,F),S=e.add(S,F),z=e.mul(T,S),A=e.add(A,z),z=e.mul(v,S),m=e.mul(U,m),m=e.sub(m,z),z=e.mul(U,T),I=e.mul(v,I),I=e.add(I,z),new l(m,A,I)}subtract(w){return this.add(w.negate())}is0(){return this.equals(l.ZERO)}wNAF(w){return h.wNAFCached(this,a,w,k=>{const d=e.invertBatch(k.map(y=>y.pz));return k.map((y,E)=>y.toAffine(d[E])).map(l.fromAffine)})}multiplyUnsafe(w){const k=l.ZERO;if(w===Cn)return k;if(u(w),w===G)return this;const{endo:d}=t;if(!d)return h.unsafeLadder(this,w);let{k1neg:y,k1:E,k2neg:_,k2:C}=d.splitScalar(w),m=k,A=k,I=this;for(;E>Cn||C>Cn;)E&G&&(m=m.add(I)),C&G&&(A=A.add(I)),I=I.double(),E>>=G,C>>=G;return y&&(m=m.negate()),_&&(A=A.negate()),A=new l(e.mul(A.px,d.beta),A.py,A.pz),m.add(A)}multiply(w){u(w);let k=w,d,y;const{endo:E}=t;if(E){const{k1neg:_,k1:C,k2neg:m,k2:A}=E.splitScalar(k);let{p:I,f:N}=this.wNAF(C),{p:L,f:z}=this.wNAF(A);I=h.constTimeNegate(_,I),L=h.constTimeNegate(m,L),L=new l(e.mul(L.px,E.beta),L.py,L.pz),d=I.add(L),y=N.add(z)}else{const{p:_,f:C}=this.wNAF(k);d=_,y=C}return l.normalizeZ([d,y])[0]}multiplyAndAddUnsafe(w,k,d){const y=l.BASE,E=(C,m)=>m===Cn||m===G||!C.equals(y)?C.multiplyUnsafe(m):C.multiply(m),_=E(this,k).add(E(w,d));return _.is0()?void 0:_}toAffine(w){const{px:k,py:d,pz:y}=this,E=this.is0();w==null&&(w=E?e.ONE:e.inv(y));const _=e.mul(k,w),C=e.mul(d,w),m=e.mul(y,w);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(m,e.ONE))throw new Error("invZ was invalid");return{x:_,y:C}}isTorsionFree(){const{h:w,isTorsionFree:k}=t;if(w===G)return!0;if(k)return k(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:k}=t;return w===G?this:k?k(l,this):this.multiplyUnsafe(t.h)}toRawBytes(w=!0){return this.assertValidity(),r(l,this,w)}toHex(w=!0){return ct(this.toRawBytes(w))}}l.BASE=new l(t.Gx,t.Gy,e.ONE),l.ZERO=new l(e.ZERO,e.ONE,e.ZERO);const g=t.nBitLength,h=Ca(l,t.endo?Math.ceil(g/2):g);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function Ia(n){const t=Mi(n);return gt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Ta(n){const t=Ia(n),{Fp:e,n:r}=t,i=e.BYTES+1,o=2*e.BYTES+1;function s(S){return Cn<S&&S<e.ORDER}function u(S){return J(S,r)}function c(S){return $e(S,r)}const{ProjectivePoint:a,normPrivateKeyToScalar:f,weierstrassEquation:l,isWithinCurveOrder:g}=Ba({...t,toBytes(S,v,O){const R=v.toAffine(),D=e.toBytes(R.x),p=xn;return O?p(Uint8Array.from([v.hasEvenY()?2:3]),D):p(Uint8Array.from([4]),D,e.toBytes(R.y))},fromBytes(S){const v=S.length,O=S[0],R=S.subarray(1);if(v===i&&(O===2||O===3)){const D=cn(R);if(!s(D))throw new Error("Point is not on curve");const p=l(D);let j=e.sqrt(p);const V=(j&G)===G;return(O&1)===1!==V&&(j=e.neg(j)),{x:D,y:j}}else if(v===o&&O===4){const D=e.fromBytes(R.subarray(0,e.BYTES)),p=e.fromBytes(R.subarray(e.BYTES,2*e.BYTES));return{x:D,y:p}}else throw new Error(`Point of length ${v} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),h=S=>ct(Yn(S,t.nByteLength));function x(S){const v=r>>G;return S>v}function w(S){return x(S)?u(-S):S}const k=(S,v,O)=>cn(S.slice(v,O));class d{constructor(v,O,R){this.r=v,this.s=O,this.recovery=R,this.assertValidity()}static fromCompact(v){const O=t.nByteLength;return v=tn("compactSignature",v,O*2),new d(k(v,0,O),k(v,O,2*O))}static fromDER(v){const{r:O,s:R}=ot.toSig(tn("DER",v));return new d(O,R)}assertValidity(){if(!g(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!g(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new d(this.r,this.s,v)}recoverPublicKey(v){const{r:O,s:R,recovery:D}=this,p=A(tn("msgHash",v));if(D==null||![0,1,2,3].includes(D))throw new Error("recovery id invalid");const j=D===2||D===3?O+t.n:O;if(j>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const V=D&1?"03":"02",b=a.fromHex(V+h(j)),Y=c(j),mn=u(-p*Y),W=u(R*Y),fn=a.BASE.multiplyAndAddUnsafe(b,mn,W);if(!fn)throw new Error("point at infinify");return fn.assertValidity(),fn}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new d(this.r,u(-this.s),this.recovery):this}toDERRawBytes(){return ft(this.toDERHex())}toDERHex(){return ot.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ft(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const y={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const S=t.randomBytes(e.BYTES+8),v=Sa(S,r);return Yn(v,t.nByteLength)},precompute(S=8,v=a.BASE){return v._setWindowSize(S),v.multiply(BigInt(3)),v}};function E(S,v=!0){return a.fromPrivateKey(S).toRawBytes(v)}function _(S){const v=S instanceof Uint8Array,O=typeof S=="string",R=(v||O)&&S.length;return v?R===i||R===o:O?R===2*i||R===2*o:S instanceof a}function C(S,v,O=!0){if(_(S))throw new Error("first arg must be private key");if(!_(v))throw new Error("second arg must be public key");return a.fromHex(v).multiply(f(S)).toRawBytes(O)}const m=t.bits2int||function(S){const v=cn(S),O=S.length*8-t.nBitLength;return O>0?v>>BigInt(O):v},A=t.bits2int_modN||function(S){return u(m(S))},I=Xe(t.nBitLength);function N(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(Cn<=S&&S<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Yn(S,t.nByteLength)}function L(S,v,O=z){if(["recovered","canonical"].some(hn=>hn in O))throw new Error("sign() legacy options not supported");const{hash:R,randomBytes:D}=t;let{lowS:p,prehash:j,extraEntropy:V}=O;p==null&&(p=!0),S=tn("msgHash",S),j&&(S=tn("prehashed msgHash",R(S)));const b=A(S),Y=f(v),mn=[N(Y),N(b)];if(V!=null){const hn=V===!0?D(e.BYTES):V;mn.push(tn("extraEntropy",hn,e.BYTES))}const W=xn(...mn),fn=b;function En(hn){const bn=m(hn);if(!g(bn))return;const st=c(bn),Pn=a.BASE.multiply(bn).toAffine(),wn=u(Pn.x);if(wn===Cn)return;const jn=u(st*u(fn+wn*Y));if(jn===Cn)return;let Bt=(Pn.x===wn?0:2)|Number(Pn.y&G),It=jn;return p&&x(jn)&&(It=w(jn),Bt^=1),new d(wn,It,Bt)}return{seed:W,k2sig:En}}const z={lowS:t.lowS,prehash:!1},T={lowS:t.lowS,prehash:!1};function F(S,v,O=z){const{seed:R,k2sig:D}=L(S,v,O);return qi(t.hash.outputLen,t.nByteLength,t.hmac)(R,D)}a.BASE._setWindowSize(8);function U(S,v,O,R=T){var Pn;const D=S;if(v=tn("msgHash",v),O=tn("publicKey",O),"strict"in R)throw new Error("options.strict was renamed to lowS");const{lowS:p,prehash:j}=R;let V,b;try{if(typeof D=="string"||D instanceof Uint8Array)try{V=d.fromDER(D)}catch(wn){if(!(wn instanceof ot.Err))throw wn;V=d.fromCompact(D)}else if(typeof D=="object"&&typeof D.r=="bigint"&&typeof D.s=="bigint"){const{r:wn,s:jn}=D;V=new d(wn,jn)}else throw new Error("PARSE");b=a.fromHex(O)}catch(wn){if(wn.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(p&&V.hasHighS())return!1;j&&(v=t.hash(v));const{r:Y,s:mn}=V,W=A(v),fn=c(mn),En=u(W*fn),hn=u(Y*fn),bn=(Pn=a.BASE.multiplyAndAddUnsafe(b,En,hn))==null?void 0:Pn.toAffine();return bn?u(bn.x)===Y:!1}return{CURVE:t,getPublicKey:E,getSharedSecret:C,sign:F,verify:U,ProjectivePoint:a,Signature:d,utils:y}}function Oa(n,t){const e=n.ORDER;let r=Cn;for(let g=e-G;g%Rn===Cn;g/=Rn)r+=G;const i=r,o=(e-G)/Rn**i,s=(o-G)/Rn,u=Rn**i-G,c=Rn**(i-G),a=n.pow(t,o),f=n.pow(t,(o+G)/Rn);let l=(g,h)=>{let x=a,w=n.pow(h,u),k=n.sqr(w);k=n.mul(k,h);let d=n.mul(g,k);d=n.pow(d,s),d=n.mul(d,w),w=n.mul(d,h),k=n.mul(d,g);let y=n.mul(k,w);d=n.pow(y,c);let E=n.eql(d,n.ONE);w=n.mul(k,f),d=n.mul(y,x),k=n.cmov(w,k,E),y=n.cmov(d,y,E);for(let _=i;_>G;_--){let C=Rn**(_-Rn),m=n.pow(y,C);const A=n.eql(m,n.ONE);w=n.mul(k,x),x=n.mul(x,x),m=n.mul(y,x),k=n.cmov(w,k,A),y=n.cmov(m,y,A)}return{isValid:E,value:k}};if(n.ORDER%Ur===Wt){const g=(n.ORDER-Wt)/Ur,h=n.sqrt(n.neg(t));l=(x,w)=>{let k=n.sqr(w);const d=n.mul(x,w);k=n.mul(k,d);let y=n.pow(k,g);y=n.mul(y,d);const E=n.mul(y,h),_=n.mul(n.sqr(y),w),C=n.eql(_,x);let m=n.cmov(E,y,C);return{isValid:C,value:m}}}return l}function $a(n,t){if(Hi(n),!n.isValid(t.A)||!n.isValid(t.B)||!n.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const e=Oa(n,t.Z);if(!n.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,o,s,u,c,a,f,l;i=n.sqr(r),i=n.mul(i,t.Z),o=n.sqr(i),o=n.add(o,i),s=n.add(o,n.ONE),s=n.mul(s,t.B),u=n.cmov(t.Z,n.neg(o),!n.eql(o,n.ZERO)),u=n.mul(u,t.A),o=n.sqr(s),a=n.sqr(u),c=n.mul(a,t.A),o=n.add(o,c),o=n.mul(o,s),a=n.mul(a,u),c=n.mul(a,t.B),o=n.add(o,c),f=n.mul(i,s);const{isValid:g,value:h}=e(o,a);l=n.mul(i,r),l=n.mul(l,h),f=n.cmov(f,s,g),l=n.cmov(l,h,g);const x=n.isOdd(r)===n.isOdd(l);return l=n.cmov(n.neg(l),l,x),f=n.div(f,u),{x:f,y:l}}}function La(n){if(n instanceof Uint8Array)return n;if(typeof n=="string")return ee(n);throw new Error("DST must be Uint8Array or string")}const Pa=cn;function Zn(n,t){if(n<0||n>=1<<8*t)throw new Error(`bad I2OSP call: value=${n} length=${t}`);const e=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)e[r]=n&255,n>>>=8;return new Uint8Array(e)}function Fa(n,t){const e=new Uint8Array(n.length);for(let r=0;r<n.length;r++)e[r]=n[r]^t[r];return e}function Ct(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected")}function nr(n){if(!Number.isSafeInteger(n))throw new Error("number expected")}function Ra(n,t,e,r){Ct(n),Ct(t),nr(e),t.length>255&&(t=r(xn(ee("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:o}=r,s=Math.ceil(e/i);if(s>255)throw new Error("Invalid xmd length");const u=xn(t,Zn(t.length,1)),c=Zn(0,o),a=Zn(e,2),f=new Array(s),l=r(xn(c,n,a,Zn(0,1),u));f[0]=r(xn(l,Zn(1,1),u));for(let h=1;h<=s;h++){const x=[Fa(l,f[h-1]),Zn(h+1,1),u];f[h]=r(xn(...x))}return xn(...f).slice(0,e)}function Na(n,t,e,r,i){if(Ct(n),Ct(t),nr(e),t.length>255){const o=Math.ceil(2*r/8);t=i.create({dkLen:o}).update(ee("H2C-OVERSIZE-DST-")).update(t).digest()}if(e>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:e}).update(n).update(Zn(e,2)).update(t).update(Zn(t.length,1)).digest()}function qr(n,t,e){gt(e,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:o,hash:s,expand:u,DST:c}=e;Ct(n),nr(t);const a=La(c),f=r.toString(2).length,l=Math.ceil((f+i)/8),g=t*o*l;let h;if(u==="xmd")h=Ra(n,a,g,s);else if(u==="xof")h=Na(n,a,g,i,s);else if(u==="_internal_pass")h=n;else throw new Error('expand must be "xmd" or "xof"');const x=new Array(t);for(let w=0;w<t;w++){const k=new Array(o);for(let d=0;d<o;d++){const y=l*(d+w*o),E=h.subarray(y,y+l);k[d]=J(Pa(E),r)}x[w]=k}return x}function Da(n,t){const e=t.map(r=>Array.from(r).reverse());return(r,i)=>{const[o,s,u,c]=e.map(a=>a.reduce((f,l)=>n.add(n.mul(f,r),l)));return r=n.div(o,s),i=n.mul(i,n.div(u,c)),{x:r,y:i}}}function Ua(n,t,e){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,i){const o=qr(r,2,{...e,DST:e.DST,...i}),s=n.fromAffine(t(o[0])),u=n.fromAffine(t(o[1])),c=s.add(u).clearCofactor();return c.assertValidity(),c},encodeToCurve(r,i){const o=qr(r,1,{...e,DST:e.encodeDST,...i}),s=n.fromAffine(t(o[0])).clearCofactor();return s.assertValidity(),s}}}class ji extends zi{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,it.hash(t);const r=We(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?t.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(t){return it.exists(this),this.iHash.update(t),this}digestInto(t){it.exists(this),it.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:i,destroyed:o,blockLen:s,outputLen:u}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=s,t.outputLen=u,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Vi=(n,t,e)=>new ji(n,t).update(e).digest();Vi.create=(n,t)=>new ji(n,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function qa(n){return{hash:n,hmac:(t,...e)=>Vi(n,t,_i(...e)),randomBytes:Bi}}function Ha(n,t){const e=r=>Ta({...n,...qa(r)});return Object.freeze({...e(t),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const re=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Zt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Wi=BigInt(1),Kt=BigInt(2),Hr=(n,t)=>(n+t/Kt)/t;function Zi(n){const t=re,e=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),u=BigInt(44),c=BigInt(88),a=n*n*n%t,f=a*a*n%t,l=kn(f,e,t)*f%t,g=kn(l,e,t)*f%t,h=kn(g,Kt,t)*a%t,x=kn(h,i,t)*h%t,w=kn(x,o,t)*x%t,k=kn(w,u,t)*w%t,d=kn(k,c,t)*k%t,y=kn(d,u,t)*w%t,E=kn(y,e,t)*f%t,_=kn(E,s,t)*x%t,C=kn(_,r,t)*a%t,m=kn(C,Kt,t);if(!Qn.eql(Qn.sqr(m),n))throw new Error("Cannot find square root");return m}const Qn=ka(re,void 0,void 0,{sqrt:Zi}),ie=Ha({a:BigInt(0),b:BigInt(7),Fp:Qn,n:Zt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const t=Zt,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Wi*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,s=BigInt("0x100000000000000000000000000000000"),u=Hr(o*n,t),c=Hr(-r*n,t);let a=J(n-u*e-c*i,t),f=J(-u*r-c*o,t);const l=a>s,g=f>s;if(l&&(a=t-a),g&&(f=t-f),a>s||f>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:l,k1:a,k2neg:g,k2:f}}}},At),oe=BigInt(0),Ki=n=>typeof n=="bigint"&&oe<n&&n<re,Ma=n=>typeof n=="bigint"&&oe<n&&n<Zt,Mr={};function Yt(n,...t){let e=Mr[n];if(e===void 0){const r=At(Uint8Array.from(n,i=>i.charCodeAt(0)));e=xn(r,r),Mr[n]=e}return At(xn(e,...t))}const tr=n=>n.toRawBytes(!0).slice(1),Le=n=>Yn(n,32),pe=n=>J(n,re),_t=n=>J(n,Zt),er=ie.ProjectivePoint,ja=(n,t,e)=>er.BASE.multiplyAndAddUnsafe(n,t,e);function Pe(n){let t=ie.utils.normPrivateKeyToScalar(n),e=er.fromPrivateKey(t);return{scalar:e.hasEvenY()?t:_t(-t),bytes:tr(e)}}function Yi(n){if(!Ki(n))throw new Error("bad x: need 0 < x < p");const t=pe(n*n),e=pe(t*n+BigInt(7));let r=Zi(e);r%Kt!==oe&&(r=pe(-r));const i=new er(n,r,Wi);return i.assertValidity(),i}function Gi(...n){return _t(cn(Yt("BIP0340/challenge",...n)))}function Va(n){return Pe(n).bytes}function Wa(n,t,e=Bi(32)){const r=tn("message",n),{bytes:i,scalar:o}=Pe(t),s=tn("auxRand",e,32),u=Le(o^cn(Yt("BIP0340/aux",s))),c=Yt("BIP0340/nonce",u,i,r),a=_t(cn(c));if(a===oe)throw new Error("sign failed: k is zero");const{bytes:f,scalar:l}=Pe(a),g=Gi(f,i,r),h=new Uint8Array(64);if(h.set(f,0),h.set(Le(_t(l+g*o)),32),!Qi(h,r,i))throw new Error("sign: Invalid signature produced");return h}function Qi(n,t,e){const r=tn("signature",n,64),i=tn("message",t),o=tn("publicKey",e,32);try{const s=Yi(cn(o)),u=cn(r.subarray(0,32));if(!Ki(u))return!1;const c=cn(r.subarray(32,64));if(!Ma(c))return!1;const a=Gi(Le(u),tr(s),i),f=ja(s,c,_t(-a));return!(!f||!f.hasEvenY()||f.toAffine().x!==u)}catch{return!1}}const se={getPublicKey:Va,sign:Wa,verify:Qi,utils:{randomPrivateKey:ie.utils.randomPrivateKey,lift_x:Yi,pointToBytes:tr,numberToBytesBE:Yn,bytesToNumberBE:cn,taggedHash:Yt,mod:J}},Za=Da(Qn,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(n=>n.map(t=>BigInt(t)))),Ka=$a(Qn,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Qn.create(BigInt("-11"))});Ua(ie.ProjectivePoint,n=>{const{x:t,y:e}=Ka(Qn.create(n[0]));return Za(t,e)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Qn.ORDER,m:1,k:128,expand:"xmd",hash:At});function Ya(){return Tn(se.utils.randomPrivateKey())}function Ga(n){return Tn(se.getPublicKey(n))}function Qa(n){if(!Xi(n))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,n.pubkey,n.created_at,n.kind,n.tags,n.content])}function rr(n){let t=At(Be.encode(Qa(n)));return Tn(t)}const Xa=n=>n instanceof Object;function Xi(n){if(!Xa(n)||typeof n.kind!="number"||typeof n.content!="string"||typeof n.created_at!="number"||typeof n.pubkey!="string"||!n.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(n.tags))return!1;for(let t=0;t<n.tags.length;t++){let e=n.tags[t];if(!Array.isArray(e))return!1;for(let r=0;r<e.length;r++)if(typeof e[r]=="object")return!1}return!0}function Ja(n){try{return se.verify(n.sig,rr(n),n.pubkey)}catch{return!1}}function nc(n,t){return Tn(se.sign(rr(n),t))}const tc=un('<div class="ztr-reply-form"><textarea placeholder="Add your comment..."></textarea><div class="ztr-reply-controls"><div class="ztr-comment-info-picture"><img></div><button class="ztr-reply-button">Reply'),ec=un('<span class="ztr-reply-error">Publishing is disabled'),rc=un('<span class="ztr-reply-error">'),ic=un('<svg width="16" height="16" class="ztr-spinner" viewBox="0 0 50 50"><circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5">'),oc=un('<button class="ztr-reply-login-button">Log-in'),sc=un('<li class="ztr-comment-action-zap"><a><svg viewBox="0 -2 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18,11.74a1,1,0,0,0-.52-.63L14.09,9.43,15,3.14a1,1,0,0,0-1.78-.75l-7,9a1,1,0,0,0-.17.87,1,1,0,0,0,.59.67l4.27,1.71L10,20.86a1,1,0,0,0,.63,1.07A.92.92,0,0,0,11,22a1,1,0,0,0,.83-.45l6-9A1,1,0,0,0,18,11.74Z"></path></svg></a><span> sats'),uc=un('<li class="ztr-comment-action-like"><a><svg viewBox="0 -16 180 180" xmlns="http://www.w3.org/2000/svg"><path d="M60.732 29.7C41.107 29.7 22 39.7 22 67.41c0 27.29 45.274 67.29 74 94.89 28.744-27.6 74-67.6 74-94.89 0-27.71-19.092-37.71-38.695-37.71C116 29.7 104.325 41.575 96 54.066 87.638 41.516 76 29.7 60.732 29.7z"></path></svg></a><span> likes'),lc=un('<div class="ztr-comment-new"><div class="ztr-comment-body"><ul class="ztr-comment-actions">'),Ji=n=>{const{pool:t,relays:e,filter:r,pubkey:i}=To(Ai),[o,s]=_n(""),[u,c]=_n(!1),[a,f]=_n("");yt(()=>{var w;i()&&!((w=en[i()])!=null&&w.loggedIn)&&(h(),g()),!i()&&l()&&h()});const l=()=>Object.values(en).find(w=>w.loggedIn===!0),g=async()=>{const w=i()||await window.nostr.getPublicKey();if(w){if(en[w]={timestamp:0,loggedIn:!0,npub:Mt(w),signEvent:async function(k){const d=await window.nostr.getPublicKey();if(i()!==d)throw`Pubkey mismatch: ${i()} !== ${d}`;return window.nostr.signEvent(k)}},!en[w].name){const k=await t.list(e(),[{kinds:[0],authors:[w]}]);Li(k)}}else alert("Access was denied")},h=()=>{const w=l();w&&(w.loggedIn=!1)},x=async w=>{if(!w&&!en.anonymous){const A=Ya();w=en.anonymous={timestamp:0,npub:Mt(Ga(A)),signEvent:async I=>({sig:nc(I,A)})}}if(!w.signEvent)return;const k=o().trim();if(!k)return;const d={kind:1,created_at:Math.round(Date.now()/1e3),content:k,pubkey:Ye(w.npub).data.toString(),tags:[]};if(d.tags.push(Vl(r())),n.replyTo){const A=["e",n.replyTo,"","reply"];d.tags.push(A)}const y=rr(d),E=await w.signEvent(d),_={id:y,...d,...E},C=()=>{var A;c(!1),s(""),f(""),et[_.id]=_,(A=n.onDone)==null||A.call(globalThis)},m=()=>{c(!1),f("Your comment was not published to relays. Try again.")};if(c(!0),console.log(JSON.stringify(_,null,2)),On.disablePublish)setTimeout(()=>{C()},1500);else{const A=t.publish(e(),_);A.on("ok",()=>{C(),A.off("ok",C)}),A.on("failed",()=>{m(),A.off("failed",m)})}};return(()=>{const w=tc(),k=w.firstChild,d=k.nextSibling,y=d.firstChild,E=y.firstChild,_=y.nextSibling,C=_.firstChild;return k.addEventListener("change",m=>s(m.target.value)),k.autofocus=!0,H(d,(()=>{const m=yn(()=>!!On.disablePublish);return()=>m()&&ec()})(),y),H(d,(()=>{const m=yn(()=>!!a());return()=>m()&&(()=>{const A=rc();return H(A,a),A})()})(),y),_.$$click=()=>x(l()||en.anonymous),H(_,(()=>{const m=yn(()=>!!u());return()=>m()&&ic()})(),C),H(_,()=>u()?"ing":"",null),H(_,(()=>{const m=yn(()=>!!l());return()=>m()?` as ${l().name||jt(l().npub)}`:" anonymously"})(),null),H(d,(()=>{const m=yn(()=>!!(!l()&&window.nostr));return()=>m()&&(()=>{const A=oc();return A.$$click=g,A})()})(),null),Gn(m=>{var L;const A=u(),I=((L=l())==null?void 0:L.imgUrl)||Lt,N=u();return A!==m._v$&&(k.disabled=m._v$=A),I!==m._v$2&&ln(E,"src",m._v$2=I),N!==m._v$3&&(_.disabled=m._v$3=N),m},{_v$:void 0,_v$2:void 0,_v$3:void 0}),Gn(()=>k.value=o()),w})()},ac=()=>(()=>{const n=lc(),t=n.firstChild,e=t.firstChild;return H(e,pn(Et,{get when(){return!On.disableZaps},get children(){const r=sc(),i=r.firstChild,o=i.firstChild,s=i.nextSibling,u=s.firstChild;return ln(o,"width",Sn),ln(o,"height",Sn),H(s,()=>Vt()*11,u),r}}),null),H(e,pn(Et,{get when(){return!On.disableLikes},get children(){const r=uc(),i=r.firstChild,o=i.firstChild,s=i.nextSibling,u=s.firstChild;return ln(o,"width",Sn),ln(o,"height",Sn),H(s,Vt,u),r}}),null),H(t,pn(Ji,{}),null),n})();Xr(["click"]);const cc=un('<div class="ztr-thread">'),fc=un('<li class="ztr-comment-action-zap"><a><svg viewBox="0 -2 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18,11.74a1,1,0,0,0-.52-.63L14.09,9.43,15,3.14a1,1,0,0,0-1.78-.75l-7,9a1,1,0,0,0-.17.87,1,1,0,0,0,.59.67l4.27,1.71L10,20.86a1,1,0,0,0,.63,1.07A.92.92,0,0,0,11,22a1,1,0,0,0,.83-.45l6-9A1,1,0,0,0,18,11.74Z"></path></svg></a><span> sats'),hc=un('<li class="ztr-comment-action-like"><a><svg viewBox="0 -16 180 180" xmlns="http://www.w3.org/2000/svg"><path d="M60.732 29.7C41.107 29.7 22 39.7 22 67.41c0 27.29 45.274 67.29 74 94.89 28.744-27.6 74-67.6 74-94.89 0-27.71-19.092-37.71-38.695-37.71C116 29.7 104.325 41.575 96 54.066 87.638 41.516 76 29.7 60.732 29.7z"></path></svg></a><span> likes'),dc=un('<div class="ztr-comment"><div class="ztr-comment-text"><div class="ztr-comment-body"><span></span><ul class="ztr-comment-actions"><li class="ztr-comment-action-reply"><a><svg viewBox="0 -6 60 60" xmlns="http://www.w3.org/2000/svg"><path d="M 12.6030 50.4905 C 13.3758 50.4905 13.9307 50.1140 14.8621 49.2421 L 20.6483 43.8720 C 19.5188 42.9803 18.6073 41.5733 18.6073 38.3433 L 18.6073 25.2052 C 18.6073 19.1217 22.3129 15.5152 28.3766 15.5152 L 42.2479 15.5152 L 42.2281 14.7622 C 41.9306 10.6999 39.2557 8.0643 34.7177 8.0643 L 7.5301 8.0643 C 2.9922 8.0643 0 10.7791 0 15.4954 L 0 34.9548 C 0 39.6710 2.9922 42.7028 7.5301 42.7028 L 10.8195 42.7028 L 10.8195 48.4693 C 10.8195 49.6979 11.4735 50.4905 12.6030 50.4905 Z M 44.6058 53.2450 C 45.7353 53.2450 46.3895 52.4325 46.3895 51.2237 L 46.3895 45.4374 L 48.4702 45.4374 C 53.0078 45.4374 56 42.4056 56 37.7092 L 56 25.6610 C 56 20.9250 53.0078 18.2300 48.4702 18.2300 L 28.8522 18.2300 C 24.1161 18.2300 21.3221 20.9250 21.3221 25.6610 L 21.3221 37.7092 C 21.3221 42.4056 24.1161 45.4374 28.8522 45.4374 L 35.1735 45.4374 L 42.3470 51.9767 C 43.2784 52.8487 43.8331 53.2450 44.6058 53.2450 Z"></path></svg></a><span></span></li></ul></div></div><div class="ztr-comment-replies">'),gc=un('<div class="ztr-comment-info"><div class="ztr-comment-info-picture"><img></div><ul class="ztr-comment-info-items"><li class="ztr-comment-info-item ztr-comment-info-author"><a target="_blank"></a></li><li class="ztr-comment-info-item ztr-comment-info-time"></li><li class="ztr-comment-info-item ztr-comment-info-replies">'),no=n=>(()=>{const t=cc();return H(t,pn(Uo,{get each(){return mc(n.nestedEvents())},children:e=>{const[r,i]=_n(!1);return(()=>{const o=dc(),s=o.firstChild,u=s.firstChild,c=u.firstChild,a=c.nextSibling,f=a.firstChild,l=f.firstChild,g=l.firstChild,h=l.nextSibling,x=s.nextSibling;return H(s,pn(pc,{event:e}),u),H(a,pn(Et,{get when(){return!On.disableZaps},get children(){const w=fc(),k=w.firstChild,d=k.firstChild,y=k.nextSibling,E=y.firstChild;return ln(d,"width",Sn),ln(d,"height",Sn),H(y,()=>Vt()*11,E),w}}),f),H(a,pn(Et,{get when(){return!On.disableLikes},get children(){const w=hc(),k=w.firstChild,d=k.firstChild,y=k.nextSibling,E=y.firstChild;return ln(d,"width",Sn),ln(d,"height",Sn),H(y,Vt,E),w}}),f),l.$$click=()=>i(!r()),ln(g,"width",Sn),ln(g,"height",Sn),h.$$click=()=>i(!r()),H(h,()=>r()?"Cancel":"Reply"),H(u,(()=>{const w=yn(()=>!!r());return()=>w()&&pn(Ji,{get replyTo(){return e().id},onDone:()=>i(!1)})})(),null),H(x,pn(no,{nestedEvents:()=>e().children})),Gn(()=>c.innerHTML=Wl(e())),o})()}})),t})(),pc=n=>{const[t,e]=_n(Lt),r=()=>n.event().pubkey,i=()=>Mt(r());yt(()=>{var f,l;en[f=r()]||(en[f]={timestamp:0,npub:i()});const a=(l=en[r()])==null?void 0:l.imgUrl;e(a||Lt)});let o;const s=()=>Zl(n.event().created_at*1e3),[u,c]=_n();return yt(()=>{c(s()),o=setInterval(()=>{c(s())},60*1e3)}),zt(()=>clearInterval(o)),(()=>{const a=gc(),f=a.firstChild,l=f.firstChild,g=f.nextSibling,h=g.firstChild,x=h.firstChild,w=h.nextSibling,k=w.nextSibling;return l.addEventListener("error",()=>e(Lt)),ln(l,"width",Sn),ln(l,"height",Sn),H(x,()=>{var d;return((d=en[r()])==null?void 0:d.name)||jt(i())}),H(w,u),H(k,(()=>{const d=yn(()=>Ie(n.event())==1);return()=>d()?"1 reply":`${Ie(n.event())} replies`})()),Gn(d=>{const y=t(),E="https://nostr.com/"+i();return y!==d._v$&&ln(l,"src",d._v$=y),E!==d._v$2&&ln(x,"href",d._v$2=E),d},{_v$:void 0,_v$2:void 0}),a})()},mc=n=>n.sort((t,e)=>(t.created_at||0)>=(e.created_at||0)?-1:1);Xr(["click"]);function bc(n,t){if(n.ids&&n.ids.indexOf(t.id)===-1&&!n.ids.some(e=>t.id.startsWith(e))||n.kinds&&n.kinds.indexOf(t.kind)===-1||n.authors&&n.authors.indexOf(t.pubkey)===-1&&!n.authors.some(e=>t.pubkey.startsWith(e)))return!1;for(let e in n)if(e[0]==="#"){let r=e.slice(1),i=n[`#${r}`];if(i&&!t.tags.find(([o,s])=>o===e.slice(1)&&i.indexOf(s)!==-1))return!1}return!(n.since&&t.created_at<n.since||n.until&&t.created_at>=n.until)}function wc(n,t){for(let e=0;e<n.length;e++)if(bc(n[e],t))return!0;return!1}function xc(n,t){let e=t.length+3,r=n.indexOf(`"${t}":`)+e,i=n.slice(r).indexOf('"')+r+1;return n.slice(i,i+64)}function yc(n){let t=n.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let e=n.slice(t+7+1).indexOf('"');if(e===-1)return null;let r=t+7+1+e,i=n.slice(r+1,80).indexOf('"');if(i===-1)return null;let o=r+1+i;return n.slice(r+1,o)}const jr=()=>({connect:[],disconnect:[],error:[],notice:[],auth:[]});function Ec(n,t={}){let{listTimeout:e=3e3,getTimeout:r=3e3,countTimeout:i=3e3}=t;var o,s={},u=jr(),c={},a={},f;async function l(){return f||(f=new Promise((d,y)=>{try{o=new WebSocket(n)}catch(m){y(m)}o.onopen=()=>{u.connect.forEach(m=>m()),d()},o.onerror=()=>{f=void 0,u.error.forEach(m=>m()),y()},o.onclose=async()=>{f=void 0,u.disconnect.forEach(m=>m())};let E=new Fl,_;o.onmessage=m=>{E.enqueue(m.data),_||(_=setInterval(C,0))};function C(){var I,N,L;if(E.size===0){clearInterval(_),_=null;return}var m=E.dequeue();if(!m)return;let A=yc(m);if(A){let z=s[A];if(z&&z.alreadyHaveEvent&&z.alreadyHaveEvent(xc(m,"id"),n))return}try{let z=JSON.parse(m);switch(z[0]){case"EVENT":{let S=z[1],v=z[2];Xi(v)&&s[S]&&(s[S].skipVerification||Ja(v))&&wc(s[S].filters,v)&&(s[S],(((I=c[S])==null?void 0:I.event)||[]).forEach(O=>O(v)));return}case"COUNT":let T=z[1],F=z[2];s[T]&&(((N=c[T])==null?void 0:N.count)||[]).forEach(S=>S(F));return;case"EOSE":{let S=z[1];S in c&&(c[S].eose.forEach(v=>v()),c[S].eose=[]);return}case"OK":{let S=z[1],v=z[2],O=z[3]||"";S in a&&(v?a[S].ok.forEach(R=>R()):a[S].failed.forEach(R=>R(O)),a[S].ok=[],a[S].failed=[]);return}case"NOTICE":let U=z[1];u.notice.forEach(S=>S(U));return;case"AUTH":{let S=z[1];(L=u.auth)==null||L.forEach(v=>v(S));return}}}catch{return}}}),f)}function g(){return(o==null?void 0:o.readyState)===1}async function h(){g()||await l()}async function x(d){let y=JSON.stringify(d);if(!(!g()&&(await new Promise(E=>setTimeout(E,1e3)),!g())))try{o.send(y)}catch(E){console.log(E)}}const w=(d,{verb:y="REQ",skipVerification:E=!1,alreadyHaveEvent:_=null,id:C=Math.random().toString().slice(2)}={})=>{let m=C;return s[m]={id:m,filters:d,skipVerification:E,alreadyHaveEvent:_},x([y,m,...d]),{sub:(A,I={})=>w(A||d,{skipVerification:I.skipVerification||E,alreadyHaveEvent:I.alreadyHaveEvent||_,id:m}),unsub:()=>{delete s[m],delete c[m],x(["CLOSE",m])},on:(A,I)=>{c[m]=c[m]||{event:[],count:[],eose:[]},c[m][A].push(I)},off:(A,I)=>{let N=c[m],L=N[A].indexOf(I);L>=0&&N[A].splice(L,1)}}};function k(d,y){if(!d.id)throw new Error(`event ${d} has no id`);let E=d.id;return x([y,d]),{on:(_,C)=>{a[E]=a[E]||{ok:[],failed:[]},a[E][_].push(C)},off:(_,C)=>{let m=a[E];if(!m)return;let A=m[_].indexOf(C);A>=0&&m[_].splice(A,1)}}}return{url:n,sub:w,on:(d,y)=>{u[d].push(y),d==="connect"&&(o==null?void 0:o.readyState)===1&&y()},off:(d,y)=>{let E=u[d].indexOf(y);E!==-1&&u[d].splice(E,1)},list:(d,y)=>new Promise(E=>{let _=w(d,y),C=[],m=setTimeout(()=>{_.unsub(),E(C)},e);_.on("eose",()=>{_.unsub(),clearTimeout(m),E(C)}),_.on("event",A=>{C.push(A)})}),get:(d,y)=>new Promise(E=>{let _=w([d],y),C=setTimeout(()=>{_.unsub(),E(null)},r);_.on("event",m=>{_.unsub(),clearTimeout(C),E(m)})}),count:d=>new Promise(y=>{let E=w(d,{...w,verb:"COUNT"}),_=setTimeout(()=>{E.unsub(),y(null)},i);E.on("count",C=>{E.unsub(),clearTimeout(_),y(C)})}),publish(d){return k(d,"EVENT")},auth(d){return k(d,"AUTH")},connect:h,close(){u=jr(),c={},a={},o.readyState===WebSocket.OPEN&&(o==null||o.close())},get status(){return(o==null?void 0:o.readyState)??3}}}class kc{constructor(t={}){Bn(this,"_conn");Bn(this,"_seenOn",{});Bn(this,"eoseSubTimeout");Bn(this,"getTimeout");this._conn={},this.eoseSubTimeout=t.eoseSubTimeout||3400,this.getTimeout=t.getTimeout||3400}close(t){t.forEach(e=>{let r=this._conn[Fr(e)];r&&r.close()})}async ensureRelay(t){const e=Fr(t);this._conn[e]||(this._conn[e]=Ec(e,{getTimeout:this.getTimeout*.9,listTimeout:this.getTimeout*.9}));const r=this._conn[e];return await r.connect(),r}sub(t,e,r){let i=new Set,o={...r||{}};o.alreadyHaveEvent=(h,x)=>{var k;if((k=r==null?void 0:r.alreadyHaveEvent)!=null&&k.call(r,h,x))return!0;let w=this._seenOn[h]||new Set;return w.add(x),this._seenOn[h]=w,i.has(h)};let s=[],u=new Set,c=new Set,a=t.length,f=!1,l=setTimeout(()=>{f=!0;for(let h of c.values())h()},this.eoseSubTimeout);t.forEach(async h=>{let x;try{x=await this.ensureRelay(h)}catch{k();return}if(!x)return;let w=x.sub(e,o);w.on("event",d=>{i.add(d.id);for(let y of u.values())y(d)}),w.on("eose",()=>{f||k()}),s.push(w);function k(){if(a--,a===0){clearTimeout(l);for(let d of c.values())d()}}});let g={sub(h,x){return s.forEach(w=>w.sub(h,x)),g},unsub(){s.forEach(h=>h.unsub())},on(h,x){h==="event"?u.add(x):h==="eose"&&c.add(x)},off(h,x){h==="event"?u.delete(x):h==="eose"&&c.delete(x)}};return g}get(t,e,r){return new Promise(i=>{let o=this.sub(t,[e],r),s=setTimeout(()=>{o.unsub(),i(null)},this.getTimeout);o.on("event",u=>{i(u),clearTimeout(s),o.unsub()})})}list(t,e,r){return new Promise(i=>{let o=[],s=this.sub(t,e,r);s.on("event",u=>{o.push(u)}),s.on("eose",()=>{s.unsub(),i(o)})})}publish(t,e){const r=t.map(async o=>{let s;try{return s=await this.ensureRelay(o),s.publish(e)}catch{return{on(){},off(){}}}}),i=new Map;return{on(o,s){t.forEach(async(u,c)=>{let a=await r[c],f=()=>s(u);i.set(s,f),a.on(o,f)})},off(o,s){t.forEach(async(u,c)=>{let a=i.get(s);a&&(await r[c]).off(o,a)})}}}seenOn(t){var e,r;return Array.from(((r=(e=this._seenOn[t])==null?void 0:e.values)==null?void 0:r.call(e))||[])}}const Sc=un('<h2 id="ztr-title"> comments'),Ac=un('<h3 id="ztr-subtitle">2397 sats'),Cc=un('<div id="ztr-root"><style>');function to(n){if(!["http","naddr","note","nevent"].some(f=>n.anchor.startsWith(f)))throw"Only NIP-19 naddr, note and nevent encoded entities and URLs are supported";On.disableLikes=n.disableLikes||!1,On.disableZaps=n.disableZaps||!1,On.disablePublish=n.disablePublish||!1;const[t,e]=_n(),r=()=>n.pubkey,i=new kc,o=()=>n.relays.length>0?n.relays:["wss://relay.damus.io","wss://eden.nostr.land"];vo(async()=>{try{if(n.anchor.startsWith("http")){const g=(await i.list(o(),[{"#r":[n.anchor],kinds:[1]}])).map(h=>h.id);e({"#e":g})}else e(jl(n.anchor));const f=i.sub(o(),[{...t(),kinds:[1]}]);f.on("event",l=>{l.content&&(et[l.id]=l)}),zt(()=>f==null?void 0:f.unsub())}catch(f){console.log(f)}});const s=br(f=>mr(f,16)),u=yn((f=[])=>s()&&Object.keys(et).length>0?Object.values(et):f),c=()=>Yl(u()),a=br(f=>mr(f,700));return yt(async()=>{if(a()&&Object.keys(et).length>0){const f=Object.values(et).map(g=>g.pubkey),l=await i.list(o(),[{kinds:[0],authors:[...new Set(f)]}]);Li(l)}}),(()=>{const f=Cc(),l=f.firstChild;return H(l,es),H(f,pn(Ai.Provider,{value:{pool:i,relays:o,filter:t,pubkey:r},get children(){return[pn(ac,{}),(()=>{const g=Sc(),h=g.firstChild;return H(g,()=>Object.keys(et).length,h),g})(),pn(Et,{get when(){return!On.disableZaps},get children(){return Ac()}}),pn(no,{nestedEvents:c})]}}),null),f})()}ts("zap-threads",{relays:"",anchor:"","disable-likes":"","disable-zaps":"","disable-publish":"",pubkey:""},n=>{const t=n.relays===""?[]:n.relays.split(",");return pn(to,{get anchor(){return n.anchor},relays:t,get pubkey(){return n.pubkey},get disableLikes(){return n["disable-likes"]==="true"},get disableZaps(){return n["disable-zaps"]==="true"},get disablePublish(){return n["disable-publish"]==="true"}})});module.exports=to;
